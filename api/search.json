[{"id":"04d8bb508b38908c099ca40a392744d5","title":"tcp详解","content":"1、引言网络编程能力对于即时通讯技术开发者来说是基本功，而计算机网络又是网络编程的理论根基，因而深刻准确地理解计算机网络知识显然能夯实你的即时通讯应用的实践品质。\n2、系列文章本文是该系列文章中的第2篇：\n\n《网络编程入门从未如此简单(一)：假如你来设计网络，会怎么做？》\n《网络编程入门从未如此简单(二)：假如你来设计TCP协议，会怎么做？》（本文）\n\n本文主要涉及计算机网络的传输层，希望让TCP协议的学习不再枯燥和生涩。\n3、初识传输层你是一台电脑，你的名字叫 A\n\n\n经过《如果让你来设计网络》这篇文章中的一番折腾，只要你知道另一位伙伴 B 的 IP 地址，且你们之间的网络是通的，无论多远，你都可以将一个数据包发送给你的伙伴 B\n\n\n这就是物理层、数据链路层、网络层这三层所做的事情。\n站在第四层的你，就可以不要脸地利用下三层所做的铺垫，随心所欲地发送数据，而不必担心找不到对方了。\n\n\n\n虽然你此时还什么都没干，但你还是给自己这一层起了个响亮的名字，叫做传输层。\n你本以为自己所在的第四层万事大吉，啥事没有，但很快问题就接踵而至。\n4、问题来了前三层协议只能把数据包从一个主机搬到另外一台主机，但是，到了目的地以后，数据包具体交给哪个程序（进程）呢？\n\n\n所以，你需要把通信的进程区分开来，于是就给每个进程分配一个数字编号，你给它起了一个响亮的名字：端口号。\n\n\n然后你在要发送的数据包上，增加了传输层的头部，源端口号与目标端口号。\n\n\nOK，这样你将原本主机到主机的通信，升级为了进程和进程之间的通信。你没有意识到，你不知不觉实现了 UDP 协议！\n\n（当然 UDP 协议中不光有源端口和目标端口，还有数据包长度和校验值，我们暂且略过）\n\n就这样，你用 UDP 协议无忧无虑地同 B 进行着通信，一直没发生什么问题。\n\n\n但很快，你发现事情变得非常复杂……\n4、丢包问题由于网络的不可靠，数据包可能在半路丢失，而 A 和 B 却无法察觉。\n\n\n对于丢包问题，只要解决两个事就好了。\n第一个，A 怎么知道包丢了？答案：让 B 告诉 A\n\n第二个，丢了的包怎么办？答案：重传\n\n于是你设计了如下方案，A 每发一个包，都必须收到来自 B 的确认（ACK），再发下一个，否则在一定时间内没有收到确认，就重传这个包。\n\n\n你管它叫停止等待协议。只要按照这个协议来，虽然 A 无法保证 B 一定能收到包，但 A 能够确认 B 是否收到了包，收不到就重试，尽最大努力让这个通信过程变得可靠，于是你们现在的通信过程又有了一个新的特征，可靠交付。\n5、效率问题停止等待虽然能解决问题，但是效率太低了，A 原本可以在发完第一个数据包之后立刻开始发第二个数据包，但由于停止等待协议，A 必须等数据包到达了 B ，且 B 的 ACK 包又回到了 A，才可以继续发第二个数据包，这效率慢得可不是一点两点。\n于是你对这个过程进行了改进，采用流水线的方式，不再傻傻地等。\n\n\n6、顺序问题但是网路是复杂的、不可靠的。\n有的时候 A 发出去的数据包，分别走了不同的路由到达 B，可能无法保证和发送数据包时一样的顺序。\n\n\n在流水线中有多个数据包和ACK包在乱序流动，他们之间对应关系就乱掉了。\n难道还回到停止等待协议？A 每收到一个包的确认（ACK）再发下一个包，那就根本不存在顺序问题。应该有更好的办法！\nA 在发送的数据包中增加一个序号（seq），同时 B 要在 ACK 包上增加一个确认号（ack），这样不但解决了停止等待协议的效率问题，也通过这样标序号的方式解决了顺序问题。\n\n\n而 B 这个确认号意味深长：比如 B 发了一个确认号为 ack = 3，它不仅仅表示 A 发送的序号为 2 的包收到了，还表示 2 之前的数据包都收到了。这种方式叫累计确认或累计应答。\n\n\n\n\n注意，实际上 ack 的号是收到的最后一个数据包的序号 seq + 1，也就是告诉对方下一个应该发的序号是多少。但图中为了便于理解，ack 就表示收到的那个序号，不必纠结。\n\n7、流量问题有的时候，A 发送数据包的速度太快，而 B 的接收能力不够，但 B 却没有告知 A 这个情况。\n\n\n\n怎么解决呢？\n很简单，B 告诉 A 自己的接收能力，A 根据 B 的接收能力，相应控制自己的发送速率，就好了。\nB 怎么告诉 A 呢？B 跟 A 说”我很强”这三个字么？那肯定不行，得有一个严谨的规范。\n于是 B 决定，每次发送数据包给 A 时，顺带传过来一个值，叫窗口大小（win)，这个值就表示 B 的接收能力。同理，每次 A 给 B 发包时也带上自己的窗口大小，表示 A 的接收能力。\n\n\nB 告诉了 A 自己的窗口大小值，A 怎么利用它去做 A 这边发包的流量控制呢？\n很简单，假如 B 给 A 传过来的窗口大小 win = 5，那 A 根据这个值，把自己要发送的数据分成这么几类。\n\n\n图片过于清晰，就不再文字解释了。\n当 A 不断发送数据包时，已发送的最后一个序号就往右移动，直到碰到了窗口的上边界，此时 A 就无法继续发包，达到了流量控制。\n\n\n但是当 A 不断发包的同时，A 也会收到来自 B 的确认包，此时整个窗口会往右移动，因此上边界也往右移动，A 就能发更多的数据包了。\n\n\n\n以上都是在窗口大小不变的情况下，而 B 在发给 A 的 ACK 包中，每一个都可以重新设置一个新的窗口大小，如果 A 收到了一个新的窗口大小值，A 会随之调整。\n如果 A 收到了比原窗口值更大的窗口大小，比如 win = 6，则 A 会直接将窗口上边界向右移动 1 个单位。\n\n\n如果 A 收到了比原窗口值小的窗口大小，比如 win = 4，则 A 暂时不会改变窗口大小，更不会将窗口上边界向左移动，而是等着 ACK 的到来，不断将左边界向右移动，直到窗口大小值收缩到新大小为止。\n\n\nOK，终于将流量控制问题解决得差不多了，你看着上面一个个小动图，给这个窗口起了一个更生动的名字，滑动窗口。\n8、拥塞问题但有的时候，不是 B 的接受能力不够，而是网络不太好，造成了网络拥塞。\n\n\n拥塞控制与流量控制有些像，但流量控制是受 B 的接收能力影响，而拥塞控制是受网络环境的影响。\n拥塞控制的解决办法依然是通过设置一定的窗口大小，只不过，流量控制的窗口大小是 B 直接告诉 A 的，而拥塞控制的窗口大小按理说就应该是网络环境主动告诉 A。\n但网络环境怎么可能主动告诉 A 呢？只能 A 单方面通过试探，不断感知网络环境的好坏，进而确定自己的拥塞窗口的大小。\n\n\n拥塞窗口大小的计算有很多复杂的算法，就不在本文中展开了，假如拥塞窗口的大小为  cwnd，上一部分流量控制的滑动窗口的大小为 rwnd，那么窗口的右边界受这两个值共同的影响，需要取它俩的最小值。\n  窗口大小 = min(cwnd, rwnd)\n\n含义很容易理解，当 B 的接受能力比较差时，即使网络非常通畅，A 也需要根据 B 的接收能力限制自己的发送窗口。当网络环境比较差时，即使 B 有很强的接收能力，A 也要根据网络的拥塞情况来限制自己的发送窗口。正所谓受其短板的影响嘛~\n9、连接问题有的时候，B 主机的相应进程还没有准备好或是挂掉了，A 就开始发送数据包，导致了浪费。\n\n\n这个问题在于，A 在跟 B 通信之前，没有事先确认 B 是否已经准备好，就开始发了一连串的信息。就好比你和另一个人打电话，你还没有”喂”一下确认对方有没有在听，你就巴拉巴拉说了一堆。\n这个问题该怎么解决呢？\n地球人都知道，三次握手嘛！\nA：我准备好了(SYN)\n\nB：我知道了(ACK)，我也准备好了(SYN)\n\nA：我知道了(ACK)\n\n\n\n\n\nA 与 B 各自在内存中维护着自己的状态变量，三次握手之后，双方的状态都变成了连接已建立（ESTABLISHED）。\n虽然就只是发了三次数据包，并且在各自的内存中维护了状态变量，但这么说总觉得太 low，你看这个过程相当于双方建立连接的过程，于是你灵机一动，就叫它面向连接吧。\n\n注意：这个连接是虚拟的，是由 A 和 B 这两个终端共同维护的，在网络中的设备根本就不知道连接这回事儿！\n\n但凡事有始就有终，有了建立连接的过程，就要考虑释放连接的过程，又是地球人都知道，四次挥手嘛！\nA：再见，我要关闭了(FIN)\n\nB：我知道了(ACK) (给 B 一段时间把自己的事情处理完...)\n\nB：再见，我要关闭了(FIN)\n\nA：我知道了(ACK)\n\n\n\n\n10、总结以上讲述的，就是 TCP 协议的核心思想，上面过程中需要传输的信息，就体现在 TCP 协议的头部，这里放上最常见的 TCP 协议头解读的图。\n\n\n\n不知道你现在再看下面这句话，是否能理解：\nTCP 是\n面向连接的、可靠的、基于字节流的\n传输层通信协议\n面向连接、可靠，这两个词通过上面的讲述很容易理解，那什么叫做基于字节流呢？\n很简单，TCP 在建立连接时，需要告诉对方 MSS（最大报文段大小）。\n也就是说，如果要发送的数据很大，在 TCP 层是需要按照 MSS 来切割成一个个的 TCP 报文段 的。\n切割的时候我才不管你原来的数据表示什么意思，需要在哪里断句啥的，我就把它当成一串毫无意义的字节，在我想要切割的地方咔嚓就来一刀，标上序号，只要接收方再根据这个序号拼成最终想要的完整数据就行了。\n在我 TCP 传输这里，我就把它当做一个个的字节，也就是基于字节流的含义了。\n\n\n最后留给大家一个作业，模拟 A 与 B 建立一个 TCP 连接。\n第一题：A 给 B 发送 “aaa” ，然后 B 给 A 回复一个简单的字符串 “success”，并将此过程抓包。\n第二题：A 给 B 发送 “aaaaaa … a” 超过最大报文段大小，然后 B 给 A 回复一个简单的字符串 “success”，并将此过程抓包。\n下面是我抓的包（第二题）\n三次握手阶段\n\nA -&gt; B [SYN] Seq=0 Win=64240 Len=0\n\n                        MSS=1460 WS=256\n\nB - &gt;A [SYN, ACK] Seq=0 Ack=1 Win=29200 Len=0\n\n                        MSS=1424 WS=512\n\nA -&gt; B [ACK] Seq=1 Ack=1 Win=132352 Len=0\n\n数据发送阶段\n\nA -&gt; B [ACK] Seq=1 Ack=1 Win=132352 Len=1424\n\nA -&gt; B [ACK] Seq=1425 Ack=1 Win=132352 Len=1424\n\nA -&gt; B [PSH, ACK] Seq=2849 Ack=1 Win=132352 Len=1247\n\nB -&gt; A [ACK] Seq=1 Ack=1425 Win=32256 Len=0\n\nB -&gt; A [ACK] Seq=1 Ack=2849 Win=35328 Len=0\n\nB -&gt; A [ACK] Seq=1 Ack=4096 Win=37888 Len=0\n\nB -&gt; A [PSH, ACK] Seq=1 Ack=4096 Win=37888 Len=7\n\n四次挥手阶段\n\nB -&gt; A [FIN, ACK] Seq=8 Ack=4096 Win=37888 Len=0\n\nA -&gt; B [ACK] Seq=4096 Ack=9 Win=132352 Len=0\n\nA -&gt; B [FIN, ACK] Seq=4096 Ack=9 Win=132352 Len=0\n\n11、后记一提到 TCP，可能很多人都想起被三次握手和四次挥手所支配的恐惧。但其实你跟着文中的思路你就会发现，三次握手与四次挥手只占 TCP 所解决的核心问题中很小的一部分，只是因为它在面试中很适合作为知识点进行考察，所以在很多人的印象中就好像 TCP 的核心就是握手和挥手似的。\n本文希望你能从问题出发，真正理解 TCP 所想要解决的问题，你会发现很多原理就好像生活常识一样顺其自然，并不复杂，希望你有收获～\n","slug":"tcp-detail","date":"2023-11-06T05:28:49.000Z","categories_index":"tcp","tags_index":"tcp,网络","author_index":"uuxia"},{"id":"a26d7e330d106e6236762224435c77cc","title":"Clash 基本配置记录","content":"一、规则解释\nDOMAIN-SUFFIX：域名后缀匹配\nDOMAIN：域名匹配\nDOMAIN-KEYWORD：域名关键字匹配\nIP-CIDR：IP段匹配\nSRC-IP-CIDR：源IP段匹配\nGEOIP：GEOIP数据库（国家代码）匹配\nDST-PORT：目标端口匹配\nSRC-PORT：源端口匹配\nMATCH：全匹配（一般放在最后）\n\n二、基本配置\n\n\n\n\n\n提示\nNormal Tips Container\n\n#---------------------------------------------------#\n    ## 配置文件需要放置在 $HOME/.config/clash/config.yml\n    ## \n    ## 如果您不知道如何操作，请参阅 SS-Rule-Snippet 的 Wiki：\n    ## https://github.com/Hackl0us/SS-Rule-Snippet/wiki/clash(X)\n    #---------------------------------------------------#\n\n    # HTTP 代理端口\n    port: 7890\n\n    # SOCKS5 代理端口\n    socks-port: 7891\n\n    # Linux 和 macOS 的 redir 代理端口 (如需使用此功能，请取消注释)\n    # redir-port: 7892\n\n    # 允许局域网的连接（可用来共享代理）\n    allow-lan: false\n    # bind-address: \"*\"\n    # 此功能仅在 allow-lan 设置为 true 时生效，支持三种参数：\n    # \"*\"                           绑定所有的 IP 地址\n    # 192.168.122.11                绑定一个的 IPv4 地址\n    # \"[aaaa::a8aa:ff:fe09:57d8]\"   绑定一个 IPv6 地址\n\n    # 规则模式：Rule（规则） / Global（全局代理）/ Direct（全局直连）\n    mode: Rule\n\n    # 设置日志输出级别 (默认级别：silent，即不输出任何内容，以避免因日志内容过大而导致程序内存溢出）。\n    # 5 个级别：silent / info / warning / error / debug。级别越高日志输出量越大，越倾向于调试，若需要请自行开启。\n    log-level: silent\n\n    # clash 的 RESTful API\n    external-controller: 127.0.0.1:9090\n\n    # 您可以将静态网页资源（如 clash-dashboard）放置在一个目录中，clash 将会服务于 `${API}/ui`\n    # 参数应填写配置目录的相对路径或绝对路径。\n    # external-ui: folder\n\n    # RESTful API 的口令 (可选)\n    # secret: \"\"\n\n    # 实验性功能\n    experimental:\n      ignore-resolve-fail: true # 忽略 DNS 解析失败，默认值为 true\n\n    # 本地 SOCKS5 / HTTP(S) 服务认证\n    # authentication:\n    #  - \"user1:pass1\"\n    #  - \"user2:pass2\"\n\n    # # 实验性功能 hosts, 支持通配符 (例如 *.clash.dev 甚至 *.foo.*.example.com)\n    # # 静态的域名 比 通配域名 具有更高的优先级 (foo.example.com 优先于 *.example.com)\n    # # 注意: hosts 在 fake-ip 模式下不生效\n    # hosts:\n    #   '*.clash.dev': 127.0.0.1\n    #   'alpha.clash.dev': '::1'\n\n    dns:\n      enable: true\n      ipv6: false\n      # listen: 0.0.0.0:53\n      # enhanced-mode: redir-host # 或 fake-ip\n      # # fake-ip-range: 198.18.0.1/16 # 如果你不知道这个参数的作用，请勿修改\n      # fake-ip-filter: # fake-ip 白名单列表\n      #   - '*.lan'\n      #   - localhost.ptlogin2.qq.com\n\n      nameserver:\n        - 1.2.4.8\n        - 114.114.114.114\n        - 223.5.5.5\n        - tls://13800000000.rubyfish.cn:853\n        #- https://13800000000.rubyfish.cn/\n\n      fallback: # 与 nameserver 内的服务器列表同时发起请求，当规则符合 GEOIP 在 CN 以外时，fallback 列表内的域名服务器生效。\n        - tls://13800000000.rubyfish.cn:853\n        - tls://1.0.0.1:853\n        - tls://dns.google:853\n\n        #- https://13800000000.rubyfish.cn/\n        #- https://cloudflare-dns.com/dns-query\n        #- https://dns.google/dns-query\n\n      fallback-filter:\n        geoip: true # 默认\n        ipcidr: # 在这个网段内的 IP 地址会被考虑为被污染的 IP\n          - 240.0.0.0/4\n\n    # 1. clash DNS 请求逻辑：\n    #   (1) 当访问一个域名时， nameserver 与 fallback 列表内的所有服务器并发请求，得到域名对应的 IP 地址。\n    #   (2) clash 将选取 nameserver 列表内，解析最快的结果。\n    #   (3) 若解析结果中，IP 地址属于 国外，那么 clash 将选择 fallback 列表内，解析最快的结果。\n    #\n    #   因此，我在 nameserver 和 fallback 内都放置了无污染、解析速度较快的国内 DNS 服务器，以达到最快的解析速度。\n    #   但是 fallback 列表内服务器会用在解析境外网站，为了结果绝对无污染，我仅保留了支持 DoT/DoH 的两个服务器。\n    # \n    # 2. clash DNS 配置注意事项：\n    #   (1) 如果您为了确保 DNS 解析结果无污染，请仅保留列表内以 tls:// 或 https:// 开头的 DNS 服务器，但是通常对于国内域名没有必要。\n    #   (2) 如果您不在乎可能解析到污染的结果，更加追求速度。请将 nameserver 列表的服务器插入至 fallback 列表内，并移除重复项。\n    # \n    # 3. 关于 DNS over HTTPS (DoH) 和 DNS over TLS (DoT) 的选择：\n    #   对于两项技术双方各执一词，而且会无休止的争论，各有利弊。各位请根据具体需求自行选择，但是配置文件内默认启用 DoT，因为目前国内没有封锁或管制。\n    #   DoH: 以 https:// 开头的 DNS 服务器。拥有更好的伪装性，且几乎不可能被运营商或网络管理封锁，但查询效率和安全性可能略低。\n    #   DoT: 以 tls:// 开头的 DNS 服务器。拥有更高的安全性和查询效率，但端口有可能被管制或封锁。\n    #   若要了解更多关于 DoH/DoT 相关技术，请自行查阅规范文档。\n\n\n    Proxy:\n    # shadowsocks\n    # 所支持的加密方式与 go-shadowsocks2 保持一致\n    # 支持加密方式： \n    #   aes-128-gcm aes-192-gcm aes-256-gcm\n    #   aes-128-cfb aes-192-cfb aes-256-cfb\n    #   aes-128-ctr aes-192-ctr aes-256-ctr\n    #   rc4-md5 chacha20 chacha20-ietf xchacha20\n    #   chacha20-ietf-poly1305 xchacha20-ietf-poly1305\n\n      - name: \"ss1\"\n        type: ss\n        server: server\n        port: 443\n        cipher: chacha20-ietf-poly1305\n        password: \"password\"\n        # udp: true  \n\n      - name: \"ss2\"\n        type: ss\n        server: server\n        port: 443\n        cipher: AEAD_CHACHA20_POLY1305\n        password: \"password\"\n        plugin: obfs\n        plugin-opts:\n          mode: tls # 混淆模式，可以选择 http 或 tls\n          host: bing.com # 混淆域名，需要和服务器配置保持一致\n\n      - name: \"ss3\"\n        type: ss\n        server: server\n        port: 443\n        cipher: AEAD_CHACHA20_POLY1305\n        password: \"password\"\n        plugin: v2ray-plugin\n        plugin-opts:\n          mode: websocket # 暂时不支持 QUIC 协议\n          # tls: true # wss\n          # skip-cert-verify: true\n          # host: bing.com\n          # path: \"/\"\n          # headers:\n          #   custom: value\n\n    # vmess\n    # 支持加密方式：auto / aes-128-gcm / chacha20-poly1305 / none\n      - name: \"vmess\"\n        type: vmess\n        server: server\n        port: 443\n        uuid: uuid\n        alterId: 32\n        cipher: auto\n        # udp: true\n        # tls: true\n        # skip-cert-verify: true\n        # network: ws\n        # ws-path: /path\n        # ws-headers:\n        #   Host: v2ray.com\n\n      # socks5\n      - name: \"socks\"\n        type: socks5\n        server: server\n        port: 443\n        # username: username\n        # password: password\n        # tls: true\n        # skip-cert-verify: true\n        # udp: true\n\n      # http\n      - name: \"http\"\n        type: http\n        server: server\n        port: 443\n        # username: username\n        # password: password\n        # tls: true # https\n        # skip-cert-verify: true\n\n      # snell\n      - name: \"snell\"\n        type: snell\n        server: server\n        port: 44046\n        psk: yourpsk\n        # obfs-opts:\n          # mode: http # 或 tls\n          # host: bing.com\n\n    Proxy Group:\n    # url-test 可以自动选择与指定 URL 测速后，延迟最短的服务器\n      - name: \"auto\"\n        type: url-test\n        proxies:\n          - ss1\n          - ss2\n          - vmess1\n        url: 'http://www.gstatic.com/generate_204'\n        interval: 300\n\n    # fallback 可以尽量按照用户书写的服务器顺序，在确保服务器可用的情况下，自动选择服务器\n      - name: \"fallback-auto\"\n        type: fallback\n        proxies:\n          - ss1\n          - ss2\n          - vmess1\n        url: 'http://www.gstatic.com/generate_204'\n        interval: 300\n\n    # load-balance 可以使相同 eTLD 请求在同一条代理线路上\n      - name: \"load-balance\"\n        type: load-balance\n        proxies:\n          - ss1\n          - ss2\n          - vmess1\n        url: 'http://www.gstatic.com/generate_204'\n        interval: 300\n\n    # select 用来允许用户手动选择 代理服务器 或 服务器组\n    # 您也可以使用 RESTful API 去切换服务器，这种方式推荐在 GUI 中使用\n      - name: Proxy\n        type: select\n        proxies:\n          - ss1\n          - ss2\n          - vmess1\n          - auto\n\n    Rule:\n    # 抗 DNS 污染 \n      - DOMAIN-KEYWORD,amazon,Proxy\n      - DOMAIN-KEYWORD,google,Proxy\n      - DOMAIN-KEYWORD,gmail,Proxy\n      - DOMAIN-KEYWORD,youtube,Proxy\n      - DOMAIN-KEYWORD,facebook,Proxy\n      - DOMAIN-SUFFIX,fb.me,Proxy\n      - DOMAIN-SUFFIX,fbcdn.net,Proxy\n      - DOMAIN-KEYWORD,twitter,Proxy\n      - DOMAIN-KEYWORD,instagram,Proxy\n      - DOMAIN-KEYWORD,dropbox,Proxy\n      - DOMAIN-SUFFIX,twimg.com,Proxy\n      - DOMAIN-KEYWORD,blogspot,Proxy\n      - DOMAIN-SUFFIX,youtu.be,Proxy\n      - DOMAIN-KEYWORD,whatsapp,Proxy\n\n    # 常见广告域名屏蔽\n      - DOMAIN-KEYWORD,admarvel,REJECT\n      - DOMAIN-KEYWORD,admaster,REJECT\n      - DOMAIN-KEYWORD,adsage,REJECT\n      - DOMAIN-KEYWORD,adsmogo,REJECT\n      - DOMAIN-KEYWORD,adsrvmedia,REJECT\n      - DOMAIN-KEYWORD,adwords,REJECT\n      - DOMAIN-KEYWORD,adservice,REJECT\n      - DOMAIN-KEYWORD,domob,REJECT\n      - DOMAIN-KEYWORD,duomeng,REJECT\n      - DOMAIN-KEYWORD,dwtrack,REJECT\n      - DOMAIN-KEYWORD,guanggao,REJECT\n      - DOMAIN-KEYWORD,lianmeng,REJECT\n      - DOMAIN-SUFFIX,mmstat.com,REJECT\n      - DOMAIN-KEYWORD,omgmta,REJECT\n      - DOMAIN-KEYWORD,openx,REJECT\n      - DOMAIN-KEYWORD,partnerad,REJECT\n      - DOMAIN-KEYWORD,pingfore,REJECT\n      - DOMAIN-KEYWORD,supersonicads,REJECT\n      - DOMAIN-KEYWORD,uedas,REJECT\n      - DOMAIN-KEYWORD,umeng,REJECT\n      - DOMAIN-KEYWORD,usage,REJECT\n      - DOMAIN-KEYWORD,wlmonitor,REJECT\n      - DOMAIN-KEYWORD,zjtoolbar,REJECT\n\n    # LAN\n      - DOMAIN-SUFFIX,local,DIRECT\n      - IP-CIDR,127.0.0.0/8,DIRECT\n      - IP-CIDR,172.16.0.0/12,DIRECT\n      - IP-CIDR,192.168.0.0/16,DIRECT\n      - IP-CIDR,10.0.0.0/8,DIRECT\n      - IP-CIDR,17.0.0.0/8,DIRECT\n      - IP-CIDR,100.64.0.0/10,DIRECT\n\n    # 最终规则\n      - GEOIP,CN,DIRECT\n      - MATCH,Proxy\n\n三、绕过系统代理Clash for Windows在v 0.4.5 版本后可以自定义系统代理需要绕过的域名或IP\n部分应用检测到系统代理会拒绝响应（例如网易云音乐uwp），此功能用于解决此类问题\n设置方式config.yaml\nport: 8888\n    socks-port: 8889\n    redir-port: 0\n    allow-lan: true\n    mode: Rule\n    log-level: info\n    external-controller: '0.0.0.0:6170'\n    secret: ''\n    Proxy:\n      ...\n    Proxy Group:\n      ...\n    Rule:\n      ...\n    cfw-bypass:\n      ... # 原有字段不用删除\n      - 'music.163.com' # 网易云域名1\n      - '*.music.126.net' # 网易云域名2\n\ncfw-bypass类型为数组，item为需要绕过的域名或节点，支持通配符*\n\n\n\n\n\n\n\n\n\n最后一行对应系统中“请勿将代理服务器用于本地(Intranet)地址”选项，请确保此项在最底部\n","slug":"clashx","date":"2022-12-05T06:56:16.000Z","categories_index":"linux","tags_index":"clashx","author_index":"uuxia"},{"id":"ccf998b0259d26e6b6cefdf42feb4b5f","title":"家庭宽带开启IPV6","content":"常见的运营商超级管理员账号中国移动\n移动光猫账号∶CMCCAdmin 密码∶ aDm8H%MdA \n华为的∶telecomadmin 密码∶ admintelecom\n中国移动光纤宽带ip∶192.168.100.1的超级账号∶telecomadmin 密码∶nE7jA%5m\n\n中国电信\n账号∶telecomadmin 密码∶ nE7jA%5m\n\n设置光猫为桥接模式打开IPV4/IPV6，如果设置不了，请截图保存，然后删除，再新建，然后按原来的设置（如何连接光猫，可观看前面的视频）\n\n然后设置软路由或者路由器有软路由情况下：\n网络——接口——IPV6 ULA清空\n网络——接口——WAN口——使用内置IPV6管理取消勾选——Obtain IPv6-Address项目确保是自动状态\n网络——接口——lan口——DHCP——IPV6设置——高级设置——取消勾选使用内置IPV6管理——取消勾选强制链路\n通告的DNS服务器（添加谷歌IPV6DNS）：\n2001:4860:4860::8888\n2001:4860:4860::8844\n\n\n\n\n混合模式会根据配置自动选择使用中继还是服务器模式。（这里如果是主路由请选择服务器模式，旁路由选择中继模式）何时采用无状态、何时采用有状态，关键看应用场景。核心在于是否需要控制IP地址，比如保持IP不变，如果需要控制，就采用有状态;如果无需控制，就采用无状态。\n\n在DHCP/DNS——高级设置——取消勾选禁止解析IPV6 DNS记录\n\n设置完成后一定要重启软路由\n\n只有路由器的情况下：直接打开路由器的IPV6即可，如果有多个路由器，每个路由器都要打开\n\n设置完成后，电脑要禁用网络然后重新启用（目的是为了获取IPV6地址）\n\n测试IPV6： https://ipv6-test.com/ https://test-ipv6.com/index.html.zh_CN\n\n\n \n","slug":"openwrt-ipv6","date":"2022-11-24T13:20:30.000Z","categories_index":"ipv6","tags_index":"ipv6","author_index":"uuxia"},{"id":"d56efd048323ddb26df3b6eebbfbe819","title":"家庭光猫配置","content":"\n  5ad6f12fcb346c1b5255c2a3344fe8916188cd3b15b0c898e703a6a8d3e96c9bb2622f2457644e64fd8c090fef557d91ef08e9adba24c42d7d421649e111204da34f90e46ce967daf9f81552274e1bf237128297944352b94e681eac1a3212050673923fb3b695721cf321c334a26cc3e18838af0bbac05b786a421e8be726f208a6615ad156b96fb4e41d8ce17e4e794c8ec12a618a177be8c2f98daf04a14738bc9bd40552fe60965e9b72ec08ad580bbd123a8f849295ffc919bfcdad9d93d922d0e5245823581345a6ff40b79d12a5730a66b2f48c7e559b150c184b4fee00eda1e7c6f613f6b1358fc10f5ca80b2a0afb8de504621d3dba7632d0cba7d947da7eee1be823b8ab62f20b62c4d6821a719f2dbc98b109889e532ef24a4f924a2b9e7893864deb4cba59bd46c30d9d04ea6d82d76e2bf4fb6d4d7ade322cc8e4f811c861e6b2805ee7bd05c437db27d250b5e35d42eebd625edf2761a3861e2ea77605fa485ac9d2b233908378355ce8f88844a5d9916411243234d6d4d1ade3ddf12136d4f130553d9537853c9351bfd78ed9eb574c815588097b8ce8e6a96e20dabff0d7cbf1a0ea690f5758b248188ec3c91b55fbf5d4877d42092ac6594e591d8ed55d0b2778246272d9e86401dc321ce5db0412d4534031c6d73ad4ad2613e7d86ba7ab85032871acd8c503ef39dec5afb845c19d8ef7e5052339a7baabf0d6922333b48c1fc09632597ac17cbc8238bf55e903868dbdf015184e370ce5497415c4482bfe9807064b3e6ac213d56f6dcf35ed0002acaa02f482c06634b6ff1e992dff14c31eead8880aee593adb454c7516f158d73ebae52b626b29143e8648bd8c861ddc54a2917c4130204bb0c9abc7a72c31903cab23009310dab457339af9f9238576e06ded0a57b8a529de2d90599481eb7827c8eb8cb5795aaddca41acef31efbabf95ab389093e3f4ed49fb31c5f7857f254d231f866dde10671af8d624f505236e49a59d9fccebe31ba3ae672348c30f878f8b7b2be2ceb833c11151f3dd4d8c4dfa2897a44e8b387c45672ce92a54b62587eae4cf8d68bd4974ac6523df45b6254155fb77a2fd0651e2d199305b947ea2a5b66237ae3c44e97ca14382928428102182a13a0a9c44f585bfad03140844ec721dea431e5b85e55cffd520d000320a3e91b10c9a5da01c57f3ba593de2acedaa85b0b250cf4938557b486c0e11cdb72a35f0cbe7c2721881963c44578e2db6aa578b669130709f134ea804cc7d35e8a50b812835dc3ae50347896ac7358505562ce3a02d8079a434ada066cb8368f8911b326efb8153ebd2ff1c72e59c86f2e7fa6298404277184285009d3d89c7f8f7e951a73e36223fd83fccbb7de42db23ef4bf475e9792d568f1c7fdbce16a7c04c9b2aaf314b968ddd2f42b2154b5183a824504cda6cb5cfd26506e55ae59e8d44f79cfc04457d2e3c9ebff5e433221806a63600f294deaf248470c3c69b094fae498388606f3b1e8a1a296d664fb08d44ad66a31f44fe\n  \n    \n      \n      \n        Hey, password is required here.\n      \n    \n  \n\n","slug":"mao-config","date":"2022-11-24T12:07:17.000Z","categories_index":"mao","tags_index":"","author_index":"uuxia"},{"id":"4256b93c1a14e298462e2348e12791c7","title":"GoLang 全平台编译","content":"Golang的全平台编译简直太爽了，真的太适合我了，平时编译一些不同设备的跨平台程序，真的是爽的不行。拥有一台windows电脑就能开发出在Linux、Windows、Mac上面直接运行的程序。\n\n\n\n一、三个平台编译示例:1、Mac下编译Linux, Windows平台的64位可执行程序：\n$ CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build test.go\n$ CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.go\n\n\n2、 Linux下编译Mac, Windows平台的64位可执行程序：\n$ CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build test.go\n$ CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.go\n\n\n3、 Windows下编译Mac, Linux平台的64位可执行程序：\n$ set CGO_ENABLED=0 set GOOS=darwin3 set GOARCH=amd64 go build test.go\n$ set CGO_ENABLED=0 set GOOS=linux s GOARCH=amd64 go build test.go\n\n\n\n当然如果编译过其他平台后，程序 go run main.go 执行会有一些问题:报错如下:\nF:\\github\\syncFiles\\goApi\\ipDemo&gt;go run main.go\nwarning: GOPATH set to GOROOT (C:\\Program Files\\Go) has no effect\nexec: \"C:\\\\Users\\\\dell\\\\AppData\\\\Local\\\\Temp\\\\go-build2490838331\\\\b001\\\\exe\\\\main\": file does not exist\n\n\n这里只需要:\nF:\\github\\syncFiles\\goApi\\ipDemo&gt;set GOOS=windows\n\nF:\\github\\syncFiles\\goApi\\ipDemo&gt;go run main.go\nwarning: GOPATH set to GOROOT (C:\\Program Files\\Go) has no effect\n192.168.5.107\n\n\nmain.go 是一个显示本机IP地址的程序。这样做就没有问题了。\n二、包括三个设置的参数:\nGOARCH：编译目标平台的硬件体系架构（amd64, 386, arm, ppc64等）。\nGOOS：编译目标平台上的操作系统（darwin, freebsd, linux, windows）。\nCGO_ENABLED：代表是否开启CGO，1表示开启，0表示禁用。由于CGO不能支持交叉编译，所以需要禁用。\n\n","slug":"go-cross-compile","date":"2022-11-23T11:16:38.000Z","categories_index":"go","tags_index":"go,cross","author_index":"uuxia"},{"id":"fefcb9efb9b2bb50dd1c4b29bb3c1ed0","title":"OpenWrt开启i2c功能，并顺利编译风扇驱动","content":"树莓派安装OpenWrt作为家庭主路由，并开启i2c编译风扇、led等驱动，cpu温度骤降！～～～\n\n\n\n1、编译风扇/home/uuxia/openwrt/temp_control/WiringPi-master/wiringPi\n/home/uuxia/openwrt/wrt/staging_dir/toolchain-aarch64_cortex-a72_gcc-8.4.0_musl/bin/aarch64-openwrt-linux-gcc \\\n-o feng feng.c ssd1306_i2c.c \\\n-I/home/uuxia/openwrt/temp_control/WiringPi-master/wiringPi \\\n-L/home/uuxia/openwrt/temp_control/WiringPi-master/wiringPi \\\n-lwiringPi\n\n2、Unable to open I2C device: No such file or directory 问题解决用lsmod命令可以看到i2c_bmc2708字样，但是没i2c_dev字样，那么还需要做如下处理执行命令sudo nano /etc/modules      # 使用nano打开文件然后增加i2c_dev行，安Ctrl+X退出编辑，输入Y保存内容，然后重启即可。\n3、在OpenWrt中开启树莓派I2C功能1、编辑 /boot/config.txtdtparam=i2c_arm=on\ndtparam=i2c0=on\ndtparam=i2c1=on\ndtparam=spi=on\ndtparam=i2s=on\n\n2、通过opkg安装相关包opkg install i2c-tools kmod-i2c-gpio kmod-i2c-algo-bit kmod-i2c-algo-pcf kmod-i2c-bcm2835 kmod-i2c-core kmod-i2c-gpio kmod-i2c-mux\n\n3、使用i2c命令行工具测试\n#!/bin/bash\nls /dev/i2c*\ni2cdetect -y 1","slug":"openwet-i2c","date":"2022-11-21T06:11:56.000Z","categories_index":"openwrt,i2c","tags_index":"openwrt,i2c,pi","author_index":"uuxia"},{"id":"070f304a02bbf9ceccd6a97acca7e527","title":"Windows下Frpc安装与自启动","content":"Windows下安装Frpc，并在windows的任务计划程序里设置Frpc自启动。\n\n\n1、新建一个start.bat文件\n@echo off\n:home\nfrpc -c frpc.ini\ngoto home\n\n2、 打开任务计划程序（cmd-&gt;taskschd.msc）\n3、安装步骤如下截图：\n\n\n\n\n\n\n\n","slug":"frpc-install-autostart","date":"2022-10-27T09:00:57.000Z","categories_index":"frpc","tags_index":"frpc","author_index":"uuxia"},{"id":"81b909122b31a9659fd246d917b88723","title":"小米9刷 PixelExperience ROM教程","content":"小米9刷入官方rom\n\n\n小米9解锁\n确保手机插入了一张SIM卡，并登陆小米账号，并断开Wi-Fi连接;\n开启开发者调试模式，Settings &gt; About Phone， 连续点击 MIUI Version 5次；\n绑定设备到小米账号，Settings &gt; Additional settings &gt; Developer options &gt; Mi Unlock status\n下载小米解锁程序(仅支持windows)，官方解锁网站；\n手动进入Bootloader模式（关机后，同时按住开机键和音量下键）；\n通过USB连接手机，点击 “解锁”按钮；\n遇到电脑识别不了手机，需要安装驱动，可以使用小米刷机工具自带驱动安装。\n\n刷入 PixelExperience Recovery.\n下载PixelExperience Recovery;\n将小米9手机连接PC电脑，并运行一下指令进入bootloader模式：adb reboot bootloader\n查看手机是否连接成功：fastboot devices\n开始刷入PixelExperience Recoveryfastboot flash recovery recovery_cepheus-12.1-20220611-0701-UNOFFICIAL.img\n\n开始 PixelExperience ROM 刷机\nuuxia编译的ROM包下载\n按 Volume Up + Power;\n清空数据 Format data / factory reset;\nApply Update &gt; Apply from ADB;\nPC电脑端执行 adb sideload PixelExperience_cepheus-12.1-20220611-0701-UNOFFICIAL.zip\n\n附小米9刷回官方ROM\n","slug":"cepheus-lock-rom","date":"2022-10-13T05:16:07.000Z","categories_index":"PixelExperience,小米9","tags_index":"cepheus,PixelExperience,刷机,Recovery","author_index":"uuxia"},{"id":"89bb463d3273af6b76496d142694c4e1","title":"Android 编译 openssl 的注意事项","content":"\n\n\n以下载链接https://www.openssl.org/source/openssl-1.1.1o.tar.gz为例下载解压之后，查看根目录的 NOTES.ANDROID，其中有\n\nexport ANDROID_NDK_HOME=/home/whoever/Android/android-sdk/ndk/20.0.5594570\nPATH=$ANDROID_NDK_HOME/toolchains/llvm/prebuilt/linux-x86_64/bin:$ANDROID_NDK_HOME/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin:$PATH\n./Configure android-arm64 -D__ANDROID_API__=29\nmake\n\n\n这里就是最直接的编译方式了。但是这样编译之后，会有一个坑\n\nlrwxrwxrwx  1 ubuntu ubuntu      16 Jun  9 21:23 libcrypto.so -&gt; libcrypto.so.1.1\n-rwxrwxr-x  1 ubuntu ubuntu 2754216 Jun  9 21:23 libcrypto.so.1.1\nlrwxrwxrwx  1 ubuntu ubuntu      13 Jun  9 21:23 libssl.so -&gt; libssl.so.1.1\n-rwxrwxr-x  1 ubuntu ubuntu  596600 Jun  9 21:23 libssl.so.1.1\n\n\n编译时尝试链接 libssl.so ，实际上会链接到 libssl.so.1.1 ，但是当你尝试将 libssl.so.1.1 集成到 Android studio 工程内时，会发现 libssl.so.1.1 这种命名格式so，Android studio 是不会自动将其打包到 apk 内的，即使将 libssl.so.1.1 改名为 libssl.so 可以集成到 apk ，app运行时仍然会去找 libssl.so.1.1。因为 so 内部有其文件名信息\n\n$objdump -p libssl.so | grep SONAME\n  SONAME               libssl.so.1.1\n\n\n对于Android来说，我们更希望，编译之后，so 本身名字就叫 libssl.so。具体做法是解压 openssl-1.1.1o.tar.gz 之后，修改 15-android.conf大概 193 行\n\nmy %targets = (\n    \"android\" =&gt; {\n        inherit_from     =&gt; [ \"linux-generic32\" ],\n        template         =&gt; 1,\n        ################################################################\n        # Special note about -pie. The underlying reason is that\n        # Lollipop refuses to run non-PIE. But what about older systems\n        # and NDKs? -fPIC was never problem, so the only concern is -pie.\n        # Older toolchains, e.g. r4, appear to handle it and binaries\n        # turn out mostly functional. \"Mostly\" means that oldest\n        # Androids, such as Froyo, fail to handle executable, but newer\n        # systems are perfectly capable of executing binaries targeting\n        # Froyo. Keep in mind that in the nutshell Android builds are\n        # about JNI, i.e. shared libraries, not applications.\n        cflags           =&gt; add(sub { android_ndk()-&gt;{cflags} }),\n        cppflags         =&gt; add(sub { android_ndk()-&gt;{cppflags} }),\n        cxxflags         =&gt; add(sub { android_ndk()-&gt;{cflags} }),\n        bn_ops           =&gt; sub { android_ndk()-&gt;{bn_ops} },\n        bin_cflags       =&gt; \"-pie\",\n        enable           =&gt; [ ],\n        shared_extension =&gt; \".so\",  ### 这一行是新加的\n    },\n    \n\n这样可以编译出来不带版本后缀的 libssl.so 和 libcrypto.so\n可以参考下边的懒人脚本来自行编译\n\n#!/bin/bash\n\nfunction buildopenssl()\n{\n    androidarch=$1\n    toolchain=$2\n    if [ ! -f openssl-1.1.1o.tar.gz ]; then\n        wget https://www.openssl.org/source/openssl-1.1.1o.tar.gz\n    fi\n    if [ !-d openssl-1.1.1o ]; then\n        tar -xf openssl-1.1.1o.tar.gz\n    fi\n    if [ -z $ANDROID_NDK_HOME ]; then\n        echo \"missing ANDROID_NDK_HOME\"\n        exit\n    fi\n    pushd openssl-1.1.1o\n    PATH=$ANDROID_NDK_HOME/toolchains/llvm/prebuilt/linux-x86_64/bin:$ANDROID_NDK_HOME/toolchains/${toolchain}-linux-androideabi-4.9/prebuilt/linux-x86_64/bin:$PATH\n    ./Configure android-$androidarch -D__ANDROID_API__=26\n    make clean\n    make\n    popd\n}\n\nbuildopenssl arm64 aarch64\n#buildopenssl arm arm\n#buildopenssl x86 x86\n#buildopenssl x86_64 x86_64\n\n\n\n使用时，将 NDK_HOME传入，例如，脚本保存为 build.sh，则执行命令\nANDROID_NDK_HOME=/home/whoever/android-ndk-r21e ./build_android_openssl.sh\n\n\n\n想为 Android (arm/x86/x86_64)编译时，修改脚本末尾的 buildopenssl 注释\n友情链接\n","slug":"opensslforandroid","date":"2022-07-21T02:01:47.000Z","categories_index":"ndk,openssl","tags_index":"ndk,Android,openssl","author_index":"uuxia"},{"id":"2de4bfcb70b5f8e779a2abe056882166","title":"IoT接入文档","content":"4.3 设备与平台通信接口4.3.1 注册接口描述：设备上电联网后，检测本地是没有登录信息和注册标志，设备需要到平台进行注册激活，注册地址固定 URL，且分为测试和正式服务器地址（域名或 IP、端口）。正式服务器地址（OPENHOST）：open.clife.cn测试服务器地址（TESTHOST）：test.clife.cn正式或者测试服务器请求 URL 只需要对服务器地址进行互换即可。\n4.3.1.1 请求请求 URL：http(s)://OPENHOST/device/register\n请求参数：\n\n authLevel=安全认证级别（0 高级，1 中级，2 初级）\n productCode=产品编码（初、中级认证级别必选）\n devId=设备 ID 号（高级认证级别必选）\n\n请求头：Content-Type: application/json请求类型：POST 请求方向：设备-&gt;平台\n\n\n\n参数名\n类型\n类型\n描述\n\n\n\ncmd\nNumber\n功能码，取值 2000\nY\n\n\nver\nString\n通讯协议版本，通讯双方需要比对版本号，高版本向下兼容，格式示例：1.0\nY\n\n\ndir\nString\n传递方向，同 4.1.1.1\nY\n\n\nmsgId\nNumber\n帧序号，回复帧与请求帧中值相同，否则作为异常处理（丢包、错误）。帧序号由请求方管理，确保帧的唯一性，可做累加计算。\nY\n\n\nprio\nNumber\n功能优先级，高优先级数据报文优先处理，默认中等优先级。优先级等级：0：低优先级1：中优先级&gt;=2：高优先级\nN\n\n\ntimestamp\nString\n时间戳，最小单位毫秒，UTC-8 时区。设备首次注册使用设备本地时间做时间戳，通过平台回复内容再同步时间戳。\nY\n\n\ndata\nObject\n关键数据对象体，HTTP 请求时需要对此数据内容作加密并使用 base64 编码处理，加解密密钥需平台申请 devKey\nY\n\n\nproductCode\nString\ndata 中成员，产品编码，平台申请，初、中级认证必选\nN\n\n\n\n\n\n\n\n\n\n4.3.2.8 文件操作接口描述：平台通知设备下载文件，或者请求设备上传文件。该接口主要分为升级、日志调试、收发文件三大功能。\n4.3.2.8.1 请求请求方向：平台-&gt;设备\n\n\n\n参数名\n类型\n类型\n描述\n\n\n\ncmd\nNumber\n功能码，取值 2000\nY\n\n\nver\nString\n通讯协议版本，通讯双方需要比对版本号，高版本向下兼容，格式示例：1.0\nY\n\n\ndir\nString\n传递方向，同 4.1.1.1\nY\n\n\nmsgId\nNumber\n帧序号，回复帧与请求帧中值相同，否则作为异常处理（丢包、错误）。帧序号由请求方管理，确保帧的唯一性，可做累加计算。\nY\n\n\nprio\nNumber\n功能优先级，高优先级数据报文优先处理，默认中等优先级。优先级等级：0：低优先级1：中优先级&gt;=2：高优先级\nN\n\n\ntimestamp\nString\n时间戳，最小单位毫秒，UTC-8 时区。设备首次注册使用设备本地时间做时间戳，通过平台回复内容再同步时间戳。\nY\n\n\ndata\nObject\n关键数据对象体，HTTP 请求时需要对此数据内容作加密并使用 base64 编码处理，加解密密钥需平台申请 devKey\nY\n\n\nfileMode\nString\ndata 中成员，文件操作模式，取值：“DOWN”：下载模式“UP”：上传模式“QUERY”：查询文件信息（主要是版本号）\nY\n\n\nproductVer\nNumber\ndata 中成员，产品版本（总版本号），基础版本从 1 开始，下载模式为升级时必选\nN\n\n\nfileInfo\nArray of Object\ndata 中成员，文件信息列表，包括 Url、软硬件版本等\nY\n\n\nfileType\nString\nfileInfo 中成员，文件作用类型，取值：1. 升级功能“FIRM”： 设备升级固件，下载模式“SUBFIRM”： 子设备（插件）的升级固件， 下载模式“PROFILE”：设备 profile 文件2. 日志调试“LOG”：设备日志文件，上传模式（3）文件收发“PHOTO”：照片文件“VIDEO”：视频文件“VOICE”：音频文件 “DATA”：记录数据文件\nY\n\n\ndevNum\nNumber\nfileInfo 内部成员，设备（插件）ID 号，当 “fileType”为“SUBFIRM”时必选\nN\n\n\nsoftware\nString\nfileInfo 内部成员，软件版本号，fileType 为 “FIRM”、“SUBFIRM”升级固件时必选\nN\n\n\nhardware\nString\nfileInfo 内部成员，硬件版本号，fileType 为 “FIRM”、“SUBFIRM”升级固件时必选\nN\n\n\nurl\nString\nfileInfo 内部成员，下载或者上传文件的 Url文件地址\nY\n\n\nmd5\nString\nfileInfo 内部成员，下载文件的 MD5 校验码，16 进制字符串格式，升级必选\nN\n\n\ncheckSum\nNumber\nfileInfo 内部成员，下载文件的累加和，升级必选\nN\n\n\nstartTime\nNumber\ndata 中成员，文件操作相对当前系统时间的开始时间偏移，单位秒，三种情况：&lt;0：当前时间之前的时间点0：当前时间点&gt;0：当前时间后的时间点\nN\n\n\nstopTime\nNumber\ndata 中成员，文件操作相对当前系统时间的结束时间偏移，单位秒，三种情况：&lt;0：当前时间之前的时间点0：当前时间点&gt;0：当前时间后的时间点且满足 fileStopTime &gt;= fileStartTime\nN\n\n\n示例：文件下载模式：加密前：\n\n{\n    \"cmd\": 2019,\n    \"ver\": \"1.0\",\n    \"dir\": \"30\",\n    \"timestamp\": 1617787651542,\n    \"msgId\": 23454,\n    \"data\": {\n        \"fileMode\": \"DOWN\",\n        \"productVer\": 2,\n        \"fileInfo\": [\n            {\n                \"fileType\": \"FIRM\",\n                \"devNum\": 0,\n                \"software\": \"1.0.2.0\",\n                \"hardware\": \"02\",\n                \"checkSum\": 34458424,\n                \"md5\": \"6d348c902ace4d09b6d62ce982dc8ace\",\n                \"url\": \"http://clife.open.cn/device/ota/esp8266.bin\"\n            },\n            {\n                \"fileType\": \"SUBFIRM\",\n                \" devNum\": 1,\n                \"software\": \"01\",\n                \"hardware\": \"02\",\n                \"checkSum\": 764234235,\n                \"md5\": \"6d348c902ace4d09b6d62ce982dc8ace\",\n                \"url\": \"http://clife.open.cn/device/ota/esp8266_1.bin\"\n            }\n        ],\n        \"startTime\": 0,\n        \"stopTime\": 600\n    }\n}\n\n\n文件上传模式：\n\n {\n    \"cmd\": 2019,\n    \"ver\": \"1.0\",\n    \"dir\": \"30\",\n    \"timestamp\": 1617787651542,\n    \"msgId\": 231,\n    \"data\": {\n        \"fileMode\": \"UP\",\n        \"fileInfo\": [\n            {\n                \"fileType\": \"PHOTO\",\n                \"url\": \"http://clife.open.cn/device/storage\"\n            }\n        ],\n        \"startTime\": 0,\n        \"stopTime\": 60\n    }\n}\n\n\n\n4.3.2.8.2 响应用于升级回复、查询回复（升级后版本主动上报）或者主动升级查询。请求方向：设备-&gt;平台\n\n\n\n参数名\n类型\n类型\n描述\n\n\n\ncmd\nNumber\n功能码，取值 2000\nY\n\n\nver\nString\n通讯协议版本，通讯双方需要比对版本号，高版本向下兼容，格式示例：1.0\nY\n\n\ndir\nString\n传递方向，同 4.1.1.1\nY\n\n\nmsgId\nNumber\n帧序号，回复帧与请求帧中值相同，否则作为异常处理（丢包、错误）。帧序号由请求方管理，确保帧的唯一性，可做累加计算。\nY\n\n\nprio\nNumber\n功能优先级，高优先级数据报文优先处理，默认中等优先级。优先级等级：0：低优先级1：中优先级&gt;=2：高优先级\nN\n\n\ntimestamp\nString\n时间戳，最小单位毫秒，UTC-8 时区。设备首次注册使用设备本地时间做时间戳，通过平台回复内容再同步时间戳。\nY\n\n\ndata\nObject\n关键数据对象体，HTTP 请求时需要对此数据内容作加密并使用 base64 编码处理，加解密密钥需平台申请 devKey\nY\n\n\nrespCode\nNumber\ndata 中成员，升级结果码，详见表 5.4-1\nY\n\n\nrespCont\nString\ndata 中成员，升级结果描述，详见表 5.4-1\nY\n\n\nproductVer\nNumber\ndata 中成员，产品版本（总版本号），基础版本从 1 开始, respCode 为 3 是必选\nN\n\n\ndevVer\nArray of Object\ndata 中成员，设备版本，包括软件版本、硬件版本、设备编号, respCode 为 3 是必选\nN\n\n\nsoftware\nString\ndevVer 中成员，设备软件（固件）版本，格式“主版本.次版本.修订版本.修复版本”，如1.0.0.0，详见 5.1\nN\n\n\nhardware\nString\ndevVer 中成员，设备硬件版本，格式“主版本.次版本”，如 1.0\nN\n\n\ndevNum\nNumber\ndevVer 中成员，设备编号，特别的，0 代表通信模组\nN\n\n\n示例：文件升级（下载模式）回复：\n{\n    \"cmd\": 2018,\n    \"ver\": \"1.0\",\n    \"dir\": \"03\",\n    \"timestamp\": 1617787651542,\n    \"msgId\": 23454,\n    \"data\": {\n        \"respCode\": 3,\n        \"respCont\": \"ver\",\n        \"productVer\": 2,\n        \"devVer\": [\n            {\n                \"software\": \"1.0.0.0\",\n                \"hardware\": \"1.0\",\n                \"devNum\": 0\n            },\n            {\n                \"software\": \"01\",\n                \"hardware\": \"02\",\n                \"devNum\": 1\n            }\n        ]\n    }\n}\n\n主动升级查询：\n\n{\n    \"cmd\": 2018,\n    \"ver\": \"1.0\",\n    \"dir\": \"03\",\n    \"timestamp\": 1617787651542,\n    \"msgId\": 23454,\n    \"data\": {\n        \"respCode\": 2,\n        \"respCont\": \"SUBFIRM\"\n    }\n}\n\n\n\n5.1 版本号约定格式：主版本.次版本.修订版本.修复版本版本号变化说明如表 5.1-1：\n\n\n\n版本号\n软件\n硬件\n\n\n\n主版本\n软件兼容性变化时递增\n硬件大改动时递增\n\n\n次版本\n软件增加新功能，不影响兼容性时递增\n硬件小改动时递增，非必需\n\n\n修订版本\nBUG 修复时递增\n无\n\n\n修订版本\n优化记录或者测试时递增，非必需\n无\n\n\n\n表 5.1-1 版本号变化说明\n\n版本级别：主版本 &gt; 次版本 &gt; 修订版本 &gt; 修复版本当低一级别的版本号累计到 100 时，递增上一级版本，低一级版本号 归零。\n5.3 功能 ID\n\n\n版本号\n说明\n\n\n\n2000\n注册请求\n\n\n2001\n注册响应\n\n\n2004\n连接请求\n\n\n2005\n连接响应\n\n\n2006\n数据上报请求\n\n\n2009\n数据查询请求\n\n\n2011\n数据控制请求\n\n\n2012\n解绑回复\n\n\n2013\n设备解绑\n\n\n2014\n遗嘱\n\n\n2017\n强制下线\n\n\n2018\n文件操作响应\n\n\n2019\n文件操作请求\n\n\n\n表 5.3-1 功能 ID 统计说明：     功能码在 2000 及以上范围表示设备与服务器使用的功能码；     功能码 2000 以下范围属于本地通信使用，其中 1100 以下范围功 能码用作配网，1100 及以上范围用作设备与网关通信使用。\n\n5.4 升级结果码\n\n\n响应码(respCode)\n描述(respCont)\n说明\n\n\n\n0\n[1,100]\n升级进度信息:1:版本下载完成,开始升级100:升级完成\n\n\n1\n[1,100]\n下载进度信息:1:开始下载100:完成下载\n\n\n2\n[ALL,FIRM,SUBFIRM]\n设备主动请求升级：ALL：设备所有升级固件（默认）FIRM: 设备升级固件新版本请求SUBFIRM: 子设备（插件）的升级固件新版本请求\n\n\n3\n描述信息\n查询响应信息：服务器查询时回复\n\n\n-1\n[0,1,2,X]\n过程异常信息：0:URL非法或设备忙;1:升级中断;2:版本下载完成,校验异常取消升级;X:其他异常信息(可为具体描述)\n\n\n\n表 5.4-1 升级结果码表\n\n具体为：&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;正常升级：{1,1},{1,100},{0,1},{0,100}上报至少 4 个事件&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;升级异常：{-1,0};{-1,1};{-1,2}上报三种情况之一的若干事件&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;主动（重新）请求升级：{2,FIRM} 或者 {2,SUBFIRM}\n","slug":"iot-used","date":"2022-07-19T11:42:09.000Z","categories_index":"IoT,mqtt","tags_index":"Iot,mqtt,c++","author_index":"uuxia"},{"id":"65ce77b5983a73fa652d4b08c40f272d","title":"SSH公钥免密登录","content":"\n  8a45f6bad0c5eda31f44591d6b22cf7530ba935aee346f7f54f7102558f92ebfafb20dbdf81dbe2f773964475504fb1082d31a690047a004c22e4f335858dfb5361dc1d31dd4e158f0aed085ec5f603ddff66ebf60427c76db8167c131743779960b899cfd6429ba14b4d90b99f5d42b33cb71d4a4c2a99db95065e1885d3740fd20c113ed7c0c0e98323daae0cfd7f02f3dbff07059e9d2e77e58f893e15912e7070794bf28615898c125b278f49479bb847f36f912a0d9b7cd1bc3705fb4decb8cfd2ee238ce9985404449f8adf78022217152da69a042ca12c4df55f6fe826ee6471590edfb738003c25751c2cb9770b3eb28a505238a7bd600e0c2ae07b86dd79ff1c163c1e66359fb8f23e3601e5ae029064cd743f3de8632f062ad5e2f81b02ac4ec673d22ed9d92828eaa139bea1c8d1b2b67c3902476bdff5607ee7cf75aadd32704bdb66d3be04b7c5bed63e9989884ac6ed09cf93b55ad2cabeadeee75bf89701061337a44169517c4b8bf64e2ec798cabbb9aee93c4a6619bef1e73ae51e34008028ce083fde826dfb75baa6198c76eddc2120462a421a6d0d75655793fb5936b1ba92c00cf382bf1a7708d5d64ac323f75175ad03e4d5a1a45925feb927680b7d842fdc501ccc196ff08309f9da7d554c796148e3ffe539bc1a77cf0afbac4fdad25a92d5ee02549899a88890d54494d69a17c3c7a636ac3596a6df67c2f50f7058e0522b1a5e9f1228afe1a87db496e1cac63faf057113d39accf0334051ddea0b492086f90b4302b4f1365c4c4dea4823f9eecd4f366730694e714f1daa2c254a4b56d2df0d7ef0bfb8885599de6c86240799f8bd17527b68bba49688a34ebd53a35d04998db273432e76da6a4c224bc27b0f58b320042dfda81aa288ea198a21d1a72314f8621681738d7476992945fcf897a8e973f10f050f2f624166655c1faf8a929c29c8e806ae6d76a60489b446a607bb496fe0777d8f175ee8de06718df5c77748fb3af097adda251f0cf7ac85244f2d55663ae31998459add2616f06a02c39a74c0a124f4486477578c33c84ca48bb13a7135b4209939ede3e024ee36cdafc6423bd1d06f1f9d7b5bc739537533ebbddc4243a1090c63d21d37b7aa98271419cae3d1f2770407c5d7c083159eab1f191b1347997110ec7eed13d46f1b3b65f1551a642e6d2988d957c50c107989d1f0c27e7e32fa08695426f28103bd43287e0e023914b37f819e118e5b7b714d00cc99a203c3fab9f06aab148b0d838a67352ab040524ac724dff4e0e6c5aaed3c1c33528d1291a0f9b95b8c915a54031828d222fb53262008e9ab18f300a4a8e9dce194c54ef3007cf1dde623716edd8daf734ae0d6b3b1a16adafc3f7d78f73c9fdff955c49d8b7a281f741f63eb85b325b04ca942bb3f992ce07bf99cfbd797a3ca3e946ad8937eb76eccabefa14cba83e68ccac7a76a991c76464a5c9e61373b82b6ce5e918fb58ccd2e8e51c26ced5f55ebc4a41a6c6bab1af829a9e11572662acd9217b78e625d6eef760d21873c28034a2f1b044cfe8f0885251924c887d21088f512a37ffb34d11ee76ba53da380f965e502c07997aa9586c45ff9e7261670984a113ac239fe43473e70cbb24b3a8a0afd4c039a05389032732825a4d578743cf68587fd56f14bf87164afdad94929405eda5a1317d8d9ba6a02bace67f7f2b1dab9a5260faafe802b6ea54fe63370b5a8c6b2006b5115d092fd4375d7d836820e334d48e4775712ba75dc49692959a660b90e2b1f4e9f8e5161efe63b0b6cbe8c3ebdd661d287e733fb1a6c8bae7d68fffeebb6502d3d3ddc72e0fc02ba756264ab778be90d6c7b17accdcec0d4f32fa8d668c6a624546e11865758c39bfd59466818ad8c93bcb31518998c8b5ec9d175c8f8d01be4a218a27214a427ac8f98f14c50bfa366af240f0feb076d54d5c9be778379a6f7cf0c355e38fc6bb9d11af50a9c56b74e74549fbef080665373be2c702aba9bf380529cea4ee01b3e837bcd3ba247dd5f5a8c2a1fe2569bf62a3e725a6716f6009b37d70457a62602f54de68b5eda6915ad9c7cc46f7f0b3db9d135239d0282f553c01b5c2f1e91af6b1a46f30ef84977e745e31260a8ce8986d487afcabba91f2b65e8aa6f30a4bdb9a6cc24b74e9b31c4ce739fd3c9b7a1075b34fa9c35dec6a6b0a50a7503a87a24e8cc41c8b3bdd0f796f69640a1942b6e99cbf46a6b6991b59a32ef92dd38a3b905e531faaed3aac019f95adc730b3262f0f34545aa152c1eca387e4b8b824cda272fa9b065d4cf4dee4b650b40162dd9f373011442de9ad6779a23f0866b3f40e1e70183e0f3a8f39390c171b55316eb3de675ce19dcd5d6aaf846f02b238504a94a2c75cef4469be93a0a82eb9adaba7660f39f0cfb39a771978c9dc6721f1833accb0a8b91ef3930f60539cdbd7ae9515c321abb075a793c9409de0acae21c3771cb4396d8864eeb14378fdda7471542b8b7ce150e85821771b85522e939acb2a4b43a1950384c94ae02efb50aee584dc67c4a9549e9d2771421e6ae7f2d5252b631cdee0b0b948d8ac1ad4f908f1a2e401e43f549a41168f17d517f902763d2b2a87d858a17759665f62b70b792e3bcc2cd6a76bc4012b70e0f923b52273822cc7b271e29aec38a593a0043297c7097e5570e51d91f27eb66b1bde1eb6b92fdf17877ac9057870dae8fea285ac5f1bb972ff02f578cc5a7eaaf752ebb3f39ae647f25d652279e5f5465bd94bd9d3c92dfed6022482976f09d557a77328882062faa763eb092ffc06fc741db3cc3e99ff425415b768304aa7c53c7b5dcce43905621156a4b79f339e58a41658763ca81dd22bef1829282330616a8b64d0c7101045cf5de4367cca5ddaba0e01d129adcc97b44fd72b04ddab6b5645274652bf818b92f21f8279d41a9084cbb48b925c2fbbc5e45e05cbd122f2302ac2cf891b671148b4c591867eb10df45f3a7e0ec71fab24a23cc8d927da87cb971956d95ec8d5e857b3021e74a82e27d75d525eda4f3bc8abcca9784c59366f47f6df558edeb59946cba819fb487a10833b12111bce1814630e137c46207ec8aadf230f950538ffa9da7ad8bd58610651ea017ac7a289aeb51532fba79380fa15945340561bdd5e3b5d29d8a90d11cb6062a4f57f92ac09ef1935a31cf838b508b9b11fc1ead8da8ad529043332738e06a08715f5abfad18583393ea79dbec872f0b0a390e63e489ebd9caffcf368ded06e32165d7ba5907a6e208c4dde0a0dd347422edd178f7fd45fa85bb7ccf2bd9b82623c154f065e9a1ecf09ebc62c26baf9a58699ee86a8b523516c45da1bce7cff4803c5723d797498da5dd36becdbe57efaa42e222198820f5f603db8916f4399693a34226a6e08b1d5e15b2269fafa1edd0e4741337b939cfad5332e9732543caf7a50c484cfd179175ca62007e8ef11002c4b4a4278def974852d2edb421152ae837c08c6a686e2956175cf4f1a18119030eb01ba0f59835565b80c0741149fe97570e43de23eb16062a2838476bcec8979c035841f3e6fe05c127300f88ab356403a28edced3598aa713154168c2fee2ba2ece96689e482ca24287e4f6821c9e0b14a1dcb86cdbc0827f77fe639f807b1034fa8e309f1e6aa7c3a166d8376957efa1b85b43cb05e75175cbc8961705689d5f4e3b7ad7e4e67a29c0012755d09a5617893a120d1157ba3567210dd48fc62817d6d763944ba5ec8b94f2262098db35246afa5546f2676021613697a6c8f2ebde502b3dc1891e98994adb62e7a57d48d0d47726f3dba45db9756de5fa2aa668258a4ac5cc17bf74eaab420edd2dbac0f32bee46e72a6de51514a79f21de43dfc5dd77026c2bcc70c9ea63d5b8d42a73087662d0a40563bac7e63df96df83cbf75b16a4742f4a10c944619d865ad986a36edc567e578f4c097d9777a1d382f3497e7889295145c06e4847b15b680ac2e74251d2a018edb7279376284df64082eee5953931e84f4996a23d005c64af96a38dc0409e2032f3fdf26a6c03556ef0078fb4839e0c9fb3b7d69e3f54c9d54c3d3c36c798425af2b2f2ed30d40ebae8f76258b9be4354d73e192eec32f1d4bb82933b34828a66bd6720a874c21ed680c4fdd1a9a3ef28e63ed8f287d48b96ffabafb79250c3b09e9a198e6492f2b6db0b40ef15649d59bbbb68d8f4b6b461f3f5e32254f4d89e3b5c0ad1f0fe0b7faaa9bef199cc9267de5ca49185c398920185929b8cd911e17149fa970d4792d6ae3dec82962edd29aef35b61820b59b50f9f2aa92fd971e2c9a6b4098016135fe5910241792e3f282e226351e2cc6507bf032293a31713f7690ff6401ae1cbc1b0d660ba5a1bed37207c19b38b4442da566461ff67dc1336b3c48557706d1f97787a9e1011683b2bc491a7035e525a1300e1e3c95abc2fe041e47bd64eb9c350caf92644796ee78a4192544b37e3957855772e049e3f7892a590ab416b081621b318327a567cebe69dc849e22cd08c05cf9876c92450a1af611e2e35f0e8101f79b4c4f7b7373b58bd2eb9c349a7b32afac9f8f3355c38ea8aaf6b383bf7ac583961316e773bbb6df5a43c1876c0518c85bfbbab3c4592cb678ab3136801295ac32eedd5a946436af819b6a61226a88fd086ba3554526398bab6c4c9681f930759d7f7a3519607252c8bd585be8f4868978c8fd3acb9b1e62a3f6a49a61b75825d73ea85be14bf4626cff28d27c0a6b97a98d8ff1a8250e08a89e02f0d63a0460401d93f0f5679086a7c3cb6b05e4632e8c9f8b5126fcada75a19cbf2b14b1dd19c9cca2563b92565da79d0b9243f834621c2035ead4721e6318cd2d398a9ded023c38422cd855d6f73319286c43b032b8bdce4a2bcfe04469cb49622e9575556ccd4b911674905aa6a043062176624a27f75560c5956a97f6bfc954341896b9105ae294ea0bff56c10f0bf80f64f10f634aa66380e5056aa08e3420525d4d97b72305806ecf9df2976bdce5bb8bf1cda8cda16fad1c778662df07974bd454f7f7450e50b0691ba808b4561a01f08b4dffa5545b7a916bf5e2229da8fa89d54839cae9181f6355b6b68bb42d792e334957d2f266ef11fbefe6549c7bfd6f668f47f6adf3770c219b6ba46d1b7707ce1c37dc476299fd4ee997a423f29290d5debe1d2158ac37a11105b19532d5c7cb368ab7f9946a4962592c2e5bca8b84f8c51acf335955ce12cab536f752ef75b6a010919a27c51148c54edb37b23872f37c06ad279b66fcc0533f6d4bef214fb84eb128d13102ad74ac92d507a5e6236c841e11c9139cd8e0faad93ad4c7e9215f446ebe05aaf4cb288e08aaef76960827ef8b2cf4bce621d8e03871a68038e76c5a37edf7de93d1a35d7a5a0c53db39d77890025aee47cb3b095cc9b3607050d3628382a4cdd19f4c0e0c7fd9a7e75a7f9f8644662d2ea4925cd7a134632c95a9a5a729f6b22cecf6d153649515f1e6cc784590a47dafa95431bbde7b9dbc0f4eb1ae2f12e53c56027f4672e9e120d8d33dc947c6aef0ec26b056d2b59254dd275b9eb2d654ba40c60aea747bb8d3bd4e4b3d45c77695f23f8912bfb3b2d46ab517ad9d7092e94ff5452c107db7953e9401675c169318dd4f83ae37ef58da396c9cc01960b3ed99381d1c4e16a213a8239069c39c8a57cc05f923b9e74202f9fc05cc3510a4f360c5ed9f851239001f2f60e7f54a27da9a0f940cf27428823f5aa7bdd5cea59b88e11292beaa6fcec25cb55352d966cb0b450ee38aea1cf75ae2072a15827233ebd516b2575adb9561f6a2fd5d505884d9fd591f354513b60d6a1f0f97c1f712c011abc9791906169c83dfd4f8c5e9e187c12150e60bb1366e1fcaec1b64b5082b9dfa89d157d9efaa733e68f58b30586e1a8548eadc25116e687247ed41fb518b16f2100b3b15fa80db6ddfb05271378fc2143f48d8a1403a3cb1ff68887b5cb6b75bde9845e584731d28f7bbc7f5a2f8f17a0651236ac7b046065ea1b69cb1915a286b05ce53d245c8ec0e8dcf22c694fe6d6d3f07d87bc9eed3dba1903f42b98539700ae191d400d7805fd524590af640e55b35a9e0cb11148585894c7e6a2f8576bf0be87ad84299a1335926a02761ac37f6c8d0927ff59db60d53200cae13d26805e89c28294d73ceeb932f40c8b4ee5aef18ec2d1a657a8654f02279a26d73e01ca3b2b5ac6a2afa69ab030fe18163998a884dadaecbf9d9d87bafc0e8de77e85bb42fde28975ad59a5768af6aa311398f5e82c44a053fbdfb516e1b6b2ad1c9e1c0db106cd650fa5ae74eca867dd4255510bf64def1c5c63fcf537001b68d54b5eb123c0d9a340ec7ef5d839757a7d71c3da1dcd4f0e9bcf0f6688067b78a4ee9574cd29cc8452676b058af1962ceee867c7131c310a9d9f5bbaca27e93285d6a28695b95906abbcc670ca83ebb609529fdb1a313c7249ee8ceb5cd3f8e33c5fc062acf11eda4bf63f1253741d12c25356336512e5337e7cecfa7ab6db3a42cb0275710d0a77eae71931934ed4b8ab53d06b3cd99a0bf317118151770d44f58a3f9c1fefca3472e03bce744e64ab71137c87dfdf181898a5a10d8add93d7a78529b39dd2681161193a8ab1fa949bdad3d1b4ef246067d03578b1332675c22ef3c5e3b23757eb07f990cc5a60159dc1edb03d0410aa9efaac245624f0faf9541efbafac76a9ab38a57b5e556b00fb48ea5fce225ad776f4c5886bde3e123246aa15c9e743729b522427602ff2713\n  \n    \n      \n      \n        Hey, password is required here.\n      \n    \n  \n\n","slug":"ssh-pub-login","date":"2022-07-01T12:23:16.000Z","categories_index":"ssh","tags_index":"ssh,pubkey,shell","author_index":"uuxia"},{"id":"9d20369044989ae464d8837e2ee90b3a","title":"ADB保存Android日志","content":"Macos、Windows、linux下如何使用adb保存android手机的日志\n\n\n一、MacOsX、Linux下使用adb保存Android日志adb logcat -c &amp;&amp; adb logcat -v time | grep \"abss\" &gt; /Users/uuxia/Desktop/android.log\n\n\n一、Windows下使用adb保存Android日志adb logcat -c &amp;&amp; adb logcat -v time | find \"abss\" &gt; D:/android.log","slug":"logcat","date":"2022-06-16T03:05:12.000Z","categories_index":"android,logcat","tags_index":"android,logcat,adb","author_index":"uuxia"},{"id":"d11ddb0019b506bf600e2b0e7096fce5","title":"基于Linux(centos/ubuntu)搭建树莓派C/C++程序编译环境","content":"记录在Linux系统下搭建树莓派C/C++程序环境搭建的过程。\n\n\n一、安装gcc/g++\nyum install gcc-c++\n\n\n二、 安装CMake\n下载文件到本地：wget https://github.com/Kitware/CMake/releases/download/v3.13.4/cmake-3.13.4.tar.gz\ntar -xzvf cmake-3.13.4.tar.gz\ncd cmake-3.13.4/\n逐个运行：./bootstrap\nmake\nsudo make install\n\n三、下载交叉编译工具https://developer.arm.com/downloads/-/gnu-a\n\nwget https://armkeil.blob.core.windows.net/developer/Files/downloads/gnu-a/10.2-2020.11/binrel/gcc-arm-10.2-2020.11-x86_64-aarch64-none-linux-gnu.tar.xz\n\n解压：xz -d gcc-arm-10.2-2020.11-x86_64-aarch64-none-linux-gnu.tar.xz解压：tar -xf gcc-arm-10.2-2020.11-x86_64-aarch64-none-linux-gnu.tar.xz\n","slug":"raspberry-build-env","date":"2022-06-15T10:01:41.000Z","categories_index":"C/C++,树莓派","tags_index":"linux,C/C++,树莓派","author_index":"uuxia"},{"id":"3905365a3662483b3f829d38aa0e4f41","title":"小米9基于PixelExperience源码编译步骤","content":"Pixel ExperienceSync\n# Initialize local repository\nrepo init -u https://github.com/PixelExperience/manifest -b twelve\n\n# Sync\nrepo sync -c -j$(nproc --all) --force-sync --no-clone-bundle --no-tags\n\nBuild\n# Set up environment\n$ . build/envsetup.sh\n\n# Choose a target\n$ lunch aosp_cepheus-userdebug\n\n$ lunch aosp_cepheus-user\n\n# Build the code\n$ mka bacon -j4\n\nTurn on caching to speed up buildMake use of ccache if you want to speed up subsequent builds by running:\nexport USE_CCACHE=1\nexport CCACHE_EXEC=/usr/bin/ccache\n\nand adding that line to your ~/.bashrc file. Then, specify the maximum amount of disk space you want ccache to use by typing this:\nccache -M 50G\n\nwhere 50G corresponds to 50GB of cache. This needs to be run once. Anywhere from 25GB-100GB will result in very noticeably increased build speeds (for instance, a typical 1hr build time can be reduced to 20min). If you’re only building for one device, 25GB-50GB is fine. If you plan to build for several devices that do not share the same kernel source, aim for 75GB-100GB. This space will be permanently occupied on your drive, so take this into consideration.\nYou can also enable the optional ccache compression. While this may involve a slight performance slowdown, it increases the number of files that fit in the cache. To enable it, run:\nccache -o compression=true\n\n\nStart the buildTime to start building! Now, type:\ncroot\nmka bacon -j$(nproc --all)\n\n\nInstall the buildAssuming the build completed without errors (it will be obvious when it finishes), type the following in the terminal window the build ran in:\ncd $OUT\n\n\n\nThere you’ll find all the files that were created. The two files of more interest are:\nrecovery.img, which is the PixelExperience recovery image.\nA zip file whose name starts with ‘PixelExperience_’, which is the PixelExperience installer package.\nSuccess! So… what’s next?You’ve done it! Welcome to the elite club of self-builders. You’ve built your operating system from scratch, from the ground up. You are the master/mistress of your domain… and hopefully you’ve learned a bit on the way and had some fun too.\nSubmitting PatchesPatches are always welcome! Please submit your patches to our Gerrit.\nGerrit push guide\n\nunzip platform-tools-latest-linux.zip -d ~\n\n# Now you have to add adb and fastboot to your PATH. Open ~/.profile and add the following:\n# add Android SDK platform tools to path\nif [ -d \"$HOME/platform-tools\" ] ; then\n    PATH=\"$HOME/platform-tools:$PATH\"\nfi\n\ncurl https://storage.googleapis.com/git-repo-downloads/repo &gt; /root/code/twelve/repo\nchmod a+x /root/code/twelve/repo\ncurl https://storage.googleapis.com/git-repo-downloads/repo &gt; /media/psf/aosp/twelve/repo\nchmod a+x /media/psf/aosp/twelve/repo\n\n./repo init -u https://github.com/PixelExperience/manifest -b twelve\n\nrepo init -u https://github.com/PixelExperience/manifest -b twelve\n\n\ngit config --global user.email \"xiaoli.xia@uuxiclife.cn\"\ngit config --global user.name \"uuxia\"\n\n./repo sync -c -j$(nproc --all) --force-sync --no-clone-bundle --no-tags\n\n# Running configuration script:\ncd ~/\ngit clone https://github.com/akhilnarang/scripts\ncd scripts\n./setup/android_build_env.sh\n\n\n./repo sync -c -j$(nproc --all) --force-sync --no-clone-bundle --no-tags\n\nsource build/envsetup.sh\nlunch aosp_cepheus-userdebug\n\nexport USE_CCACHE=1\nexport CCACHE_EXEC=/usr/bin/ccache\n\n# and adding that line to your ~/.bashrc file. Then, specify the maximum amount of disk space you want ccache to use by typing this:\nccache -M 50G\n\nccache -o compression=true\n\ncroot\nmka bacon -j$(nproc --all)\n\n\nexport http_proxy=http://127.0.0.1:1087\nexport https_proxy=http://127.0.0.1:1087\ngit config --global http.proxy http://127.0.0.1:1087\ngit config --global https.proxy http://127.0.0.1:1087\ngit config --global core.gitproxy http://127.0.0.1:1087\n\n\nexport http_proxy=http://127.0.0.1:1080\nexport https_proxy=http://127.0.0.1:1080\ngit config --global http.proxy http://127.0.0.1:1080\ngit config --global https.proxy http://127.0.0.1:1080\ngit config --global core.gitproxy http://127.0.0.1:1080\n\ngit config --global --get http.proxy\ngit config --global --get https.proxy\ngit config --global --get core.gitproxy\n\ngit config --global --unset http.proxy\ngit config --global --unset https.proxy\ngit config --global --unset core.gitproxy\n\n\nhttps://mirrors.tuna.tsinghua.edu.cn/git/AOSP/\n\n\nhttps://android.googlesource.com\n\nsudo chown -R root:root /root/cepheus\n\n\n\n\n","slug":"cepheus","date":"2022-04-28T15:05:47.000Z","categories_index":"AOSP,小米9","tags_index":"cepheus,proxy,android","author_index":"uuxia"},{"id":"d99069053d84cdc5ed107cbb8312c192","title":"terminal代理设置","content":"\n  8a45f6bad0c5eda31f44591d6b22cf7588611db6740aaf37b60e55b90bec518bc1eb700345aa787c7ef1afa6c70569b4348629e0544655146d9e90c01e723f592670b5c271f39b6511a9c2009c109c1f5d18f635ccac9809f1d05865f1c94098b76760725799024d2c6d60baa67ac82df75cbe5e53c5bdae97e78206f35ffdef9324c52b0db9903910efde62de86be7dd64a5b713f7a76b635330b63d74aa1b9b03d52ce395e2f8895e88f7b2907c5fc6f3046462bca019209ba9deb008918c0656fc6d7595900cca65411bf32939be478454729bcc1bcbd0aade6394dd74a94d7be4e1d8e7df6520fb72f8d896448358a2d18125c9897acba6482255393ceaf7a5742db96fd95d57e33a337bcaab5bed261d42f6eb45279ffb4dca557d350de116cace0e229797fdd1126889456ea75a4aa575edfbbdc1056d96d11bfe9ffe609bedf2f66ab5b668c3b3e4d49333aab458532b24b2ee40f5e45dbd9a75b1605455f1273fc4415d011bbad0c5c42785d2184fc06ce9221392f7bd7558d86d909d4b47e1f7cda1df9ccf83befa5d91c62632cd156e42e9377ec6dcf706663431739f669e5a172531e24eb343d963732ddd621dba8a33f56c241c3a67bce97f24ec2347e6f1fd826ef67202a90c773288f76d2027ddd25a9220097da56723e2271207033d08ec99ec5a1db8cddbd5a16df5802c01a03d31b2bb08f04709df5391d1611c37ff28a8252761756c956683ebc9fa33d9ca2a718e7e3fa4029e4dbf9f6eaeb564b92807188b8bfb67c305138e486744cacc988accfc9af1cd7dd757a417b6ad62990f96a4ef3e095ab16e55898d8a1eab26b741ec027f2860cdbdf53b3e0884db469d69ab6c4fdb14022a5d4bde8f6578374492e46296165275415f7945ac71d04a7dd5984508cae83e050f1ebd45bbc7bd5709ae61aadf0b48104ce81b23e5dfe6e30a6857341b6594e3e7bc0051116ebea5fa18ba2f3740cf424b8c2987551c0854480ca49ac50557c86bfdc6f90810dd54d2c356d7738a71363e264364228d43c0bcc300d66f5c042bea2b3e55c315571f2090f4cd2c59cadb1202dba29726087687b2c4d00be247c0f327072c7d1f53490dec8a59d93fd3c08508d9333b69c35dffbe80f62abc70afe5cf13871eccb7817c3991b1ddb482a952bf9b7e0bfefc7852da27eeda7d5386c5fcded053118aa3a7061391d454b46a5f941d54da0fa79b9d5f48665cabc4aae6a407f73da4e6fe4846e959e70a9075b58ba44df62c2fc4da43158ae5dad1ec83f241bbc33d3ee00ef456565a489f396e7e4dacc81914ed375c802bc80e2098bc278ff161019415b5a8815d0bae9265fce396924c9f3ab7ebe226e6d19716a134adfc03eca1f0dc365d77e6474198446b607df6f6871215a4ba296df576143006ed4822452f000247271f54dfeefa5ec79943974500ee9d150ee7b9fe742d6a5379e212c68e4de9651de1399ee59150c40de32094580b267abe8fc26e99568513cbc9c91945b7765255056e3026c568c340dd95e0b2615451bb601b01d7e179c5b9c0d5c0ff52c0d6347a61ee2f377d7322352a63396855ab78d1d5fa924ddf415d0e21297e13bbe22b10d1acd1bef06290b71669b6d81c4aa14b35ed63f444b67239da773e8f303bdd4895814c67118cc938902eced920af854daf8170e719f5b92deee26f545f0f8beead4b313b930fb5920f2e9211e4651bdd2d42ed2cc570ade3db6f3653e3b6f4af63444b534ad8a8f79359f2d36fcadabcd1de82e6d354f49bcb53f08183d5d34de04c2313171acc6579369ab598ed7078b86725519132e0af352eb5abc8fd8404b1451d8b9461e534631d5da0cae7a1656eda9ef6f3af14f072524bf98583b0dcc93671fcf2d80e2285b70b9a6def508b0ca9b95c49ee24b64141ee78135d4c4a74ffe78f1238a8082cad2f69b576cc9b49da303447a4dc1c4a8b71779a6f51437864e0fce56278fc98ac9860554e0974bd0b787263da036075b473e48a03dc58c9fc539e7bb8e8d5c35c4cb976cef217f69992e74bda3c06d0b2b498a950e9a2976933313eca130745e353694debc5c380073834725753046883539f2645261d5e6189fda72923cdc752e9e840a3881ad8bc5e2408ce776dabdbe576bc0736d1dfc268748945edb63d63bf0517a632791e57ef68bdd9bcd6e722fdbb3cd21300cf720aec8913a7bd13b504e61d3c2072e05f64334c8332533e98bffba27e726bdc512ce8ddaf26e78d027e538ea02cd3147da30a617abcb631e57810628f69bf59303bae363d964644ee34698e1f09d1396c25934e4dcd88d992388de8f9ca94494e9320d745427dedd5ed1e900bf1628c4156246feddebf985e057a13668734966a40dd63891079b89c6dc0caff8a65fbbea1c2ce941b1\n  \n    \n      \n      \n        Hey, password is required here.\n      \n    \n  \n\n","slug":"proxysetting","date":"2022-04-28T14:54:33.000Z","categories_index":"proxy","tags_index":"proxy,git,ubuntu","author_index":"uuxia"},{"id":"0c1eacb392731a89d80478197858c183","title":"汽车搭火教程","content":"汽车搭火教程\n\n\n\n","slug":"car-start","date":"2022-03-24T07:15:46.000Z","categories_index":"生活","tags_index":"汽车,搭火","author_index":"uuxia"},{"id":"956269ebd91624d1c17722bebe1e23da","title":"Gradle发布MavenCenter和Nexus私服插件","content":"基于Java语言与Gradle Api开发的Gradle Plugin，本Gradle插件可以让你的library发布到MavenCenter和自己的nexus私服变得非常容易。内置了阿里云Maven中央仓库，其中配置了aliyun代理的central、jcenter、google。\n\n\n\n\n\n一、最新版本(根目录build.gradle)classpath(\"io.github.szhittech:gradle-maven:0.1.0\")\n\n二、功能简介\n支持发布多种类型的库, 例如：Java、Android、Kotlin；\n支持在新的gradle中依赖方式 api / implementation；\n支持签名库资源，包括sources、Javadoc、POM（需要Gradle Version &gt;= 4.8）\n本插件内置了signing签名信息与文件(secring.gpg)\n\n三、使用步骤1. 在根目录build.gradle中新增如下代码classpath(\"io.github.szhittech:gradle-maven:0.1.0\")\n\n\n2. 在library/build.gradle中新增如下代码apply plugin: 'gradle.maven'\n\n四、发布MavenCenter步骤1. 配置根目录下gradle.properties如果发布到MavenCenter，该文件无需配置\n2. 配置library/build.gradleext {\n  groupId = \"io.github.szhittech\"\n  name = \"gradle-maven\"\n  version = \"0.0.0-SNAPSHOT\"\n  description = \"A Gradle Plugin For Java、Android、Kotlin.\"\n  url = \"https://e.coding.net/clife-devops/clifepublic/gradle-maven.git\"\n  connection = \"scm:git@github.com:szhittech/clifesdk.git\"\n  authorId = \"uuxia\"\n  authorName = \"xiamoumou\"\n  authorEmail = \"xxx@clife.com\"\n}\n\n\n\n\n\n参数\n必选\n描述\n\n\n\ngroupId\n是\n项目组织唯一的标识符\n\n\nname\n是\n项目名称\n\n\nversion\n是\n项目版本。有-SNAPSHOT发布快照，没有发布release版\n\n\ndescription\n否\n项目描述\n\n\nurl\n否\n项目地址\n\n\nconnection\n否\n项目地址\n\n\nauthorId\n否\n作者ID\n\n\nauthorName\n否\n作者姓名\n\n\nauthorEmail\n否\n作者邮箱\n\n\n3. 执行发布任务\n\n如上图，点击uploadToMaven，即可将库发布到MavenCenter\n发布MavenCenter成功后 Release版步审核步骤如下：\n\n上述步骤成功后，请登录https://s01.oss.sonatype.org/;\n页面左侧栏点击Build Promotion-&gt;Staging Repositories；\n在Staging Repositories选项卡可以看到刚提交的release版本库，如：iogithubszhittect-xxxx;\n勾选iogithubszhittect-xxxx，点击Close；\n稍等几十秒 Refresh，再次勾选iogithubszhittect-xxxx，点击Release,即可发布成功，等待大概4小时；\n\n4. 自定Maven oss账号配置因本插件与groupId = \"io.github.szhittech\"绑定，如果用户需要添加自己的groupid，则需要在gradle.properties配置Maven oss账号\nMaven oss账号注册，请至https://s01.oss.sonatype.org/注册\ngradle.properties配置如下：\nmaven.name=maven\nmaven.username=你的oss账号\nmaven.password=你的oss密码\nmaven.release=https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/\nmaven.snapshot=https://s01.oss.sonatype.org/content/repositories/snapshots/\n\n\n五、发布Nexus私服步骤1. 配置根目录下gradle.propertiesnexus.name=coding\ncoding.username=xiaoli.xia@clife.cn\ncoding.password=xxxxxx\ncoding.snapshot=https://clife-devops-maven.pkg.coding.net/repository/public-repository/maven-snapshots/\ncoding.release=https://clife-devops-maven.pkg.coding.net/repository/public-repository/maven-releases/\n\n\n\n\n参数\n必选\n描述\n\n\n\nnexus.name\n是\n自定义前缀名称，本例coding，下面字段就都以coding为前缀\n\n\ncoding.username\n是\n私服用户名\n\n\ncoding.password\n是\n私服密码\n\n\ncoding.snapshot\n是\n私服快照版上传地址\n\n\ncoding.release\n是\n私服release版上传地址\n\n\n2. 配置library/build.gradleext {\n  groupId = \"io.github.szhittech\"\n  name = \"gradle-maven\"\n  version = \"0.0.0-SNAPSHOT\"\n  description = \"A Gradle Plugin For Java、Android、Kotlin.\"\n  url = \"https://e.coding.net/clife-devops/clifepublic/gradle-maven.git\"\n  connection = \"scm:git@github.com:szhittech/clifesdk.git\"\n  authorId = \"uuxia\"\n  authorName = \"xiamoumou\"\n  authorEmail = \"xxx@clife.cn\"\n}\n\n\n\n\n\n参数\n必选\n描述\n\n\n\ngroupId\n是\n项目组织唯一的标识符\n\n\nname\n是\n项目名称\n\n\nversion\n是\n项目版本。有-SNAPSHOT发布快照，没有发布release版\n\n\ndescription\n否\n项目描述\n\n\nurl\n否\n项目地址\n\n\nconnection\n否\n项目地址\n\n\nauthorId\n否\n作者ID\n\n\nauthorName\n否\n作者姓名\n\n\nauthorEmail\n否\n作者邮箱\n\n\n3. 执行发布任务\n\n如上图，点击uploadToCoding，即可将库发布到Nexus私服\n注意：这里的Coding就是上文自定义的前缀(nexus.name)\n友情链接：\n1. android发布三方库到远程maven仓库详细教程\n2. 发布Android Lib到Maven Central\n","slug":"gradle-maven","date":"2022-03-21T10:46:12.000Z","categories_index":"gradle,maven","tags_index":"java,gradle,android,maven,Kotlin","author_index":"uuxia"},{"id":"3c34a0b2b799068430d02a7d43648438","title":"netty粘包断包处理","content":"基于Netty的TCP Server，处理二进制数据断包和粘包，以及tcp发送字符串的截取处理！\n\n\n基于Netty的TCP Server，处理二进制数据断包和粘包，以及tcp发送字符串的截取处理！\n\n\n\n一、5A协议在Netty中处理断包粘包\n   长度[2] 1  1    设备编码[8]       Mac地址[6]    帧序号[4] 保留[8]          命令字[2] Body                                                             CRC2[2]\n5A 0042   40 00   00000199000B0301 8C18D9FFEB9D 00000046 0000000000000000 0104     0000000001000301000000000000000000000003000200000000000000000000 050B\n\n说明：\n   1. 长度len=0042(HEX)=66=(34+32)不包含5A;\n   2. 空包长度total=35；\n   3. 包头5A(1byte)不算在len区；\n\n\nint maxFrameLength      = 65535;   （len是两个byte，所以最大长度是无符号两个byte的最大值）\nint lengthFieldOffset   = 1;       （len的索引下表是1，下表从0开始）\nint lengthFieldLength   = 2;       （len是两个byte）\nint lengthAdjustment    = -2;      （netty从len后面开始读取，5A不在len中，len又是2byte，所以这里是-2）\nint initialBytesToStrip = 0;       （这个0表示完整的协议内容，如果不想要5A，那么这里就是1）\n\nsocketChannel.pipeline().addLast(new LengthFieldBasedFrameDecoder(maxFrameLength, lengthFieldOffset, lengthFieldLength, lengthAdjustment, initialBytesToStrip));\n\n测试断包发送：\n完整数据包：5A0042400000000199000B03018C18D9FFEB9D00000046000000000000000001040000000001000301000000000000000000000003000200000000000000000000050B\n第一次发送（一包半）：5A0042400000000199000B03018C18D9FFEB9D00000046000000000000000001040000000001000301000000000000000000000003000200000000000000000000050B 5A0042400000000199000B03018C18D9FFEB9D0000004600000000000000000104\n第二次发送（补齐后半包）：0000000001000301000000000000000000000003000200000000000000000000050B\n\n\n二、水机起始码  功能码 数据长度      Body                         CRC\nA2      10     0E        0102030405060708091011121314 050B\n\n\n说明：\n1.len=0E(HEX)=14,这里的len仅仅是Body的长度，不包含head的长度;\n\n\nlengthFieldOffset   = 2\nlengthFieldLength   = 1\nlengthAdjustment    = 2   \ninitialBytesToStrip = 0\nmaxFrameLength      = 255\n\n\nhttps://blog.csdn.net/lzwglory/article/details/80242209\nhttps://blog.csdn.net/zougen/article/details/79037675\nhttps://www.jianshu.com/p/a0a51fd79f62\nhttps://www.cnblogs.com/workharder/p/12325908.html\n","slug":"netty-tcp-packet-decoder","date":"2022-02-18T05:22:58.000Z","categories_index":"netty","tags_index":"netty,tcp,server","author_index":"uuxia"},{"id":"0adae615d1625b818374c40f1991b4b1","title":"树莓派设置proxy","content":"树莓派设置proxy\n\n\n设置步骤：\n1. cd /etc/apt/apt.conf.d\n2. sudo nano 10proxy\n3. Acquire::http::Proxy \"http://192.168.31.53:1090\";\n4. reboot\n\n","slug":"pi-proxy","date":"2022-02-14T03:54:21.000Z","categories_index":"Raspberry,proxy","tags_index":"shadowsocks,proxy,raspberry","author_index":"uuxia"},{"id":"2eb7e7ff9d5e84c8f4e4de748ecb81fe","title":"git使用SSH进行无密码身份验证","content":"git使用SSH进行无密码身份验证\n\n\n一、生成keyed25519方式\nssh-keygen -t ed25519 -C \"uuxia@uuxia.cn\"\ncat ~/.ssh/id_ed25519.pub\n\n\nrsa方式ssh-keygen -t rsa -C \"uuxia@uuxia.com\"\ncat ~/.ssh/id_rsa.pub\n\n二、测试githubssh -T git@github.com\ngiteessh -T git@gitee.com\ncodingssh -T git@e.coding.net\n\n注意\n在个人设置里面添加前，必须删除单独项目中添加的ssh key！！！\n","slug":"gitssh","date":"2022-02-11T09:23:20.000Z","categories_index":"Git,SSH","tags_index":"git,github,gitee,coding","author_index":"uuxia"},{"id":"e3f248fb2e17f38235823b82ea75c967","title":"centos服务器程序安装指南","content":"主要记录我的centos服务器上的服务环境安装，frp、nginx配置、java程序、mysql安装、个人博客hexo。\n\n\n1. nginx配置安装\nyum install nginx\n\n配置代码\n\nnano /etc/nginx/nginx.conf\n\n\n\n\n\nnginx.conf\nuser root;\nworker_processes auto;\nerror_log /var/log/nginx/error.log;\npid /run/nginx.pid;\n\n\ninclude /usr/share/nginx/modules/*.conf;\n\nevents {\nworker_connections 1024;\n}\n\nhttp {\nlog_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n'$status $body_bytes_sent \"$http_referer\" '\n'\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    sendfile            on;\n    tcp_nopush          on;\n    tcp_nodelay         on;\n    keepalive_timeout   65;\n    types_hash_max_size 2048;\n    client_max_body_size 500m;\n    include             /etc/nginx/mime.types;\n    default_type        application/octet-stream;\n\n    include /etc/nginx/conf.d/*.conf;\n\n\n\n}\n\n\nadmin.confserver {\n        listen       80;\n        server_name  admin.uuxia.cn;\n        \n        location / {\n           index index.html index.htm;\n           proxy_set_header Host $host;\n           proxy_pass https://127.0.0.1:8082/;\n           proxy_set_header Upgrade $http_upgrade;\n           proxy_http_version 1.1;\n           proxy_set_header Connection \"upgrade\";\n           proxy_redirect https://127.0.0.1/admin https://127.0.0.1:8080/;\n       }\n       \n}\n\n\nfile.confautoindex on;# 显示目录\nautoindex_exact_size off;# 显示文件大小\nautoindex_localtime on;# 显示文件时间\nserver {\n        listen       80;\n        server_name  file.uuxia.cn;\n\n        charset gbk,utf-8;\n        \n\n        location / {\n            root /home/;\n            index  index.html index.htm;\n            charset utf-8;\n        }\n\n }\n\n\ncloud.confserver {\n        listen       80 default_server;\n        server_name  cloud.uuxia.cn;\n\n        location / {\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Host $http_host;\n            proxy_redirect off;\n            proxy_pass http://127.0.0.1:5212;\n\n            # 如果您要使用本地存储策略，请将下一行注释符删除，并更改大小为理论最大文件尺寸\n            # client_max_body_size 20000m;\n        }\n    }\n\n\njava.conf\n\nserver {\n        listen       80;\n        #listen       [::]:80 default_server;\n        server_name  uuxia.cn;\n        #root         /usr/share/nginx/html;\n        #charset gbk,utf-8;\n#        charset utf-8;\n        location ^~ /frp_server_web/{\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header Host $http_host;\n            proxy_pass http://127.0.0.1:9090;\n        }\n\n        location / {\n            root /home/file/xxl6097.github.io;\n            index index.html index.htm;\n            charset utf-8;\n        }\n        location /file {\n            alias /home/file;\n            autoindex on;\n            autoindex_exact_size off;\n            autoindex_localtime on;\n            charset utf-8;\n        }\n\n        location /websocket{\n            proxy_pass https://127.0.0.1:8082;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"upgrade\";\n            proxy_read_timeout 3600s;\n        }\n        location /admin/ {\n           index index.html index.htm;\n           proxy_set_header Host $host;\n           proxy_pass https://127.0.0.1:8082/;\n           proxy_set_header Upgrade $http_upgrade;\n           proxy_http_version 1.1;\n           proxy_set_header Connection \"upgrade\";\n           proxy_redirect https://127.0.0.1/admin https://127.0.0.1:8080/;\n       }\n       \n\n       location ~* ^(/v2|/webjars|/swagger-resources|/swagger-ui.html){\n         proxy_set_header Host $host;\n         proxy_set_header  X-Real-IP  $remote_addr;\n           proxy_set_header X-Forwarded-For $remote_addr;\n         #proxy_set_header Host $host:$server_port;\n         proxy_set_header X-Forwarded-Proto $scheme;\n         proxy_set_header X-Forwarded-Port $server_port;\n         proxy_pass https://127.0.0.1:8082; # 后端服务地址\n       }\n\n       location /v1 {\n         proxy_set_header Host $host;\n         add_header 'Access-Control-Allow-Origin' '*';\n         add_header 'Access-Control-Allow-Headers' 'X-Requested-With';\n         add_header 'Access-Control-Allow-Methods' 'GET,POST,OPTIONS';\n         proxy_pass https://127.0.0.1:8082;\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n\n# Settings for a TLS enabled server.\n#\n    server {\n        listen       443 ssl http2 default_server;\n       # listen       [::]:443 ssl http2 default_server;\n        server_name  uuxia.cn;\n       # root         /usr/share/nginx/html;\n        ssl_certificate \"/etc/pki/nginx/server.crt\";\n        ssl_certificate_key \"/etc/pki/nginx/private/server.key\";\n        ssl_session_cache shared:SSL:1m;\n        ssl_session_timeout  10m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;\n        #ssl_ciphers PROFILE=SYSTEM;\n        ssl_prefer_server_ciphers on;\n#        charset gbk,utf-8;\n\n\n        client_max_body_size 500m;    \n        location / {\n            root /home/file/xxl6097.github.io;\n            index index.html index.htm;\n            #proxy_pass https://127.0.0.1:8082/;\n            #proxy_redirect https://127.0.0.1/admin https://127.0.0.1:8082/;\n            charset utf-8;\n        }\n        location /file {\n            alias /home/file;\n            autoindex on;\n            autoindex_exact_size off;\n            autoindex_localtime on;\n            charset utf-8;\n        }\n\n        location /v1 {\n            proxy_set_header Host $host;\n            add_header 'Access-Control-Allow-Origin' '*';\n            add_header 'Access-Control-Allow-Headers' 'X-Requested-With';\n            add_header 'Access-Control-Allow-Methods' 'GET,POST,OPTIONS';\n            proxy_pass https://127.0.0.1:8082;\n        }\n        location /admin/ {\n           index index.html index.htm;\n           proxy_set_header Host $host;\n           proxy_pass https://127.0.0.1:8082/;\n           proxy_set_header Upgrade $http_upgrade;\n           proxy_http_version 1.1;\n           proxy_set_header Connection \"upgrade\";\n           proxy_redirect https://127.0.0.1/admin https://127.0.0.1:8080/;\n       }\n       \n\n       location ~* ^(/v2|/webjars|/swagger-resources|/swagger-ui.html){\n         proxy_set_header Host $host;\n         proxy_set_header  X-Real-IP  $remote_addr;\n           proxy_set_header X-Forwarded-For $remote_addr;\n         #proxy_set_header Host $host:$server_port;\n         proxy_set_header X-Forwarded-Proto $scheme;\n         proxy_set_header X-Forwarded-Port $server_port;\n         proxy_pass https://127.0.0.1:8082; # 后端服务地址\n       }\n\n        location /websocket{\n            proxy_pass https://127.0.0.1:8082;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"upgrade\";\n            proxy_read_timeout 3600s;\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n#\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n\n\n\n\n2. mysql安装配置1.下载MySQL\nRed Hat Enterprise Linux / Oracle Linux\n2. 选择 `Red Hat Enterprise Linux 8 / Oracle Linux 8 (x86, 64-bit), RPM Bundle\n\n安装\nwget https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.28-1.el8.x86_64.rpm-bundle.tar\ntar -xvf mysql-8.0.28-1.el8.x86_64.rpm-bundle.tar \nrpm -ivh mysql-community-common-8.0.28-1.el8.x86_64.rpm --nodeps --force\nrpm -ivh mysql-community-libs-8.0.28-1.el8.x86_64.rpm --nodeps --force\nrpm -ivh mysql-community-client-8.0.28-1.el8.x86_64.rpm --nodeps --force\nrpm -ivh mysql-community-server-8.0.28-1.el8.x86_64.rpm --nodeps --force\n通过 rpm -qa | grep mysql 命令查看 mysql 的安装包\n\n\n通过以下命令，完成对 mysql 数据库的初始化和相关配置\n\nmysqld --initialize;\nchown mysql:mysql /var/lib/mysql -R;\nsystemctl start mysqld.service;\nsystemctl enable mysqld;\n\n通过 cat /var/log/mysqld.log | grep password 命令查看数据库的密码\n通过 mysql -uroot -p 敲回车键进入数据库登陆界面\n通过 ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'Xxl2475431305.'; 命令来修改密码ALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'Xxl2475431305.';这下密码改成了 root\n通过 exit; 命令退出 MySQL，然后通过新密码再次登陆\n通过以下命令，进行远程访问的授权\ncreate user 'root'@'%' identified with mysql_native_password by 'root';\n\ngrant all privileges on *.* to 'root'@'%' with grant option;\n\nflush privileges;\n\n\nsqlyog链接时出现2058异常\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';其中password为自己修改的密码。然后SQLyog中重新连接，则可连接成功，OK。\n如果报错：ERROR 1396 (HY000): Operation ALTER USER failed for ‘root’@’localhost’则使用下面命令：\nALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'Xxl2475431305.';\n\n3. JDK安装配置方式一（推荐）查询安装的jdk版本\nyum -y list java*\n安装jdk1.8\nyum install -y java-11-openjdk.x86_64\n\n方式二下载https://www.oracle.com/java/technologies/downloads/#java8\n\nMac：https://download.oracle.com/otn/java/jdk/8u321-b07/df5ad55fdd604472a86a45a217032c7d/jdk-8u321-macosx-x64.dmg\nLinux：https://download.oracle.com/otn/java/jdk/8u321-b07/df5ad55fdd604472a86a45a217032c7d/jdk-8u321-linux-x64.tar.gz\nWindows：https://download.oracle.com/otn/java/jdk/8u321-b07/df5ad55fdd604472a86a45a217032c7d/jdk-8u321-windows-x64.exe\n\n选择 `jdk-8u321-linux-x64.tar.gz`\n\n解压 `tar -zxvf jdk-8u321-linux-x64.tar.gz`\n\n\n\n修改环境变量 `nano /etc/profile`\n\nexport JAVA_HOME=/usr/lib/jdk1.8.0_321\nexport CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n\nsource /etc/profile\n\n4. gralde安装wget https://services.gradle.org/distributions/gradle-6.7-bin.zip\n\nunzip gradle-6.7-bin.zip\n\nnano ~/.bash_profile\n\nPATH=$PATH:/usr/lib/gradle-6.7/bin\n\nsource ~/.bash_profile\n\n\n5. 安装frps安装服务端配置\n[common]\nbind_port = 8000\ntoken = xxxxxxxxx\ndashboard_port=8888\ndashboard_user = admin\ndashboard_pwd = admin\nvhost_http_port = 9090\nvhost_https_port = 9091\nsubdomain_host = uuxia.cn\n\n客户端配置[common]\ntls_enable = true\nadmin_addr = 0.0.0.0\nadmin_port = 7400\nadmin_user = admin\nadmin_pwd = admin\ntoken = xxxxxx\n#server_addr = 127.0.0.1\nserver_addr = uuxia.cn\nserver_port = 8000\n\n[公司-树莓派3B]\ntype = tcp\nlocal_ip = 0.0.0.0\nlocal_port = 22\nremote_port = 2222\n\n[公司-FRP客户端管理页面]\ntype = tcp\nlocal_ip = 0.0.0.0\nlocal_port = 7400\nremote_port = 7401\n\n[公司-win]\ntype = tcp\nlocal_ip = 192.168.31.53\nlocal_port = 3389\nremote_port = 7001\n\n[公司-iMac-VNC]\ntype = tcp\nlocal_ip = 192.168.31.92\nlocal_port = 5900\nremote_port = 7002\n\n[公司-iMac-SSH]\ntype = tcp\nlocal_ip = 192.168.31.92\nlocal_port = 22\nremote_port = 70036. 安装Node.js\n1 下载\n\n官网地址：https://nodejs.org/en/download/\nwget https://nodejs.org/dist/v10.24.0/node-v10.24.0-linux-x64.tar.gz\n安装\n\ntar -xvf node-v10.24.0-linux-x64.tar.gz\nmv node-v10.24.0-linux-x64 /opt/Nodejs\nNODE_HOME=/opt/Nodejs\nexport PATH=$NODE_HOME/bin:$PATH\nsource /etc/profile\n\nnpm install -g hexo-cli\n\nnpm uninstall hexo-cli -g  推荐这个，成功卸载\n\n\n7. 页脚备案代码\n&lt;div style=\"color:#666;text-align:center;margin-top:-10px;padding-bottom:35px;\"&gt;\n    &lt;p&gt;&lt;a style=\"color:#666;\" text-decoration:underline;\" href=\"http://beian.miit.gov.cn/\"&gt;工业和信息化部备案管理系统网站 粤ICP备2022014941号&lt;/a&gt;&lt;/p&gt;\n    &lt;p&gt;主办单位：&lt;a style=\"color:#666;\" text-decoration:underline;\" target=\"_blank\" href=\"http://uuxia.cn\"&gt;悠悠科技&lt;/a&gt;&lt;/p&gt;\n    &lt;p&gt;Operated by Guangzhou ChoMeng Computer System Co., Ltd.&lt;/p&gt;\n&lt;/div&gt;\n\n","slug":"centos-server","date":"2022-02-11T07:34:03.000Z","categories_index":"hexo,nginx,frp","tags_index":"centos,hexo,java,frp,nginx,mysql,gradle","author_index":"uuxia"},{"id":"c387dedd6df553ad54ae674f39db122f","title":"hexo写文章使用说明","content":"如何使用hexo作文章\n\n\n\n1. 内容说明---\ntitle: hexo写文章使用说明\ndate: 2022-02-09 14:08:49\ntags: [写作,hexo]\ncategories: hexo\n---\n如何使用hexo作文章\n\n&lt;!--more--&gt;\n\n\n\n\n2. 新建文章可用Hexo命令创建：hexo new vpn使用\n\n\n\n3. 构建和发布hexo g -d\n\n","slug":"使用说明","date":"2022-02-09T06:08:49.000Z","categories_index":"Hexo","tags_index":"hexo,写作","author_index":"uuxia"},{"id":"d6b11669577484ee709769c3494f66ce","title":"腾讯云【centos7/8】一键安装 shadowsocks-libev","content":"CentOS 7/8 一键安装 shadowsocks-libev, 本教程仅提供学习，请勿用于商业用途和不法行为。\n由于 Google BBR 需要内核版本 4.9 以上，如果安装时内核版本低于 4.9 建议先升级内核版本。\n提示：CentOS 7 自带内核版本为 3.10，CentOS 8 自带内核版本为 4.18。\n查看内核版本命令：\nuname -r\n\n1、下载脚本一键脚本已集成TCP优化、自动开启Google BBR（限 4.9 或更高版本内核）、自动安装 shadowsocks-libev\nwget https://down.24kplus.com/linux/shadowsocks/centos-shadowsocks-libev.sh\n2、执行脚本进行安装chmod +x centos-shadowsocks-libev.sh &amp;&amp; ./centos-shadowsocks-libev.sh\n3、根据shell脚本提示输入相关信息1、提示设置SS密码，输入自定义密码后按回车，也可以直接按回车使用默认密码2、接下来选择SS要使用的服务器端口，输入自己喜欢的端口， 也可以直接按回车使用默认端口3、 然后选择加密方式（仅保留相对安全的加密方式），如果选择chacha20的话，就输入对应序号3，按回车继续4、 安装完成后，会有如下图安装成功的提示，记住各项信息，在客户端连接时需要用到\n4、shadowsocks管理\n#!/bin/bash\n\nfunction status() {\n    systemctl status shadowsocks-libev.service\n}\n\nfunction restart() {\n    systemctl restart shadowsocks-libev.service\n}\n\nfunction log() {\n    journalctl -f -u shadowsocks-libev.service\n}\n\nfunction m() {\n    echo \"1. 重启\"\n    echo \"2. 重看状态\"\n    echo \"3. 查看日志\"\n    echo \"请输入编号:\"\n    read index\n\n    case \"$index\" in\n    [1]) (restart);;\n    [2]) (status);;\n    [3]) (log);;\n    *) echo \"exit\" ;;\n  esac\n}\n\nm\n\n\n\n","slug":"tencent-shadowsocks","date":"2021-09-08T09:29:21.000Z","categories_index":"VPN,shadowsocks,centos7","tags_index":"shadowsocks,centos,腾讯云","author_index":"uuxia"},{"id":"db83931b422b43af6580741bf7713026","title":"国庆长假新疆旅行-北疆环游","content":"行程速览\n\n\n\n注意事项：\n日照强烈日夜温差大，做好防晒带好冲锋衣或羽绒服（特别是喀纳斯地区，观鱼亭山顶大风变幻莫测）;\n新疆各景点之间距离较远，基本每天换酒店，一次性生活用品带足（建议内裤袜子毛巾也最好买一次性）;\n自驾比较随性，建议当天订隔天酒店即可（最好订景区附近城镇，性价比高又干净;\n车子油箱少于一半见到加油站就满上;\n开车要注意区间限速，哪怕前面一望无际，也只能慢慢的开;\n新疆买东西是按公斤计算，吃饭菜量很大，北方人可能没感觉，南方去的点菜要注意量;\n治安绝对可靠安全，各种检查，当地百姓纯朴善良（详细后文会说）;\n外地卡去新疆只有克拉玛依有4G，其他地区一概没有，建议到新疆第一天办张当地上网卡.\n\nD1(9月27号):深圳-乌鲁木齐行程安排：\n去酒店放下行李；\n时间充足的话，可以去【新疆博物馆】，感怀西域历史的沧桑变化；\n如果想要体验感受浓郁异域风情，推荐可以去【二道桥国际大巴扎】，独特的西域文化，琳琅满目的商品及各种新疆特色美食，说不定还能淘到不少好货；\n找超市备货；\n预定好下一站可可托海的住宿；\n\n\n\n\n注意事项：\n晚上21:00以后才会天黑；\n\nD2(9月28号):乌鲁木齐-准噶尔盆地-可可苏里湖-可可托海镇行程安排：\n途中小镇午餐；\n继续北上穿越准噶尔盆地，驶向阿勒泰山腹地；\n路经古尔班0烤馕、凉皮、炒面、烤串，地道的羊羔肉;\n一路上大概过了十几个安检站\n\n车程：\n约520KM（高速、国道为主）;\n区间测速80km；\n行车路线\n\n\n\n\nD3(9月29号):可可托海镇-可可托海国家地质公园-五彩滩-布尔津费用：\n可可托海风景区（门票：90，区间车：36）；\n五彩滩景区（门票：50，建议游玩2小时）；\n\n行程安排：\n早餐后，前往“世界地质公园”【可可托海国家地质公园】，又称额尔齐斯河大峡谷；\n进景区需要办理“边境通行证”，在购票处出示身份证办理即可；\n景区车一路沿额尔齐斯河河谷前行；\n沿途欣赏金秋的白桦林、石门、夫妻树等，游玩拍摄可可托海著名的标志【神钟山】；\n之后可以沿着额尔齐斯河峡谷往里徒步深入一段；\n驾车到富蕴县继续大众点评找午餐，午餐后富蕴县——北屯——布尔津——五彩滩；\n游览五彩滩景区后返回布尔津，晚餐并游览著名的布尔津美食街；\n9点回布尔津市区，入住布尔津国际酒店\n\n注意事项：\n进景区需要办理“边境通行证”，在购票处出示身份证办理即可\n景区不必走到山顶中蒙边境，后半程风景和前半程类似，另外可以沿中间河边的石子路走，景色更美；\n\n车程：\n自驾全程350公里，6小时左右。\n布尔津-五彩滩：距离40KM，车程50分钟（此段有区间测速，60）；\n富蕴县-布尔津 全程国道，有测速，而且还有流动测速（路边放个临时测速器，CT就停在暗处）；\n行车路线\n\n\n\n\n\nD4(9月30号):布尔津-喀纳斯-贾登峪#####费用：\n\n门票185元/人，门票站到游客中心100元/人，游客中心到观景台120元/人，游船120元/人\n\n行程安排：\n布尔津到贾登峪门票站，135公里，区间测速必须要开3个小时；\n买喀纳斯景区门票坐景区大巴1小时到游客中心；\n在游客中心用餐，然后分头行动，上观鱼台的上观鱼台（要爬1068步梯坎才能到观鱼台，去湖边的去湖边\n耍了2个多小时后回游客中心坐大巴出景区；\n返程沿途游览三湾（三湾里就月亮湾最为有代表性，另外两个需要清晨漫步才有感觉，这样就必须在喀纳斯景区里住）；\n回贾登峪后自驾1个小时前往禾木门票站，转大巴1小时到禾木村入住；\n\n注意事项：\n去喀纳斯之前请在布尔津把油箱加满，这来回路上没有加油站\n进去喀纳斯一定要裹严实了，冲锋衣羽绒服都穿起来;\n区间车要坐在面向车头的右手边，区间车要坐半个小时，右手边会看到山谷，左手边就只能看堡坎了..\n布尔津到喀纳斯后半截的路上，大客车巨多，越往后面山路也最多，安检站也多\n\n车程：\n自驾全程135公里，3小时左右。\n全程区县测速限速：60km；\n去程走大路，返程走小路；\n行车路线\n\n\n\n\n\nD5(10月1号):贾登峪-禾木一日游-禾木村到达禾木村差不多上午10点左右。\n费用：行程安排：\n上午游览村庄北面的白桦林、草原；\n中午回去睡了个午觉；\n下午骑马到村庄南面观景台，河边游玩（强烈推荐3小时的美丽峰骑马游，200元/人，其实性价比非常之高，谁骑谁知道）；\n傍晚大家可以前往【禾木日落观景台】，俯瞰禾木村全景\n晚上，可以干点想干的事。。。\n\n注意事项：\n下午4、5点钟的时候太阳巨大巨晒，注意选择时间\n\n车程：\n距离70KM，2个半小时车程；\n行车路线\n\n\n\n\n\nD6(10月2号):禾木村-乌尔禾胡杨林-魔鬼城-乌尔禾费用：\n门票+观光车 98/人\n\n行程安排：\n6点半起床上观景台拍日出，是否能看到晨雾美景就需要点运气了；\n驾车回布尔津午餐；\n魔鬼城景区里坐小火车一路前行\n\n注意事项：\n禾木景区出来的这段景色超美，路边设有多个观景台，可供停车拍照；\n魔鬼城合适摄影，特别是日出和日落的时候，景区是24小时开放，但日落要10点过，不要去太早 注意选择时间\n乌尔禾，入住博玉大酒店，性价比相当高哦,附近美食也超多;\n在马路对面吃到最好吃的一家大盘鸡！还有塔城的特色风干牛肉、特色拉条子;\n\n车程：\n禾木-布尔津-克拉玛依：距离470KM，10小时车程（前半段国道有区间测速，后半段高速）；\n布尔津-克拉玛依这段横风很大，开车要双手握紧方向盘；\n行车路线\n\n\n\n\n\nD7(10月3号):乌尔禾-果子沟大桥-赛里木湖费用：\n门票70一人\n\n行程安排：\n中午下道去乌苏市区找大众点评美食（要稍早到达赛里木，后面景点较多，不建议在乌苏就餐）；\n大约下午5点才到赛里木湖，环湖一圈玩了3个小时后；\n入住果子沟大桥绝佳观景台唯一的山庄；\n早点的话，可以上观景台看全景。\n\n\n\n注意事项：\n可入住龙岭山庄，山顶北可观赛里木湖全景，南可俯揽果子沟大桥全景；\n龙岭山庄8点半开始供应早餐\n\n车程：\n自驾全程600公里，不耽误只要6个小时；\n行车路线\n\n\n\n\n\nD8(10月4号):赛里木湖-九曲十八弯日落-巴音布鲁克镇费用：行程安排：\n早起去拍赛里木湖日出全景；\n出发，路径伊犁看薰衣草；\n午餐可以在高速服务区用餐；\n看巴音布鲁克景区欣赏九曲十八弯的日落\n\n注意事项：\n巴音布鲁克景区过了晚上8点不准进；\n到达巴音布鲁克镇上，可以入住龙兴国际大酒店\n如果到的比较早，那么就今天游玩完巴音布鲁克景点\n\n车程：\n自驾全程450公里，7小时左右。\n行车路线\n\n\n\n\n\nD9(10月5号):巴音布鲁克镇-天鹅湖-九曲十八弯-独库公路-乌鲁木齐费用：\n景区门票+保险+观光车，170一人\n\n行程安排：1.上午进巴音布鲁克景区游览天鹅湖和九曲十八弯；2.中午在巴音布鲁克镇上撸了本次行程最美味的羊肉串后出发；3.下午：号称中国最美公路的天山天路——独库公路，欣赏沿途一日四季美景；4.直接杀到乌鲁木齐。\n注意事项：\n晚上8点加油站关门\n尽量早点出发，因为去乌鲁木齐有500km，最晚不能超过13点\n\n车程：\n行车路线\n\n\n\n\n\nD10(10月6号):乌鲁木齐一日游待定。。。。\n\nD11(10月7号):乌鲁木齐一深圳乌鲁木齐—-飞–深圳\n\n友情链接\n【2017自驾游】有一种诗和远方叫新疆！北疆9日环线落地自驾游记\n\n说走就走的北疆自驾十日游（攻略+建议）；\n\n\n","slug":"xj-north-circle","date":"2019-10-21T08:57:49.000Z","categories_index":"旅行","tags_index":"新疆,北疆","author_index":"uuxia"},{"id":"0670bb48035640620318bcdcbb65df82","title":"健身运动","content":"\n健身圈从来就是一个强者的舞台，有的人通过健身强健了体魄，有的人通过健身找到了自信。正所谓“一入健身深似海”，健身就是有这样的魔力让你欲罢不能。\n\n\n\n深蹲跳\n锻炼部位：股四头肌、腘绳肌、臀大肌、腓肠肌。\n\n\n俯卧撑\n锻炼部位：胸大肌、肱三头肌。\n\n\n开合跳\n锻炼部位：股四头肌、三角肌、比目鱼肌、腓肠肌。\n\n\n登山者\n锻炼部位：股四头肌、腘绳肌、胸肌。\n\n\n波比跳\n锻炼部位：股四头肌、三角肌、腹直肌。\n\n\n\n\n—贵在坚持—\n","slug":"lifehealth","date":"2018-05-21T06:00:14.000Z","categories_index":"生活","tags_index":"生活,运动","author_index":"uuxia"},{"id":"d9f74a797f08df0b0fe9d63aaea4208d","title":"树莓派3B(Raspberry 3B)搭建HomeAssistant","content":"Home Assistant 是一款基于 Python 的智能家居开源系统，支持众多品牌的智能家居设备，可以轻松实现设备的语音控制、自动化等。本文档全站内容基于 Home Assistant 官方网站 本地化而成，具有以下特点：\n整合『组件』与『文档』页，采用更直观清晰、符合中文阅读的展现形式；剔除国内用户较少接触的组件说明，提高常用智能家居平台的层级和权重；跳出 Home Assistant 原生框架，一并纳入 Floorplan、HADashboard 等相关衍生项目；本文将讲述树莓派3B搭建HomeAssistant和小米设备的接入。# 一、系统要求和硬件配置\n树莓派3B（Raspberry 3B）;\n一张16G的TF存储卡；\n一台电脑（windowns or mac）；\n若干小米设备（小米网关、小米插座、小米吸顶灯等）；\nTF卡读卡器；\n原生 Raspbian 系统；\nxshell工具；\nSDFormatter；\nWin32 Disk Imager。\nEtcher Mac版（MacOs下烧录工具）；\nFing工具（Android端或者ios端都行）。\n\n二、系统安装\n\nSDFormatter格式化TF存储卡\n使用Win32 Disk Imager工具烧录Raspbian系统到TF卡\n如果是在MacOs系统下，请用mac自带工具格式化TF卡，然后使用Etcher烧录系统；\n\n三、树莓派配置\n\n烧录完毕后，TF卡自动命名为boot，在boot根目录新建ssh文件以便ss登录；\n\n在TF卡根目录新建wpa_supplicant.conf文件，用于连接WiFi，配置如下：\n \ncountry=CN\nctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\nnetwork={\n    ssid=\"路由器的ssid\"\n    psk=\"路由器的密码\"\n    key_mgmt=WPA-PSK\n    priority=1\n}\n\n\n\n将TF卡插在树莓派后上电启动；\n\n使用Fing查询树莓派的IP地址；\n\n树莓派默认用户名pi，密码raspberry;\n\n使用xshell连接树莓派，MacOs方式：ssh pi@192.168.x.x -p 22；\n\n\n3.1 启用root用户（由于本人天性爱自由，所以必须要绝对权限）\n设置root用户密码\n\n\n\n\n\n\n\n\n\n\nsudo passwd root\n\npi@raspberrypi:~$ sudo passwd root\nEnter new UNIX password:   #输入第一遍密码\nRetype new UNIX password:  #输入第二遍密码\n\n启用 root 账号登录\n\n\n\n\n\n\n\n\nsudo passwd –unlock root\n\n\n\npi@raspberrypi:~$ sudo passwd --unlock root\npasswd: password expiry information changed.\n\n设置root登陆\n\n\n\n\n\n\n\n\n\n\nsudo nano /etc/ssh/sshd_config  \n\npi@raspberrypi:~$ sudo nano /etc/ssh/sshd_config    \n\n\n\n\n\n\n\n\n\n\nCtrl + W 快捷键 搜索 PermitRootLogin without-password修改 PermitRootLogin without-password 为 PermitRootLogin yes执行完之后，用 reboot 命令重启，这样就可以解锁root账户。\n四、HomeAssistant安装\n4.1 源替换由于默认都是从国外服务器下载安装，为了避免安装失败所以先替换成阿里的源。\n\n在此目录新建此文件： ~/.pip/pip.conf\n\n复制粘贴以下内容并保存：\n\n\n\n[global]\ntrusted-host=mirrors.aliyun.com\nindex-url=https://mirrors.aliyun.com/pypi/simple/\n\n\n\n4.2 安装Python3打开Linux系统命令行窗口，输入：sudo apt-get install python3.5\n应系统要求输入root账号的密码。\n\n\n安装资源准备好后提问是否继续安装，打回车确认。然后等待安装完成。\n\n\n\n4.3 安装Python3开发资源在第一步安装完成后，继续输入命令：sudo apt-get install python3.5-dev在系统提问是否继续安装时打回车确认。然后等待安装完成。\n\n\n\n\n\n4.4 安装Pip3继续在命令行中输入：sudo apt install python3-pip回车确认安装。等待安装完成。\n\n\n\n4.5 验证安装结果在命令行中输入python3 --version，看到显示版本。在命令行中输入pip3 --version，看到显示版本。说明Python3环境及Pip3工具安装成功。\n\n\n\n4.6 使用Pip工具安装Home Assistant在此步之前建议设置国内的安装源，可以提升后续的速度，参见这篇文档。打开命令行窗口，输入：sudo pip3 install homeassistant （此步骤若失败，请重复操作）等待安装过程完成。\n\n\n\n4.7 验证安装结果在命令行窗口，输入：hass --debug 参数--debug可以查看启动的日志。首次启动需要初始化配置文件，也会自动下载一些所需的文件，会需要一些时间。有时因网络质量问题还会出现文件下载失败情况，导致启动过程受阻。此时可以关闭命令行窗口，再重新执行启动命令。\n\n\n继续等待启动过程完成，直到浏览器自动打开Home Assistant系统首页，即表明软件安装成功。\n\n\n\n五、HomeAssistant设置自动启动\nHome Assistant 针对树莓派的发行版（手动安装除外）中都已经自带自启任务，其余系统安装的用户需要自行配置自启。\n5.1 配置自启动文件如果你未使用 Python 虚拟环境安装 Home Assistant，请使用以下方法\nsudo nano -w /etc/systemd/system/home-assistant@root.service\n\n复制粘贴\n[Unit]\nDescription=Home Assistant\nAfter=network-online.target\n\n[Service]\nType=simple\nUser=%i\nExecStart=/usr/local/bin/hass \n\n[Install]\nWantedBy=multi-user.target\n\n\n\n\n\n\n\n\n\n\n注意ExecStart=/usr/local/bin/hass  这个路径使用whereis hass查看路径\n5.2 启动自启服务完成上述步骤后，请重新加载进程管理。\nsudo systemctl --system daemon-reload\n\n启用服务：\nsudo systemctl enable home-assistant@root\n\n六、HomeAssistant的一些常用命令\n6.1 systemd相关的控制命令sudo systemctl --system daemon-reload：重新加载systemd的配置文件。\nsudo systemctl enable home-assistant@root：设置home-assitant服务为自启动。\nsudo systemctl disable home-assistant@root：从自启动中去除home-assitant服务。\nsudo systemctl start home-assistant@root：手工启动home-assitant服务（命令中start可以替换成stop、restart、status，完成停止、重启、查看服务状态等功能）。\nsudo journalctl -f -u home-assistant@root：查看hass的日志输出。\nsudo journalctl -f -u home-assistant@[your user] | grep -i 'error'：查看hass的日志输出中的error部分\n\nsudo systemctl restart home-assistant@root\n\n6.2 使用脚本控制HomeAssistant#!/bin/bash\n\nfunction check()\n{\n    echo \"检查配置文件是否有错误\"\n    sudo hass --script check_config\n}\n\nfunction dis()\n{\n    echo \"显示所有组件的配置信息\"\n    sudo hass --script check_config --info all\n}\n\nfunction hass()\n{\n    echo \"启动hass\"\n    sudo systemctl start home-assistant@root\n}\nfunction rehass()\n{\n    echo \"重启hass\"\n    sudo systemctl restart home-assistant@root\n}\n\nfunction stophass()\n{\n    echo \"停止hass\"\n    sudo systemctl stop home-assistant@root\n}\n\nfunction log(){\n    echo \"查看hass日志\"\n    sudo journalctl -f -u home-assistant@root\n}\n\nfunction debug(){\n    echo \"debug hass\"\n    sudo hass --debug\n}\n\n\n\necho \"输入编号选择\"\necho \"1. 检查配置文件是否有错误\"\necho \"2. 显示所有组件的配置信息\"\necho \"3. 启动hass\"\necho \"4. 查看hass日志\"\necho \"5. 重启hass\"\necho \"6. 停止hass\"\necho \"7. debug hass\"\necho \"******Enter nothing to exit*****\"\nread num\n\ncase \"$num\" in\n[1] ) (check);;\n[2] ) (dis);;\n[3] ) (hass);;\n[4] ) (log);;\n[5] ) (rehass);;\n[6] ) (stophass);;\n[7] ) (debug);;\n*) echo \"nothing,exit\";;\nesac\n\n七、小米设备接入\n\n安装米家App（最新版本获取获取不到Token，使用【MI Home5.0.19】此版本OK）;\n\n使用RE文件管理器，打开/data/data/com.xiaomi.smarthome/databases/miio2.db\n\n记录设备的token\n\nconfiguration.yaml配置文件\n\n\n八、遇到的一些问题\n\nurllib3与chardet不兼容解决方案\n\n\npip3 uninstall urllib3\npip3 uninstall  chardet\nip3 install requests\n\n\n\n2.执行sh ./xxx.sh出现：“Syntax error: “(” unexpected”的解决方法\nsudo dpkg-reconfigure dash\n在选择项中选No，搞定了！\n\n\nnodejs安装\n\nhttps://blog.csdn.net/xiongtm/article/details/77620005https://nodejs.org/dist/latest-v9.x/\n","slug":"homeassistant","date":"2018-05-02T04:14:57.000Z","categories_index":"IoT","tags_index":"IoT,HomeAssistant","author_index":"uuxia"},{"id":"7467bff88247b93566ab0f6f498d8860","title":"Centos后台运行jar","content":"jar后台运行\n\njar后台运行nohup java -jar xx.jar &gt;/dev/null  &amp;\n\n\n\n\n\n\n\n\n\n\n此处的“&gt;/dev/null”作用是将终端输出信息输出到空洞中，即不保存输出信息，若要查看输出信息需指定输出到那个文件，例如“&gt;/xxx/yyy.out”\n关闭后台进程先查看后台进程pid\nps -aux\n\n记住进程pid，然后kill命令关闭\nkill [pid]\n\n","slug":"centos_run_jar","date":"2018-04-05T08:24:57.000Z","categories_index":"Centos","tags_index":"Java,Jar","author_index":"uuxia"},{"id":"22ee961dbfdc7d3a305ce1df746a4a3b","title":"业余时间做什么，决定了你的生活品质","content":"业余时间做什么，决定了你的生活品质\n\n\n\n摄影看到朋友晓川发布的一条动态，配的图特别有意思，以为他去哪里旅行了。\n一问才知道，他拍的地方其实只是这座城市一条不起眼的街道。\n不由感叹，自己怎么就从来没有发现，这条街道还有这样美的一面。\n这或许得益于晓川的摄影素养，他总能从日常生活中，发现不平凡的景致，捕捉稍纵即逝的瞬间。\n晓川说，一次偶然，他在某摄影论坛看到了一位摄影师的作品，内心深受触动。\n从那以后，从入手第一部相机，到埋头理论书籍，再到拍下自己的第一万零一张照片，他在摄影的道路上一去不复返。\n他用镜头记录岁月的流逝，也用这种方式感受生活的诗意和从容。\n看晓川相册里的光影世界，无论是花叶建筑，还是人间世故，都能感受到他内心的丰富和细腻。\n对摄影爱好的坚持，也让他的生活变得充实丰盈起来。\n其实，摄影也好，绘画也好，拥有一些爱好，可以体验不一样的生活方式，不断探索生命的广度和深度。\n王小波说，拥有自己的爱好，丰富的内心，再普通的日子也能过出妙趣横生，锦上添花般的诗意。\n一个人只注重眼前是不够的，他还应该在生活常态之外，追求更诗意有趣的世界。\n而爱好就是你表达自我的最好途径。\n\n\n美食周末和几个朋友去赏桃花，时近正午，正有些饿了，小美拿出她亲手制作的提拉米苏蛋糕。\n席地而坐后，小美还摘了一束粉紫色的野花，用养乐多瓶子插着，顿时感觉增色不少。\n小美工作需要三班倒，平时非常忙。但无论如何，她都没有放弃对美食的追求。\n休息时，她喜欢变着花样尝试制作不同的美食。\n无论是精致的甜点，还是营养的羹汤，或者是可口的料理，她的手艺总能令人惊艳不已。\n记得上次一个朋友过生日，小美为她制作了一个蛋糕，裱上了对方喜欢的花样。对方上传朋友圈后，获赞无数。\n小美对美食的追求到了极致，有时为了买到最新鲜的食材，她会早起到市场采购。常常一顿饭菜下来，要花去不少时间精力。\n但小美一点都没感觉到累，反而觉得这是一种调剂和享受。\n当你专心去烹饪美食，并享受其中时，会感觉身边的一切都变得美好起来，仿佛世界都静止了。\n吃和思考，都是生命的必需品。\n作家朱利安·巴吉尼说，好好吃，就是好好生活。\n如果人明白美食真正的价值和本质，就会关注美食带来的生活状态。\n美食也有很好的治愈功能，一个人有吃的念头，就有活的欲望。\n喜欢美食的人，也通常能把生活过得热气腾腾。\n因为他内心怀着对生活的热爱，一餐一饭，都讲究精致。\n他会明白，什么才是生活的真实。\n\n\n运动前段时间，表弟状态有些低迷，整日萎靡不振。\n在别人的建议下，他开始跑步。\n慢慢坚持下来后，他对待事物的态度开始变得积极，也喜欢上了这个运动。\n表弟说，跑步时，我可以不受外界打扰，静下心来思考，反省自己。\n有研究表明，人在快乐的时候，大脑会分泌一种叫做内啡肽的物质，而运动会加速这种物质的分泌。\n一个坚持运动健身的人，往往也能做到自律、自爱，不会被欲望和情绪左右。\n而以有益身心的运动消磨空闲时间的人，生活品质也不会太差。\n\n\n\n周国平曾说，排遣的方式，最能见出一个人的性情。\n有个朋友，闲暇时光喜欢尝试不同的东西：\n比如背古诗文，觉得可以让自己内心沉静；\n看各种纪录片，觉得这是了解世界最直观的方式；\n还尝试学些入门的乐器，认为音乐给生活带来美好。\n培养一些爱好，其实就是学会与自己相处，让一个人的生活变得有声有色。\n或许有人认为，这些都是一些无用之事，谈不上兴趣爱好。\n其实不然，有味之事，往往无用，并不是所有的爱好都要有用。\n哪怕只是定期扔东西，整理房间，也是一种爱好。收拾房间能让心情变好，帮助你认识到什么才是想要的和值得追求的。\n\n\n\n\n\n\n\n\n\n正如梁文道所说：读一些无用的书，做一些无用的事，花一些无用的时间，都是为了在一切已知之外，保留一个超越自己的机会，人生中一些很了不起的变化，就是来自这种时刻。\n人生在世，总要找到一些专属于你的东西，才能让自己区别于其他人。\n如果没有兴趣爱好，就仅仅只是活着而已。\n\n\n古人云那些爱好广泛的人，其实是对这个世界保持好奇心。\n精读君在终身成长词典《63：好奇》里提到：一个有好奇心的人，会思考云彩的形成与变换，会着迷于花蕾的初绽，觉察数学法则逻辑上的简洁性。\n他会积极尝试不同事物，学习每一样新东西。\n他会懂得欣赏一花一叶的美，也愿意尝试无用之事。\n\n\n\n\n\n\n\n\n\n古人云，不为无益之事，何以遣有涯之生？\n你的爱好，就是你庸常生活的寄托，决定你的生活品质。\n","slug":"hobby","date":"2018-04-04T02:24:57.000Z","categories_index":"生活","tags_index":"hobby,生活","author_index":"uuxia"},{"id":"730e3c222d29ca9fe69371da7aa3f4fa","title":"L2TP/IPSec一键安装脚本","content":"基于 OpenVZ 虚拟化技术的 VPS 需要开启TUN/TAP才能正常使用，购买 VPS 时请先咨询服务商是否支持开启 TUN/TAP。\nOpenVZ 虚拟的 VPS 需要系统内核支持 IPSec 才行。也就是说，母服务器的内核如果不支持的话那就没办法，只能换 VPS。因此，一般不建议在 OpenVZ 的 VPS 上安装本脚本。脚本如果检测到该 VPS 为 OpenVZ 架构，会出现警告提醒。\n如何检测是否支持TUN模块？执行命令：cat /dev/net/tun如果返回信息为：cat: /dev/net/tun: File descriptor in bad state 说明正常\n如何检测是否支持ppp模块？执行命令：cat /dev/ppp如果返回信息为：cat: /dev/ppp: No such device or address 说明正常当然，脚本在安装时也会执行检查，如果不适用于安装，脚本会予以提示。\n\n本脚本适用环境：系统支持：CentOS6+，Debian7+，Ubuntu12+内存要求：≥128M更新日期：2017 年 05 月 28 日\n关于本脚本：名词解释如下L2TP（Layer 2 Tunneling Protocol）IPSec（Internet Protocol Security）IKEv2 (Internet Key Exchange v2)能实现 IPsec 的目前总体上有 openswan，libreswan，strongswan 这3种。libreswan 是基于 openswan 的 fork，所以现在各个发行版基本已经看不到 openswan 的身影了。当然也有使用 strongswan 的。\n之所以要更新 L2TP 一键安装脚本，是因为随着各个 Linux 发行版不断推陈出新，原有的脚本已经不适应现在的需求。本脚本通过编译安装最新版 libreswan 来实现 IPSec（CentOS7 下则是全部 yum 安装），yum 或 apt-get 来安装 xl2tpd，再根据各个发行版的使用方法不同，部署防火墙规则。\n1. 使用方法：root 用户登录后，运行以下命令：\nwget --no-check-certificate https://raw.githubusercontent.com/teddysun/across/master/l2tp.sh\nchmod +x l2tp.sh\n./l2tp.sh\n\n\n执行后，会有如下交互界面\n\n\n\nPlease input IP-Range:(Default Range: 192.168.18):输入本地IP段范围（本地电脑连接到VPS后给分配的一个本地IP地址），直接回车意味着输入默认值192.168.18\nPlease input PSK:(Default PSK: teddysun.com):PSK意为预共享密钥，即指定一个密钥将来在连接时需要用到，直接回车意味着输入默认值teddysun.com\nPlease input Username:(Default Username: teddysun):Username意为用户名，即第一个默认用户。直接回车意味着输入默认值teddysun\nPlease input teddysun’s password:(Default Password: Q4SKhu2EXQ):输入用户的密码，默认会随机生成一个10位包含大小写字母和数字的密码，当然你也可以指定密码。\nServerIP:your_server_main_IP显示你的 VPS 的主 IP（如果是多 IP 的 VPS 也只显示一个）\nServer Local IP:192.168.18.1显示你的 VPS 的本地 IP（默认即可）\nClient Remote IP Range:192.168.18.2-192.168.18.254显示 IP 段范围\nPSK:teddysun.com显示 PSK\nPress any key to start…or Press Ctrl+c to cancel按下任意按键继续，如果想取消安装，请按Ctrl+c键\n安装完成后，脚本会执行 ipsec verify 命令并提示如下：\nIf there are no [FAILED] above, then you can connect to your\nL2TP VPN Server with the default Username/Password is below:\n\nServerIP:your_server_IP\nPSK:your PSK\nUsername:your usename\nPassword:your password\n\nIf you want to modify user settings, please use command(s):\nl2tp -a (Add a user)\nl2tp -d (Delete a user)\nl2tp -l (List all users)\nl2tp -m (Modify a user password)\nWelcome to visit https://teddysun.com/448.html\nEnjoy it!\n\n\n如果你要想对用户进行操作，可以使用如下命令：l2tp -a 新增用户l2tp -d 删除用户l2tp -m 修改现有的用户的密码l2tp -l 列出所有用户名和密码l2tp -h 列出帮助信息\n2. 注意事项：1、错误809：解决：路由线路上有防火墙没有关闭（pptp穿透防火墙的能力较差）2、错误代码619解决：\nrm -r /dev/ppp\nmknod /dev/ppp c 108 0 \n然后重启VPS即可。\n如果还未解决，尝试重启机器。\n3、要根据ppp的版本来选择对应的pptpd版本。ppp-2.4.4  对应   pptpd-1.3.4ppp-2.4.5  对应   pptpd-1.4.0\n3. 其他事项：1、脚本在安装完成后，已自动启动进程，并加入了开机自启动。2、脚本会改写 iptables 或 firewalld 的规则。3、脚本安装时，会即时将安装日志写到 /root/l2tp.log 文件里，如果你安装失败，可以通过此文件来寻找错误信息。\n4. 使用命令：ipsec status （查看 IPSec 运行状态）ipsec verify （查看 IPSec 检查结果）/etc/init.d/ipsec start|stop|restart|status （CentOS6 下使用）/etc/init.d/xl2tpd start|stop|restart （CentOS6 下使用）systemctl start|stop|restart|status ipsec （CentOS7 下使用）systemctl start|stop|restart xl2tpd （CentOS7 下使用）service ipsec start|stop|restart|status （Debian/Ubuntu 下使用）service xl2tpd start|stop|restart （Debian/Ubuntu 下使用）\n5. 更新日志2017 年 05 月 28 日：升级 libreswan 到版本 3.20。修正 libreswan 的若干配置问题。修正 xl2tpd 的端口监听配置问题。修正在 CentOS 6 对 libevent2 的依赖问题，改为 yum 安装 libevent2-devel。测试表明，在内网环境的 VPS 里（如AWS， IDCF，GCE，腾讯云，阿里云等）也可以正常使用了。\n2017 年 02 月 25 日：升级 libreswan 到版本 3.19。\n2016 年 09 月 12 日：修正了在 CentOS 6 下 libevent2 依赖的问题；新增了一个 -m 选项，用以修改现有用户的密码。\n2016 年 08 月 13 日：修正 Debian 8 下的 sd-daemon.h: No such file or directory 问题，是由于缺少依赖包 libsystemd-daemon-dev 导致的。\n2016 年 08 月 05 日：升级 libreswan 到版本 3.18。\n2016 年 06 月 10 日：脚本在安装完成后，新增了几个命令，便于操作用户l2tp -a 新增用户l2tp -d 删除用户l2tp -l 列出所有用户l2tp -h 列出帮助信息\n参考链接：https://libreswan.org/wiki/3.14_on_Debian_Wheezyhttps://github.com/libreswan/libreswan\n","slug":"L2TP-IPSec_sh","date":"2018-04-02T03:04:50.000Z","categories_index":"VPN","tags_index":"shadowsocks,科学上网","author_index":"uuxia"},{"id":"8213f481efc903643779a1a7fd956892","title":"Android导入第三方静态库.a编译成动态库.so","content":"Android导入第三方静态库.a编译成动态库.so\n\n\n\n下面我以一个简单的实际例子来讲解如何在动态库中导入静态库。\n静态库中的源代码有两个文件：static.h, static.c，有一个add方法 static.h\n#include &lt;stdio.h&gt; \nint add(int x, int y);\nstatic.c\n#include \"static.h\" \nint add(int x, int y) \n{ \n    return x + y; \n}\n\n将它编译成静态库，Android.mk如下：\nLOCAL_PATH := $(call my-dir) \ninclude $(CLEAR_VARS) \nLOCAL_MODULE    := static_add \nLOCAL_SRC_FILES := static.c \ninclude $(BUILD_STATIC_LIBRARY)\n注意编译静态库的时候，必须有一个Application.mk文件：\n\n\n\n\n\n\n\n\n\nAPP_MODULES:=static_add\nAPP_MODULES的值应该和Android.mk中的LOCAL_MODULE的值保持一样。\n然后调用ndk-build进行编译生成libstatic_add.a静态库\nhejinlai_iMac:jni hejinlai$ ndk-build\nPrebuilt : libstatic_add.a &lt;= jni/ 生成静态库后，然后编写动态库中的源代码: share.h share.c share.h [cpp]#include \nint test_add(int x, int y);\n\nshare.c\n1234567 #include “share.h”\n#include “static.h”\nint test_add(int x, int y)\n{\n// 调用static里面的方法\nreturn add(x, y);\n}\n\n编写导入静态库的Android.mk：\nLOCAL_PATH := $(call my-dir) \ninclude $(CLEAR_VARS) \nLOCAL_MODULE    := static_add \nLOCAL_SRC_FILES := libstatic_add.a \ninclude $(PREBUILT_STATIC_LIBRARY) \ninclude $(CLEAR_VARS) \nLOCAL_MODULE    := share_add \nLOCAL_STATIC_LIBRARIES := static_add \nLOCAL_SRC_FILES := share.c \ninclude $(BUILD_SHARED_LIBRARY)\n\n注意上面生成的libstatic_add.a必须跟Android.mk放在同一目录下，否则需要填写相应的路径，然后进行编译：\nhejinlai_iMac:jni hejinlai$ ndk-build\nCompile thumb : share_add &lt;= share.c Prebuilt : libstatic_add.a &lt;= jni/ SharedLibrary : libshare_add.so Install : libshare_add.so =&gt; libs/armeabi/libshare_add.so\n\n提示so编译成功。\n需要注意的是我这边share.c和static.c放在同一目录下，如果放在不同的目录下，需要指定\nLOCAL_C_INCLUDES链接到相应的路径。\n","slug":"android-ndk-so-a","date":"2016-05-11T15:08:51.000Z","categories_index":"Android","tags_index":"Andorid,ndk,so,a","author_index":"uuxia"},{"id":"285ed5b1fb2c878a0e222864d60850e2","title":"喜马拉雅WiFi音响绑定及通讯协议初稿","content":"喜马拉雅WiFi音响绑定及通讯协议初稿\n\n通讯协议\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n1字节\n2字节\n1字节\n1字节\n8字节\n6字节\n4字节\n8字节\n2字节\nN字节\n2字节\n\n\n通讯Json格式：{ \n \"cmd\": 0 ,//命令码\n\"code\": 0,\t//返回码\n\"msg\": \"\",\t//状态消息\n\"data\": ......\t//数据节点\n}\n\n参数说明\n\n\n参数名称\n是否必须\n字段类型\n参数说明\n\n\n\ncmd\nYES\nint\n命令码\n\n\ncode\nNO\nint\n返回码\n\n\nmsg\nNO\nString\n状态消息\n\n\ndata\nNO\nString\n数据节点\n\n\n全局命令码\n\n\n\n\n\n\n\n\n每一种操作对用一个命令码，用作标识指令。\n全局命令码说明如下：\n\n\n命令码（十六进制）\n十进制\n说明\n\n\n\n0x0001\n1\n添加歌曲\n\n\n0x0002\n2\nApp查询歌曲列表\n\n\n0x0003\n3\n升级操作\n\n\n0x0004\n4\n播放\n\n\n0x0005\n5\n关机\n\n\n0x0006\n6\n静音/解除静音\n\n\n0x0007\n7\n音量+\n\n\n0x0008\n8\n音量-\n\n\n0x0009\n9\n切换aux状态\n\n\n0x000a\n10\n下一曲\n\n\n0x000b\n11\n上一曲\n\n\n0x000c\n12\n暂停\n\n\n0x000d\n13\nApp查询播放状态\n\n\n0x000e\n14\nWIFI 无线简易连接\n\n\n0x000f\n15\n设备回复心跳\n\n\n0x400f\n16399\nApp发送心跳\n\n\n0x0011\n17\npalyMode(顺序播放/随机播放/列表循环/单曲循环/)\n\n\n0x0012\n18\n音量设置（直接设置音量值）\n\n\n0x0013\n19\n设备推送播放状态\n\n\n0x0014\n20\n设备推送播放列表\n\n\n0x0015\n21\n拖拽进度条\n\n\n全局返回码\n\n\n\n\n\n\n\n\n每次调用接口时，可能获得正确或错误的返回码，可以根据返回码信息调试接口，排查错误。####全局返回码说明如下：\n\n\n\n0\n请求成功\n\n\n\n200\n无错误\n\n\n400\n不支持此接口\n\n\n401\nJSON数据解析错误\n\n\n示例字符串{ \n\"cmd\": 0x0001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\": \"This is string\"  //数据节点\n}\n\n整形参数{ \n\"cmd\": 0x0001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\": 1  //数据节点\n}\n\n对象{ \n\"cmd\": 0x0001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\":  {\n      \"ssid\":\"TP-link\",  //连接的路由名称\n      \"password\":\"12345678\",  //路由密码,需要加密\n  }  \n}\n\n数组{ \n\"cmd\": 0x001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\":[\n  {\n        \"id\"      ：   \"0\"\n        \"name\" ： “xxxx\",\n        \"artist\" ： “xxxx\",\n        \"album_title\"： “xxxx\",\n        \"cover_url_small”：“xxxx\",\n        \"cover_url_middle\":\"xxxx\",\n        \"cover_url_large\":\"xxxx\",\n        \"url\":\"xxxxxxxxx\"  {详细规格见规格说明url部分},\n  },\n  {\n        \"id\":\"1\"\n        \"name\":\"xxxx1\",\n        \"artist\":\"xxxx1\",\n        \"album\":\"xxxx1\",\n        \"cover_url_small\":\"xxxx\",\n        \"cover_url_middle\":\"xxxx\",\n        \"cover_url_large\":\"xxxx\",\n        \"url\":\"xxxxxxxxxx\"{详细规格见规格说明url部分},\n  }\n   ]\n}\n\n指令说明一、设备基础指令\nApp扫描设备\n\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\n0022\n40\n01\n0000000000000000\n000000000000\n20000000\n0000000000000000\n0405\ndata\n381a\n\n\n\n命令字：0x0405\ndata区：NULL\n\n\n设备回复自身信息\n\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n00000199001b0300\nd8f710e019b0\n00000000\n0000000000000000\n0305\ndata\nxxxx\n\n\n\n命令字：0x0305\n厂商ID：0x0199 \n大分类：0x1b  \n小分类：0x03\n\n\nApp发送心跳包\n\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n20000000\n0000000000000000\n0104\ndata\nxxxx\n\n\n\n命令字：0x0104\ndata区：json\n\n示例：\n    { \n     \"cmd\": 0x400f ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\": ......\t//数据节点\n    }\n\n\n设备回复心跳\n\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0204\ndata\nxxxx\n\n\n\n 命令字：0x0204 \n data区：json\n\n示例：\n    { \n     \"cmd\": 0x000f ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\":  {\n              \"deviceId\": \"SPK设备序列号\"\n          }  \n    }\n\n二、App主动控制终端指令1.App控制终端\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0104\ndata\nxxxx\n\n\n\n 命令字：0x0104 \n data区：json数据\n\n示例：\n    { \n     \"cmd\": 0x00xx ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\": ......\t//数据节点\n    }\n\n2.终端回复App\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0204\ndata\nxxxx\n\n\n\n 命令字：0x0204 \n data区：json数据\n\n示例：\n    { \n     \"cmd\": 0x00xx ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\": ......\t//数据节点\n    }\n\n三、终端主动发送控制数据给App1.周期上传运行数据\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0105\ndata\nxxxx\n\n\n\n 命令字：0x0105 \n data区：json数据\n\n示例：\n{ \n\t     \"cmd\": 0x0013 ,//命令码\n\t\t\"code\": 0,\t//返回码\n\t\t\"msg\": \"\",\t//状态消息\n\t\t\"data\": ......\t//数据节点\n}\n\n\n\n\n音箱数据模型一、歌单参数说明\n\n\n\n参数名称\n是否必须\n字段类型\n参数说明\n\n\n\nid\n是\nint\n歌曲ID\n\n\nname\n否\nstring\n演唱者\n\n\nartist\n否\nString\n艺术家\n\n\nalbum_title\n否\nString\n专辑标题\n\n\nlrc_id\n否\nString\n歌词ID\n\n\nimage_url_small\n否\nString\n歌曲海报1\n\n\nimage_url_middle\n否\nString\n歌曲海报2\n\n\nimage_url_large\n否\nString\n歌曲海报3\n\n\nmac\n否\nString\nMac地址\n\n\ntotal_time\n否\nint\n歌曲时长\n\n\nalbum_id\n否\nint\n专辑ID\n\n\nutype\n否\nint\n比如 虾米音乐 考虑 喜马拉雅 之类的\n\n\nuri\n是\nint\n歌曲URL\n\n\ndownloadurl\n是\nString\n下载url\n\n\n二、播放状态参数说明\n\n\n\n参数名称\n是否必须\n字段类型\n参数说明\n\n\n\nid\t是\nint\n歌曲ID\n\n\n\nmtype\n是\nString\n虾米，百度云盘，本地音乐…\n\n\np_status\n否\nint\n“0/1/2/3/4”, //准备播放，播放,暂停,停止,播放结束(用于网络收音机)\n\n\ntype\n否\nString\n当前播放源(预设preset),收藏,实时推送\n\n\nname\n否\nstring\n演唱者\n\n\nartist\n否\nString\n艺术家\n\n\nalbum\n否\nString\n专辑\n\n\nnext_id\n是\nint\n下一首歌曲id\n\n\ntotal_time\n是\nint\n歌曲总时间\n\n\ncurrent_time\n是\nint\n歌曲当前播放时间\n\n\nplay_mode\n否\nint\n模式（//顺序播放/随机播放列表循环/单曲循环/）\n\n\nvolume\n是\nint\n音量\n\n\n绑定流程\ntitle: 喜马拉雅WiFi音响绑定及通讯协议初稿date: 2016-05-11 22:54:48tags: [智能家居,喜马拉雅,Andorid]categories:- [IoT]喜马拉雅WiFi音响绑定及通讯协议初稿\n\n通讯协议|0x5A|数据长度|框架版本|协议类型|设备编码|Mac地址|数据帧序列号|保留字|数据类型|数据内容|检验码FCS||—-|:—-:||1字节|2字节|1字节|1字节|8字节|6字节|4字节|8字节|2字节|N字节|2字节|\n通讯Json格式：{ \n \"cmd\": 0 ,//命令码\n\"code\": 0,\t//返回码\n\"msg\": \"\",\t//状态消息\n\"data\": ......\t//数据节点\n}\n\n参数说明\n\n\n参数名称\n是否必须\n字段类型\n参数说明\n\n\n\ncmd\nYES\nint\n命令码\n\n\ncode\nNO\nint\n返回码\n\n\nmsg\nNO\nString\n状态消息\n\n\ndata\nNO\nString\n数据节点\n\n\n全局命令码\n\n\n\n\n\n\n\n\n每一种操作对用一个命令码，用作标识指令。\n全局命令码说明如下：\n\n\n命令码（十六进制)\n十进制\n说明\n\n\n\n0x0001\n1\n添加歌曲\n\n\n0x0002\n2\nApp查询歌曲列表\n\n\n0x0003\n3\n升级操作\n\n\n0x0004\n4\n播放\n\n\n0x0005\n5\n关机\n\n\n0x0006\n6\n静音/解除静音\n\n\n0x0007\n7\n音量+\n\n\n0x0008\n8\n音量-\n\n\n0x0009\n9\n切换aux状态\n\n\n0x000a\n10\n下一曲\n\n\n0x000b\n11\n上一曲\n\n\n0x000c\n12\n暂停\n\n\n0x000d\n13\nApp查询播放状态\n\n\n0x000e\n14\nWIFI 无线简易连接\n\n\n0x000f\n15\n设备回复心跳\n\n\n0x400f\n16399\nApp发送心跳\n\n\n0x0011\n17\npalyMode(顺序播放/随机播放/列表循环/单曲循环/)\n\n\n0x0012\n18\n音量设置（直接设置音量值）\n\n\n0x0013\n19\n设备推送播放状态\n\n\n0x0014\n20\n设备推送播放列表\n\n\n0x0015\n21\n拖拽进度条\n\n\n全局返回码\n\n\n\n\n\n\n\n\n每次调用接口时，可能获得正确或错误的返回码，可以根据返回码信息调试接口，排查错误。####全局返回码说明如下：\n\n\n\n0\n请求成功\n\n\n\n200\n无错误\n\n\n400\n不支持此接口\n\n\n401\nJSON数据解析错误\n\n\n示例字符串{ \n\"cmd\": 0x0001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\": \"This is string\"  //数据节点\n}\n\n整形参数{ \n\"cmd\": 0x0001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\": 1  //数据节点\n}\n\n对象{ \n\"cmd\": 0x0001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\":  {\n      \"ssid\":\"TP-link\",  //连接的路由名称\n      \"password\":\"12345678\",  //路由密码,需要加密\n  }  \n}\n\n数组{ \n\"cmd\": 0x001 ,//命令码\n\"code\": 0,  //返回码\n\"msg\": \"\",  //状态消息\n\"data\":[\n  {\n        \"id\"      ：   \"0\"\n        \"name\" ： “xxxx\",\n        \"artist\" ： “xxxx\",\n        \"album_title\"： “xxxx\",\n        \"cover_url_small”：“xxxx\",\n        \"cover_url_middle\":\"xxxx\",\n        \"cover_url_large\":\"xxxx\",\n        \"url\":\"xxxxxxxxx\"  {详细规格见规格说明url部分},\n  },\n  {\n        \"id\":\"1\"\n        \"name\":\"xxxx1\",\n        \"artist\":\"xxxx1\",\n        \"album\":\"xxxx1\",\n        \"cover_url_small\":\"xxxx\",\n        \"cover_url_middle\":\"xxxx\",\n        \"cover_url_large\":\"xxxx\",\n        \"url\":\"xxxxxxxxxx\"{详细规格见规格说明url部分},\n  }\n   ]\n}\n\n指令说明一、设备基础指令\nApp扫描设备\n\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\n0022\n40\n01\n0000000000000000\n000000000000\n20000000\n0000000000000000\n0405\ndata\n381a\n\n\n\n命令字：0x0405\ndata区：NULL\n\n\n设备回复自身信息\n\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n00000199001b0300\nd8f710e019b0\n00000000\n0000000000000000\n0305\ndata\nxxxx\n\n\n\n命令字：0x0305\n厂商ID：0x0199 \n大分类：0x1b  \n小分类：0x03\n\n\nApp发送心跳包\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n20000000\n0000000000000000\n0104\ndata\nxxxx\n\n\n\n\n\n命令字：0x0104\ndata区：json\n\n示例：\n    { \n     \"cmd\": 0x400f ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\": ......\t//数据节点\n    }\n\n\n设备回复心跳\n\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0204\ndata\nxxxx\n\n\n\n 命令字：0x0204 \n data区：json\n\n示例：\n    { \n     \"cmd\": 0x000f ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\":  {\n              \"deviceId\": \"SPK设备序列号\"\n          }  \n    }\n\n二、App主动控制终端指令1.App控制终端\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0104\ndata\nxxxx\n\n\n\n 命令字：0x0104 \n data区：json数据\n\n示例：\n    { \n     \"cmd\": 0x00xx ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\": ......\t//数据节点\n    }\n\n2.终端回复App\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0204\ndata\nxxxx\n\n\n\n 命令字：0x0204 \n data区：json数据\n\n示例：\n    { \n     \"cmd\": 0x00xx ,//命令码\n    \"code\": 0,\t//返回码\n    \"msg\": \"\",\t//状态消息\n    \"data\": ......\t//数据节点\n    }\n\n三、终端主动发送控制数据给App1.周期上传运行数据\n\n\n\n0x5A\n数据长度\n框架版本\n协议类型\n设备编码\nMac地址\n数据帧序列号\n保留字\n数据类型\n数据内容\n检验码FCS\n\n\n\n5A\nxxxx\n40\n01\n0000000000000000\n000000000000\n00000000\n0000000000000000\n0105\ndata\nxxxx\n\n\n\n 命令字：0x0105 \n data区：json数据\n\n示例：\n{ \n\t     \"cmd\": 0x0013 ,//命令码\n\t\t\"code\": 0,\t//返回码\n\t\t\"msg\": \"\",\t//状态消息\n\t\t\"data\": ......\t//数据节点\n}\n\n\n\n\n音箱数据模型一、歌单参数说明\n\n\n\n参数名称\n是否必须\n字段类型\n参数说明\n\n\n\nid\n是\nint\n歌曲ID\n\n\nname\n否\nstring\n演唱者\n\n\nartist\n否\nString\n艺术家\n\n\nalbum_title\n否\nString\n专辑标题\n\n\nlrc_id\n否\nString\n歌词ID\n\n\nimage_url_small\n否\nString\n歌曲海报1\n\n\nimage_url_middle\n否\nString\n歌曲海报2\n\n\nimage_url_large\n否\nString\n歌曲海报3\n\n\nmac\n否\nString\nMac地址\n\n\ntotal_time\n否\nint\n歌曲时长\n\n\nalbum_id\n否\nint\n专辑ID\n\n\nutype\n否\nint\n比如 虾米音乐 考虑 喜马拉雅 之类的\n\n\nuri\n是\nint\n歌曲URL\n\n\ndownloadurl\n是\nString\n下载url\n\n\n二、播放状态参数说明\n\n\n\n参数名称\n是否必须\n字段类型\n参数说明\n\n\n\nid\t是\nint\n歌曲ID\n\n\n\nmtype\n是\nString\n虾米，百度云盘，本地音乐…\n\n\np_status\n否\nint\n“0/1/2/3/4”, //准备播放，播放,暂停,停止,播放结束(用于网络收音机)\n\n\ntype\n否\nString\n当前播放源(预设preset),收藏,实时推送\n\n\nname\n否\nstring\n演唱者\n\n\nartist\n否\nString\n艺术家\n\n\nalbum\n否\nString\n专辑\n\n\nnext_id\n是\nint\n下一首歌曲id\n\n\ntotal_time\n是\nint\n歌曲总时间\n\n\ncurrent_time\n是\nint\n歌曲当前播放时间\n\n\nplay_mode\n否\nint\n模式（//顺序播放/随机播放列表循环/单曲循环/）\n\n\nvolume\n是\nint\n音量\n\n\n绑定流程\n点击看大图\n[原文链接地址]http://blog.csdn.net/xxl6097/article/details/50127949\n[原文链接地址]http://blog.csdn.net/xxl6097/article/details/50127949\n","slug":"ximalaya","date":"2016-05-11T14:54:48.000Z","categories_index":"IoT","tags_index":"Andorid,智能家居,喜马拉雅","author_index":"uuxia"},{"id":"facfeaeeff317a7e3563decfd5c43a5a","title":"绑定界面动资源画动态替换","content":"由于公共模块绑定满足不了TOB项目以及其他项目特殊需求，现对公共模块绑定界面的资源做成可配置，本文介绍一下哪些资源可配置以及如何配置。\n\n颜色配置  颜色的配置需要在res/values，res/values-v14，res/values-v19，res/values-v21等目录下新建  color.xml。  color.xml内容如下：\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;resources&gt;\n    &lt;color name=\"title_bar_bg_color\"&gt;#FFFF4444&lt;/color&gt;\n&lt;/resources&gt;\n\n  目录结构如图1所示\n\n图1\n1.标题颜\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;resources&gt;\n    &lt;color name=\"title_bar_bg_color\"&gt;填入需要配置的颜色值（#FFFF0000）&lt;/color&gt;\n&lt;/resources&gt;\n\n2.子分类列表背景色\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;resources&gt;\n    &lt;color name=\"color_app_themes\"&gt;填入需要配置的颜色值（#FFFF0000）&lt;/color&gt;\n&lt;/resources&gt;\n\n绑定动画配置\n\n\n\n\n\n\n\n\n在主工程res/drawable下分别新建bind_scanning_anim.xml、bind_bouding_anim.xml、bind_failed_anim.xml、bind_sucess_anim.xml资源文件；\n1.“扫描中“动画（bind_scanning_anim.xml），代码如下：\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--\n    根标签为animation-list，其中oneshot代表着是否只展示一遍，设置为false会不停的循环播放动画\n    根标签下，通过item标签对动画中的每一个图片进行声明\n    android:duration 表示展示所用的该图片的时间长度\n    \n --&gt;\n&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:oneshot=\"false\"&gt;\n    &lt;item\n        android:drawable=\"@drawable/scan1\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/scan2\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n&lt;/animation-list&gt;\n\n\n扫描中 使用帧动画，默认配置中两帧，即：scan1.png和scan2.png\n图片分辨率:201x307\n\n2.绑定中 动画（bind_bouding_anim.xml），代码如下:\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--\n    根标签为animation-list，其中oneshot代表着是否只展示一遍，设置为false会不停的循环播放动画\n    根标签下，通过item标签对动画中的每一个图片进行声明\n    android:duration 表示展示所用的该图片的时间长度\n --&gt;\n&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:oneshot=\"false\"&gt;\n    &lt;item\n        android:drawable=\"@drawable/bouding1\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/bouding2\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/bouding3\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/bouding4\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/bouding5\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n&lt;/animation-list&gt;\n\n绑定中 使用帧动画，默认配置使用5帧，即：bouding1.png、bouding2.png、bouding3.png、bouding4.png、bouding5.png\n图片分辨率：392x276\n\n3.失败 动画（bind_failed_anim.xml），代码如下：\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--\n    根标签为animation-list，其中oneshot代表着是否只展示一遍，设置为false会不停的循环播放动画\n    根标签下，通过item标签对动画中的每一个图片进行声明\n    android:duration 表示展示所用的该图片的时间长度\n --&gt;\n&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:oneshot=\"false\"&gt;\n    &lt;item\n        android:drawable=\"@drawable/failed1\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/failed2\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n&lt;/animation-list&gt;\n\n扫描中 使用帧动画，默认配置使用2帧，即：failed1.png和failed2.png\n图片分辨率:203x306\n\n4.成功 动画（bind_sucess_anim.xml），代码如下：\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--\n    根标签为animation-list，其中oneshot代表着是否只展示一遍，设置为false会不停的循环播放动画\n    根标签下，通过item标签对动画中的每一个图片进行声明\n    android:duration 表示展示所用的该图片的时间长度\n --&gt;\n&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:oneshot=\"false\"&gt;\n    &lt;item\n        android:drawable=\"@drawable/sucess1\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/sucess2\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n&lt;/animation-list&gt;\n\n\n扫描中 使用帧动画，默认配置使用2帧，即：sucess1.png和sucess2.png\n图片分辨率:203x306\n\n网络请求loadding图标配置在主工程res/drawable下分别新建bind_network_waiting.xml资源文件。代码如下：\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:oneshot=\"false\"&gt;\n\n    &lt;item\n        android:drawable=\"@drawable/load1\"\n        android:duration=\"200\" /&gt;\n    &lt;item\n        android:drawable=\"@drawable/load2\"\n        android:duration=\"200\" /&gt;\n\n&lt;/animation-list&gt;\n\n网络请求loadding 使用帧动画，默认配置使用2帧，即：load1.png和load2.png\n图片分辨率:126x126\n\n缺省配置如图2：\n\n图2\n下拉列表Header动画配置在主工程res/drawable下分别新建bind_droplistview_anim.xml资源文件。代码如下：\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--\n    根标签为animation-list，其中oneshot代表着是否只展示一遍，设置为false会不停的循环播放动画\n    根标签下，通过item标签对动画中的每一个图片进行声明\n    android:duration 表示展示所用的该图片的时间长度\n --&gt;\n&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:oneshot=\"false\"&gt;\n    &lt;item\n        android:drawable=\"@drawable/list1\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/list2\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/list3\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/list4\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n    &lt;item\n        android:drawable=\"@drawable/list5\"\n        android:duration=\"150\"&gt;&lt;/item&gt;\n&lt;/animation-list&gt;\n\n\n下拉列表Header动画 使用帧动画，默认配置使用5帧，即：list1.png、list2.png、list3.png、list4.png、list5.png\n图片分辨率:72x72\n\n缺省配置如图3：\n\n图3\n","slug":"public-bind","date":"2016-05-10T22:35:25.000Z","categories_index":"IoT","tags_index":"het,智能家居","author_index":"uuxia"},{"id":"6200c77510ad300acf3ce5a135ddab22","title":"CentOS下shadowsocks-libev一键安装脚本","content":"一键安装 libev 版的 shadowsocks 最新版本。该版本的特点是内存占用小（600k左右），低 CPU 消耗，甚至可以安装在基于 OpenWRT 的路由器上。友情提示：如果你有问题，请先参考这篇《Shadowsocks Troubleshooting》后再问。\n\n系统要求系统支持：CentOS 32或64位内存要求：≥128M日期：2015年08月01日\n本脚本适用环境：系统支持：CentOS 32或64位内存要求：≥128M日期：2015年08月01日\n关于本脚本：一键安装 libev 版的 shadowsocks 最新版本。该版本的特点是内存占用小（600k左右），低 CPU 消耗，甚至可以安装在基于 OpenWRT 的路由器上。友情提示：如果你有问题，请先参考这篇《Shadowsocks Troubleshooting》后再问。\n默认配置：服务器端口：自己设定（如不设定，默认为 8989）客户端端口：1080密码：自己设定（如不设定，默认为teddysun.com）\n客户端下载：http://sourceforge.net/projects/shadowsocksgui/files/dist/\n使用方法：使用root用户登录，运行以下命令：\n\n获取安装文件\n\nwget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-libev.sh\n\n\n设置执行权限\n\nchmod +x shadowsocks-libev.sh\n\n\n按照命令\n\n./shadowsocks-libev.sh 2&gt;&amp;1 | tee shadowsocks-libev.log\n安装完成后，脚本提示如下：\nCongratulations, shadowsocks-libev install completed!\nYour Server IP:your_server_ip\nYour Server Port:your_server_port\nYour Password:your_password\nYour Local IP:127.0.0.1\nYour Local Port:1080\nYour Encryption Method:aes-256-cfb\n\nWelcome to visit:https://teddysun.com/357.html\nEnjoy it!\n\n\n安装完成后即已后台启动 shadowsocks ，运行\n\nps -ef | grep ss-server | grep -v ps | grep -v grep\n\n\n使用命令\n\n\n\n\n\n\n\n\n\n\n启动：/etc/init.d/shadowsocks start停止：/etc/init.d/shadowsocks stop重启：/etc/init.d/shadowsocks restart查看状态：/etc/init.d/shadowsocks status\n\n卸载方法\n\n./shadowsocks-libev.sh uninstall\n\n\n更多版本 shadowsocks 安装\n\nShadowsocksR 版一键安装脚本（CentOS，Debian，Ubuntu）Shadowsocks Python 版一键安装脚本（CentOS，Debian，Ubuntu）Debian 下 Shadowsocks-libev 一键安装脚本Shadowsocks-go 一键安装脚本（CentOS，Debian，Ubuntu）\n更新说明（2015 年 08 月 01 日）：1、新增自定义服务器端口功能（如不设定，默认为 8989）；更新说明（2015 年 04 月 30 日）：1、本脚本会始终安装最新版的 Shadowsocks；2、修改配置文件 /etc/shadowsocks-libev/config.json 同时启用 IPv4 与 IPv6 支持：\n{\n    \"server\":[\"[::0]\",\"0.0.0.0\"],\n    \"server_port\":your_server_port,\n    \"local_address\":\"127.0.0.1\",\n    \"local_port\":1080,\n    \"password\":\"your_password\",\n    \"timeout\":600,\n    \"method\":\"aes-256-cfb\"\n}\n3、Shadowsocks libev 版不能通过修改配置文件来多端口（只能开启多进程），如果你需要多端口请安装 Python 或 Go 版；\n特别说明：1、已安装旧版本的 shadowsocks 需要升级的话，需下载本脚本的最新版，运行卸载命令\n\n\n\n\n\n\n\n\n\n./shadowsocks-libev.sh uninstall然后，再次执行本脚本即可安装最新版。\n参考链接：https://github.com/madeye/shadowsocks-libev\n","slug":"installshadowsocks","date":"2016-05-10T21:23:03.000Z","categories_index":"VPN,shadowsocks,centos6","tags_index":"shadowsocks,科学上网,centos6","author_index":"uuxia"},{"id":"bfdf97102f97e6a0faca88b0788acc8b","title":"ios开发笔记","content":"http://www.williamlong.info/archives/4319.html\n\n 证书知识及准备工作\n 几种开发者帐号区别\n 真机调试流程\n 内测发布流程\n Appstore 上架流程\n\n目录导航\n证书知识及准备工作\n基础问题答疑\n什么是证书\n什么时候需要证书\n证书如何获得\n如何对代码进行签名\n我生成的私钥如何共享给团队成员\n\n\n各流程中证书的需求情况\n模拟器调试\n真机调试\n打包和发布\n消息推送后端服务\n\n\n开发中常见的证书及相关文件介绍\nCSR(certificate request) 文件\n开发者证书\napns(Apple Push Notification Service) 证书\np12(Personal Information Exchange) 证书\n描述文件(Provisioning Profiles)\n\n\n附录1: 开发准备相关的网址\n\n\n几种开发者帐号区别\n关键区别\n\n\n真机调试流程\n基本概念\n条件和流程\n\n\n内测发布流程\n基本概念\n实现条件\n几种常见的分发途径\n附录2: 常见分发渠道及工具地址\n\n\nAppstore 上架流程\n附录3: App store最新审核标准(2015.3)\n\n\n\n证书知识及准备工作基础问题答疑什么是证书由 apple 官方颁发, 用以证明开发者身份的特殊文件, 在 iOS 开发中主要用于代码签名, 保障 iOS 生态的健康安全, 分为开发者证书和发布者证书\n什么时候需要证书只有在本机模拟器调试时无需代码签名, 当 App 需要在真机运行和发布时需要使用相应证书进行签名\n证书如何获得首先需要拥有相应权限的开发者帐号, 通过在本地生成配对的密钥, 向 provisioning portal 提交公钥后换取, 后续证书在使用时会验证本地私钥\n如何对代码进行签名在 xcode 中, 使用描述文件(provision profile 包含调试者证书, 授权设备清单, 应用ID), 在 Build Settings 中选择存于 Keychain Access 中的证书文件设置调试和发布任务时的代码签名\n我生成的私钥如何共享给团队成员在 Keychain Access 中找到导入的证书, 右击导出为包含私钥的 Personal Information Exchange(.p12)文件(导出时可以创建密码), 团队成员再导入 p12 证书后就完整包含了证书和私钥\n各流程中证书的需求情况模拟器调试不需要\n真机调试\n描述文件(Provisioning Profiles)\n\n开发者证书(ios_development.cer)\n\n\n打包和发布\n描述文件(Provisioning Profiles)\n\n可用于发布的开发者证书(ios_distribution.cer)\n\n\n消息推送后端服务\napns 证书\n\n开发中常见的证书及相关文件介绍CSR(certificate request) 文件用于换取证书的公钥文件, 实际是在本地基于 RSA 加密得到配对的密钥, 私钥存于 Keychain Access 用于签名, 公钥作为换取证书的凭证\n生成方法\nOSX 系统自带的 Keychain Access\n\n选择 “Request a Certificate From a Certificate Authority…”\n\n输入 email 等信息后保存为 .certSigningRequest 文件\n\n\n\n命令行下使用 openssl 生成\n\n\n$ openssl genrsa -out private.key 2048\n$ openssl req -new -sha256 -key private.key -out my.certSigningRequest\n\n开发者证书由 apple 官方颁发, 用来证明开发者资格的证书文件, 分开发(ios_development.cer)和发布(ios_distribution.cer)两种\ncer 证书跟开发机(私钥)绑定只能在拥有私钥的机器上使用, 如果要迁移机器需要导出为 p12 文件\n生成方法在 开发者中心 “certificates” 面板中添加 certificate 并上传刚刚生成的 CSR 文件, 获取 ios_development.cer\napns(Apple Push Notification Service) 证书用于服务端消息推送, 类似 ssl 证书使用, 和 App 端的开发打包没有关系\n生成方法在 开发者中心 “Identifiers” 面板中添加 App ID 并上传刚刚生成的 CSR 文件, 获取 aps_production.cer\np12(Personal Information Exchange) 证书p12 证书实际是包含了 cer 证书及私钥信息, 可以分发给团队成员\n生成方法在 Keychain Access 中找到已经导入的 cer 证书, 点右键导出为 p12 格式\n描述文件(Provisioning Profiles)包含 certificate appID devices id 的文件用于在 xcode 调试打包时提供授权的配置信息\n生成方法\n在 开发者中心 “Provisioning Profiles” 面板中添加 iOS Provisioning Profiles 并上传刚刚生成的 CSR 文件, 获取 .mobileprovision 文件\n\n在 xcode 登录开发者帐号后可以连接开发者中心获取\n\n\n附录1: 开发准备相关的网址\n\n\n\n\n\n\n\n\n开发者中心https://developer.apple.com/devcenter/ios/index.action\niOS 描述管理(配置证书、描述文件、推送服务)https://developer.apple.com/ios/manage/overview/index.action\n切换团队(在 web 界面上死活没有找到)https://developer.apple.com/account/selectTeam.action\niOS 上架 Appstorehttp://itunesconnect.apple.com/\n几种开发者帐号区别\n\n\n\n\n\n\n\n\n详见: https://developer.apple.com/programs/start/ios/\n\n个人(individual) $99/year\n公司(company) $99/year\n企业(enterprise) $299/year\n大学(University) free\n\n关键区别\n个人帐号可以真机调试, 发布 appstore, 每年 最多为 100台设备分发\n公司帐号和个人帐号类似, 只有这两种帐号可以发布 appstore, 主要特权是可以添加多个开发者子账号, 但只允许主账号提交, 发布等操作, 在协同开发时比较灵活, 可以各自管理授权设备等\n企业帐号无法用于 appstore 发布, 但可以不通过 appstore 发布任意 iphone 都可以安装的应用\n大学帐号不能发布 appstore, 主要拥有真机调试的权限\n\n真机调试流程基本概念真机调试指 mac 连上 iphone, xcode 可以直接以这台 iphone 设备为 build target, 能在 iphone 里执行编译结果\n条件和流程分为拥有独立开发者帐号(也包括公司帐号或企业帐号成员)和共享开发者帐号两种情况\n拥有独立开发者帐号\n\n在 provisioning portal 新建应用, 配置授权设备等\n\n\n\n开发机上导入证书\n\n\n\n在 xcode 上登录开发者帐号, 不需要准备描述文件, xcode 会自动生成(如果是公司帐号可以自动生成 iOS Team Provisioning Profile)\n\n\n\n共享开发者帐号如果无法在 xcode 登录一个开发者帐号, 也可以通过他人对你手机和应用 id 的授权, 得到 .mobileprovision 描述文件再导入其含私钥的证书(p12) 即可, 具体步骤如下:\n\n\n获得手机的 udid (可以连上 mac, 在 itunes 中查看)\n\n\n\n告知对方 udid (用以设备授权) 和 应用 id\n\n\n\n得到对方生成的证书和描述文件后, 先导入 p12 证书, 再双击 mobileprovision 文件\n\n\n\n连接手机, 在 xcode 中选择 build target 为已连接的手机\n\n\n\n\n\n\n\n\n\n\n\n\n对刚入门的个人开发者而言, 可以在淘宝搜 iOS真机调试 花几元购买一份授权, 包含(p12 证书 和 .mobileprovision 描述文件)\n内测发布流程基本概念当 App 开发进行到一定程度, 需要更多的人参与测试, 需要谋求一种方式方便应用能安装进更多的设备中\n实现条件进行内测发布主要的关键点是:\n\n\n是如何将应用打包为 .ipa\n\n\n\nxcode6 以后, 个人/公司帐号无法对应用打包为 .ipa, 要么用 xcode5 打包要么拥有企业帐号级别的授权\n\n\n设备需不需要授权\n\n\n\n个人/公司帐号权限只有在 TestFlight / 越狱渠道下完成不授权安装; 企业帐号授权可以在 ad-hoc / in-house 渠道下分发, 完成不授权设备安装\n几种常见的分发途径\nad-hoc\n\n打包时必须在登录企业帐号(或其成员)并已导入证书和描述文件的情况下, 任何用户(未授权)都可以在手机上用浏览器访问一个 url(例: itms-services://?action=download-manifest&amp;url=https://example.com/manifest.plist) 完成安装\n最大的问题是安装量有 100 的上限, 无法作为一个量很大的分发渠道\n\nin-house\n\n针对企业内部用户进行分发, 相比 ad-hoc 无安装量上限\n\n\n\n\n\n\n\n\n\niOS 8.1.3 开始不能企业证书 Iresign 方式重新签名的应用无法安装https://support.apple.com/en-us/HT204245\n\nTestFlight\n\n仅支持 iOS8.0 以上, 不需要对设备 udid 进行授权, 适合个人 / 公司开发者, 在应用发布前可以开启 TestFlight Beta 测试并添加测试者的 iTunes Connect 帐号, 需要待测用户拥有 iTunes Connect 帐号并在设备安装 TestFlight 客户端\n这种方式非常便于推送应用更新和收集测试信息\n\n导出 ipa 包, 越狱安装\n\n如果测试设备都越狱了, 这种方式非常灵活简单, 只有能导出 ipa 包就能通过 itools 等第三方工具安装\n附录2: 常见分发渠道及工具地址\n\n\n\n\n\n\n\n\nfir-第三方应用托管平台http://fir.im/\nTestFlighthttps://developer.apple.com/testflight/\nAgile-百度内部 ios 分发测试平台http://agile.baidu.com\nfir-分发相关工具http://fir.im/dev/tools\nitoolshttp://www.itools.cn/\nAppstore 上架流程@TODO\n附录3: App store最新审核标准(2015.3)\n\n\n\n\n\n\n\n\nApp store最新审核标准(2015.3) 中文翻译\n\n\n\n\n\n\n\n\n\nApp store最新审核标准(2015.3) 英文原版\n","slug":"iosdev","date":"2016-05-09T19:24:00.000Z","categories_index":"Ios","tags_index":"ios","author_index":"uuxia"},{"id":"cdf15dadb6e83d91b65d1f1963e7aa59","title":"OkHttp使用教程","content":"这是一个针对技术开发者的一个应用，你可以在掘金上获取最新最优质的技术干货，不仅仅是Android知识、前端、后端以至于产品和设计都有涉猎，想成为全栈工程师的朋友不要错过！\n\n入门Android系统提供了两种HTTP通信类，HttpURLConnection和HttpClient。关于HttpURLConnection和HttpClient的选择&gt;&gt;官方博客尽管Google在大部分安卓版本中推荐使用HttpURLConnection，但是这个类相比HttpClient实在是太难用，太弱爆了。OkHttp是一个相对成熟的解决方案，据说Android4.4的源码中可以看到HttpURLConnection已经替换成OkHttp实现了。所以我们更有理由相信OkHttp的强大。\nOkHttp 处理了很多网络疑难杂症：会从很多常用的连接问题中自动恢复。如果您的服务器配置了多个IP地址，当第一个IP连接失败的时候，OkHttp会自动尝试下一个IP。OkHttp还处理了代理服务器问题和SSL握手失败问题。\n使用 OkHttp 无需重写您程序中的网络代码。OkHttp实现了几乎和java.net.HttpURLConnection一样的API。如果你用了 Apache HttpClient，则OkHttp也提供了一个对应的okhttp-apache 模块。\n\n\n\n\n\n\n\n\n\n注：在国内使用OkHttp会因为这个问题导致部分酷派手机用户无法联网，所以对于大众app来说，需要等待这个bug修复后再使用。或者尝试使用OkHttp的老版本。截止到目前，OkHttp一直没有修复，并把修复计划延迟到了OkHttp2.3中。不是所有设备都能重现，仅少量设备会出现这个问题。（如果问题这么明显，OkHttp早就修复了）\n官方资料官方介绍github源码\n使用范围OkHttp支持Android 2.3及其以上版本。对于Java, JDK1.7以上。\njar包准备官方介绍页面有链接位置。这里把下载链接也写在下面。OkHttpOkio\n基本使用HTTP GET\nOkHttpClient client = new OkHttpClient();\n \nString run(String url) throws IOException {\n    Request request = new Request.Builder().url(url).build();\n    Response response = client.newCall(request).execute();    if (response.isSuccessful()) {        return response.body().string();\n    } else {        throw new IOException(\"Unexpected code \" + response);\n    }\n}\nRequest是OkHttp中访问的请求，Builder是辅助类。Response即OkHttp中的响应。Response类：\npublic boolean isSuccessful()\nReturns true if the code is in [200..300),\n which means the request was successfully received, understood, and accepted.\nresponse.body()返回ResponseBody类\npublic final String string() throws IOException\nReturns the response as a string decoded with the charset of the Content-Type header. If that header is either absent or lacks a charset,\n this will attempt to decode the response body as UTF-8.Throws:\nIOException\n当然也能获取到流的形式：\npublic final InputStream byteStream()\nHTTP POSTPOST提交Json数据\npublic static final MediaType JSON = MediaType.parse(\"application/json; charset=utf-8\");\nOkHttpClient client = new OkHttpClient();\nString post(String url, String json) throws IOException {\n     RequestBody body = RequestBody.create(JSON, json);\n      Request request = new Request.Builder()\n      .url(url)\n      .post(body)\n      .build();\n      Response response = client.newCall(request).execute();\n    f (response.isSuccessful()) {\n        return response.body().string();\n    } else {\n        throw new IOException(\"Unexpected code \" + response);\n    }\n}\n使用Request的post方法来提交请求体RequestBody\n** POST提交键值对**很多时候我们会需要通过POST方式把键值对数据传送到服务器。 OkHttp提供了很方便的方式来做这件事情。\nOkHttpClient client = new OkHttpClient();\nString post(String url, String json) throws IOException {\n \n     RequestBody formBody = new FormEncodingBuilder()\n    .add(\"platform\", \"android\")\n    .add(\"name\", \"bug\")\n    .add(\"subject\", \"XXXXXXXXXXXXXXX\")\n    .build();\n \n      Request request = new Request.Builder()\n      .url(url)\n      .post(body)\n      .build();\n \n      Response response = client.newCall(request).execute();\n    if (response.isSuccessful()) {\n        return response.body().string();\n    } else {\n        throw new IOException(\"Unexpected code \" + response);\n    }\n}\n总结通过上面的例子我们可以发现，OkHttp在很多时候使用都是很方便的，而且很多代码也有重复，因此特地整理了下面的工具类。注意：\n\nOkHttp官方文档并不建议我们创建多个OkHttpClient，因此全局使用一个。 如果有需要，可以使用clone方法，再进行自定义。这点在后面的高级教程里会提到。\nenqueue为OkHttp提供的异步方法，入门教程中并没有提到，后面的高级教程里会有解释。\n\nimport java.io.IOException;\nimport java.util.List;\nimport java.util.concurrent.TimeUnit;\nimport org.apache.http.client.utils.URLEncodedUtils;\nimport org.apache.http.message.BasicNameValuePair;\nimport cn.wiz.sdk.constant.WizConstant;\nimport com.squareup.okhttp.Callback;\nimport com.squareup.okhttp.OkHttpClient;\nimport com.squareup.okhttp.Request;\nimport com.squareup.okhttp.Response; \n  \npublic class OkHttpUtil {\n    private static final OkHttpClient mOkHttpClient = new OkHttpClient();\n    static{\n        mOkHttpClient.setConnectTimeout(30, TimeUnit.SECONDS);\n    }\n    /**\n     * 该不会开启异步线程。\n     * @param request\n     * @return\n     * @throws IOException\n     */\n    public static Response execute(Request request) throws IOException{\n        return mOkHttpClient.newCall(request).execute();\n    }\n    /**\n     * 开启异步线程访问网络\n     * @param request\n     * @param responseCallback\n     */\n    public static void enqueue(Request request, Callback responseCallback){\n        mOkHttpClient.newCall(request).enqueue(responseCallback);\n    }\n    /**\n     * 开启异步线程访问网络, 且不在意返回结果（实现空callback）\n     * @param request\n     */\n    public static void enqueue(Request request){\n        mOkHttpClient.newCall(request).enqueue(new Callback() {\n             \n            @Override\n            public void onResponse(Response arg0) throws IOException {\n                 \n            }\n             \n            @Override\n            public void onFailure(Request arg0, IOException arg1) {\n                 \n            }\n        });\n    }\n    public static String getStringFromServer(String url) throws IOException{\n        Request request = new Request.Builder().url(url).build();\n        Response response = execute(request);\n        if (response.isSuccessful()) {\n            String responseUrl = response.body().string();\n            return responseUrl;\n        } else {\n            throw new IOException(\"Unexpected code \" + response);\n        }\n    }\n    private static final String CHARSET_NAME = \"UTF-8\";\n    /**\n     * 这里使用了HttpClinet的API。只是为了方便\n     * @param params\n     * @return\n     */\n    public static String formatParams(List&lt;BasicNameValuePair&gt; params){\n        return URLEncodedUtils.format(params, CHARSET_NAME);\n    }\n    /**\n     * 为HttpGet 的 url 方便的添加多个name value 参数。\n     * @param url\n     * @param params\n     * @return\n     */\n    public static String attachHttpGetParams(String url, List&lt;BasicNameValuePair&gt; params){\n        return url + \"?\" + formatParams(params);\n    }\n    /**\n     * 为HttpGet 的 url 方便的添加1个name value 参数。\n     * @param url\n     * @param name\n     * @param value\n     * @return\n     */\n    public static String attachHttpGetParam(String url, String name, String value){\n        return url + \"?\" + name + \"=\" + value;\n    }\n}\n\n高级高级属性其实用的不多，这里主要是对OkHttp github官方教程进行了翻译。\n同步get下载一个文件，打印他的响应头，以string形式打印响应体。响应体的 string() 方法对于小文档来说十分方便、高效。但是如果响应体太大（超过1MB），应避免适应 string()方法 ，因为他会将把整个文档加载到内存中。对于超过1MB的响应body，应使用流的方式来处理body。\nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://publicobject.com/helloworld.txt\")\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    Headers responseHeaders = response.headers();\n    for (int i = 0; i &lt; responseHeaders.size(); i++) {\n      System.out.println(responseHeaders.name(i) + \": \" + responseHeaders.value(i));\n    }\n \n    System.out.println(response.body().string());\n}\n异步get在一个工作线程中下载文件，当响应可读时回调Callback接口。读取响应时会阻塞当前线程。OkHttp现阶段不提供异步api来接收响应体。\nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://publicobject.com/helloworld.txt\")\n        .build();\n \n    client.newCall(request).enqueue(new Callback() {\n      @Override public void onFailure(Request request, Throwable throwable) {\n        throwable.printStackTrace();\n      }\n \n      @Override public void onResponse(Response response) throws IOException {\n        if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n        Headers responseHeaders = response.headers();\n        for (int i = 0; i &lt; responseHeaders.size(); i++) {\n          System.out.println(responseHeaders.name(i) + \": \" + responseHeaders.value(i));\n        }\n \n        System.out.println(response.body().string());\n      }\n    });\n}\n提取响应头典型的HTTP头 像是一个 Map&lt;String, String&gt; :每个字段都有一个或没有值。但是一些头允许多个值，像Guava的Multimap。例如：HTTP响应里面提供的Vary响应头，就是多值的。OkHttp的api试图让这些情况都适用。当写请求头的时候，使用header(name, value)可以设置唯一的name、value。如果已经有值，旧的将被移除，然后添加新的。使用addHeader(name, value)可以添加多值（添加，不移除已有的）。当读取响应头时，使用header(name)返回最后出现的name、value。通常情况这也是唯一的name、value。如果没有值，那么header(name)将返回null。如果想读取字段对应的所有值，使用headers(name)会返回一个list。为了获取所有的Header，Headers类支持按index访问。\nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/repos/square/okhttp/issues\")\n        .header(\"User-Agent\", \"OkHttp Headers.java\")\n        .addHeader(\"Accept\", \"application/json; q=0.5\")\n        .addHeader(\"Accept\", \"application/vnd.github.v3+json\")\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    System.out.println(\"Server: \" + response.header(\"Server\"));\n    System.out.println(\"Date: \" + response.header(\"Date\"));\n    System.out.println(\"Vary: \" + response.headers(\"Vary\"));\n}\nPost方式提交String使用HTTP POST提交请求到服务。这个例子提交了一个markdown文档到web服务，以HTML方式渲染markdown。因为整个请求体都在内存中，因此避免使用此api提交大文档（大于1MB）。\npublic static final MediaType MEDIA_TYPE_MARKDOWN\n  = MediaType.parse(\"text/x-markdown; charset=utf-8\");\n \nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    String postBody = \"\"\n        + \"Releases\\n\"\n        + \"--------\\n\"\n        + \"\\n\"\n        + \" * _1.0_ May 6, 2013\\n\"\n        + \" * _1.1_ June 15, 2013\\n\"\n        + \" * _1.2_ August 11, 2013\\n\";\n \n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/markdown/raw\")\n        .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, postBody))\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    System.out.println(response.body().string());\n}\nPost方式提交流以流的方式POST提交请求体。请求体的内容由流写入产生。这个例子是流直接写入Okio的BufferedSink。你的程序可能会使用OutputStream，你可以使用BufferedSink.outputStream()来获取。\npublic static final MediaType MEDIA_TYPE_MARKDOWN\n      = MediaType.parse(\"text/x-markdown; charset=utf-8\");\n \nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    RequestBody requestBody = new RequestBody() {\n      @Override public MediaType contentType() {\n        return MEDIA_TYPE_MARKDOWN;\n      }\n \n      @Override public void writeTo(BufferedSink sink) throws IOException {\n        sink.writeUtf8(\"Numbers\\n\");\n        sink.writeUtf8(\"-------\\n\");\n        for (int i = 2; i &lt;= 997; i++) {\n          sink.writeUtf8(String.format(\" * %s = %s\\n\", i, factor(i)));\n        }\n      }\n \n      private String factor(int n) {\n        for (int i = 2; i &lt; n; i++) {\n          int x = n / i;\n          if (x * i == n) return factor(x) + \" × \" + i;\n        }\n        return Integer.toString(n);\n      }\n    };\n \n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/markdown/raw\")\n        .post(requestBody)\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    System.out.println(response.body().string());\n}\nPost方式提交文件以文件作为请求体是十分简单的。\npublic static final MediaType MEDIA_TYPE_MARKDOWN\n  = MediaType.parse(\"text/x-markdown; charset=utf-8\");\n \nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    File file = new File(\"README.md\");\n \n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/markdown/raw\")\n        .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file))\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    System.out.println(response.body().string());\n}\nPost方式提交表单使用FormEncodingBuilder来构建和HTML标签相同效果的请求体。键值对将使用一种HTML兼容形式的URL编码来进行编码。\nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    RequestBody formBody = new FormEncodingBuilder()\n        .add(\"search\", \"Jurassic Park\")\n        .build();\n    Request request = new Request.Builder()\n        .url(\"https://en.wikipedia.org/w/index.php\")\n        .post(formBody)\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    System.out.println(response.body().string());\n}\nPost方式提交分块请求MultipartBuilder可以构建复杂的请求体，与HTML文件上传形式兼容。多块请求体中每块请求都是一个请求体，可以定义自己的请求头。这些请求头可以用来描述这块请求，例如他的Content-Disposition。如果Content-Length和Content-Type可用的话，他们会被自动添加到请求头中。\nprivate static final String IMGUR_CLIENT_ID = \"...\";\nprivate static final MediaType MEDIA_TYPE_PNG = MediaType.parse(\"image/png\");\n \nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    // Use the imgur image upload API as documented at https://api.imgur.com/endpoints/image\n    RequestBody requestBody = new MultipartBuilder()\n        .type(MultipartBuilder.FORM)\n        .addPart(\n            Headers.of(\"Content-Disposition\", \"form-data; name=\\\"title\\\"\"),\n            RequestBody.create(null, \"Square Logo\"))\n        .addPart(\n            Headers.of(\"Content-Disposition\", \"form-data; name=\\\"image\\\"\"),\n            RequestBody.create(MEDIA_TYPE_PNG, new File(\"website/static/logo-square.png\")))\n        .build();\n \n    Request request = new Request.Builder()\n        .header(\"Authorization\", \"Client-ID \" + IMGUR_CLIENT_ID)\n        .url(\"https://api.imgur.com/3/image\")\n        .post(requestBody)\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    System.out.println(response.body().string());\n}\n使用Gson来解析JSON响应Gson是一个在JSON和Java对象之间转换非常方便的api。这里我们用Gson来解析Github API的JSON响应。注意：ResponseBody.charStream()使用响应头Content-Type指定的字符集来解析响应体。默认是UTF-8。\nprivate final OkHttpClient client = new OkHttpClient();\nprivate final Gson gson = new Gson();\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/gists/c2a7c39532239ff261be\")\n        .build();\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    Gist gist = gson.fromJson(response.body().charStream(), Gist.class);\n    for (Map.Entry&lt;String, GistFile&gt; entry : gist.files.entrySet()) {\n      System.out.println(entry.getKey());\n      System.out.println(entry.getValue().content);\n    }\n}\n \nstatic class Gist {\n    Map&lt;String, GistFile&gt; files;\n}\n \nstatic class GistFile {\n    String content;\n}\n响应缓存为了缓存响应，你需要一个你可以读写的缓存目录，和缓存大小的限制。这个缓存目录应该是私有的，不信任的程序应不能读取缓存内容。一个缓存目录同时拥有多个缓存访问是错误的。大多数程序只需要调用一次new OkHttp()，在第一次调用时配置好缓存，然后其他地方只需要调用这个实例就可以了。否则两个缓存示例互相干扰，破坏响应缓存，而且有可能会导致程序崩溃。响应缓存使用HTTP头作为配置。你可以在请求头中添加Cache-Control: max-stale=3600 ,OkHttp缓存会支持。你的服务通过响应头确定响应缓存多长时间，例如使用Cache-Control: max-age=9600。\nprivate final OkHttpClient client;\n \npublic CacheResponse(File cacheDirectory) throws Exception {\n    int cacheSize = 10 * 1024 * 1024; // 10 MiB\n    Cache cache = new Cache(cacheDirectory, cacheSize);\n \n    client = new OkHttpClient();\n    client.setCache(cache);\n}\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://publicobject.com/helloworld.txt\")\n        .build();\n \n    Response response1 = client.newCall(request).execute();\n    if (!response1.isSuccessful()) throw new IOException(\"Unexpected code \" + response1);\n \n    String response1Body = response1.body().string();\n    System.out.println(\"Response 1 response:          \" + response1);\n    System.out.println(\"Response 1 cache response:    \" + response1.cacheResponse());\n    System.out.println(\"Response 1 network response:  \" + response1.networkResponse());\n \n    Response response2 = client.newCall(request).execute();\n    if (!response2.isSuccessful()) throw new IOException(\"Unexpected code \" + response2);\n \n    String response2Body = response2.body().string();\n    System.out.println(\"Response 2 response:          \" + response2);\n    System.out.println(\"Response 2 cache response:    \" + response2.cacheResponse());\n    System.out.println(\"Response 2 network response:  \" + response2.networkResponse());\n \n    System.out.println(\"Response 2 equals Response 1? \" + response1Body.equals(response2Body));\n}\n扩展在这一节还提到了下面一句：There are cache headers to force a cached response, force a network response, or force the network response to be validated with a conditional GET.\n我不是很懂cache，平时用到的也不多，所以把Google在Android Developers一段相关的解析放到这里吧。\nForce a Network ResponseIn some situations, such as after a user clicks a ‘refresh’ button, it may be necessary to skip the cache, and fetch data directly from the server. To force a full refresh, add the no-cache directive:\n\n\n\n\n\n\n\n\n\nconnection.addRequestProperty(“Cache-Control”, “no-cache”);\nIf it is only necessary to force a cached response to be validated by the server, use the more efficient max-age=0 instead:\n\n\n\n\n\n\n\n\n\nconnection.addRequestProperty(“Cache-Control”, “max-age=0”);\n##Force a Cache ResponseSometimes you’ll want to show resources if they are available immediately, but not otherwise. This can be used so your application can show something while waiting for the latest data to be downloaded. To restrict a request to locally-cached resources, add the only-if-cached directive:\ntry {\n     connection.addRequestProperty(\"Cache-Control\", \"only-if-cached\");\n     InputStream cached = connection.getInputStream();\n     // the resource was cached! show it\n  catch (FileNotFoundException e) {\n     // the resource was not cached\n }\n}\nThis technique works even better in situations where a stale response is better than no response. To permit stale cached responses, use the max-stale directive with the maximum staleness in seconds:\nint maxStale = 60 * 60 * 24 * 28; // tolerate 4-weeks staleconnection.addRequestProperty(\"Cache-Control\", \"max-stale=\" + maxStale);\n\n以上信息来自：HttpResponseCache - Android SDK | Android Developers\n取消一个Call使用Call.cancel()可以立即停止掉一个正在执行的call。如果一个线程正在写请求或者读响应，将会引发IOException。当call没有必要的时候，使用这个api可以节约网络资源。例如当用户离开一个应用时。不管同步还是异步的call都可以取消。你可以通过tags来同时取消多个请求。当你构建一请求时，使用RequestBuilder.tag(tag)来分配一个标签。之后你就可以用OkHttpClient.cancel(tag)来取消所有带有这个tag的call。\nprivate final ScheduledExecutorService executor = Executors.newScheduledThreadPool(1);\nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://httpbin.org/delay/2\") // This URL is served with a 2 second delay.\n        .build();\n \n    final long startNanos = System.nanoTime();\n    final Call call = client.newCall(request);\n \n    // Schedule a job to cancel the call in 1 second.\n    executor.schedule(new Runnable() {\n      @Override public void run() {\n        System.out.printf(\"%.2f Canceling call.%n\", (System.nanoTime() - startNanos) / 1e9f);\n        call.cancel();\n        System.out.printf(\"%.2f Canceled call.%n\", (System.nanoTime() - startNanos) / 1e9f);\n      }\n    }, 1, TimeUnit.SECONDS);\n \n    try {\n      System.out.printf(\"%.2f Executing call.%n\", (System.nanoTime() - startNanos) / 1e9f);\n      Response response = call.execute();\n      System.out.printf(\"%.2f Call was expected to fail, but completed: %s%n\",\n          (System.nanoTime() - startNanos) / 1e9f, response);\n    } catch (IOException e) {\n      System.out.printf(\"%.2f Call failed as expected: %s%n\",\n          (System.nanoTime() - startNanos) / 1e9f, e);\n    }\n}\n\n超时没有响应时使用超时结束call。没有响应的原因可能是客户点链接问题、服务器可用性问题或者这之间的其他东西。OkHttp支持连接，读取和写入超时\nprivate final OkHttpClient client;\n \npublic ConfigureTimeouts() throws Exception {\n    client = new OkHttpClient();\n    client.setConnectTimeout(10, TimeUnit.SECONDS);\n    client.setWriteTimeout(10, TimeUnit.SECONDS);\n    client.setReadTimeout(30, TimeUnit.SECONDS);\n}\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://httpbin.org/delay/2\") // This URL is served with a 2 second delay.\n        .build();\n \n    Response response = client.newCall(request).execute();\n    System.out.println(\"Response completed: \" + response);\n}\n\n每个call的配置使用OkHttpClient，所有的HTTP Client配置包括代理设置、超时设置、缓存设置。当你需要为单个call改变配置的时候，clone 一个 OkHttpClient。这个api将会返回一个浅拷贝（shallow copy），你可以用来单独自定义。下面的例子中，我们让一个请求是500ms的超时、另一个是3000ms的超时。\nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://httpbin.org/delay/1\") // This URL is served with a 1 second delay.\n        .build();\n \n    try {\n      Response response = client.clone() // Clone to make a customized OkHttp for this request.\n          .setReadTimeout(500, TimeUnit.MILLISECONDS)\n          .newCall(request)\n          .execute();\n      System.out.println(\"Response 1 succeeded: \" + response);\n    } catch (IOException e) {\n      System.out.println(\"Response 1 failed: \" + e);\n    }\n \n    try {\n      Response response = client.clone() // Clone to make a customized OkHttp for this request.\n          .setReadTimeout(3000, TimeUnit.MILLISECONDS)\n          .newCall(request)\n          .execute();\n      System.out.println(\"Response 2 succeeded: \" + response);\n    } catch (IOException e) {\n      System.out.println(\"Response 2 failed: \" + e);\n    }\n}\n\n处理验证这部分和HTTP AUTH有关。相关资料：HTTP AUTH 那些事 - 王绍全的博客 - 博客频道 - CSDN.NET\nOkHttp会自动重试未验证的请求。当响应是401 Not Authorized时，Authenticator会被要求提供证书。Authenticator的实现中需要建立一个新的包含证书的请求。如果没有证书可用，返回null来跳过尝试。\npublic List&lt;Challenge&gt; challenges()\nReturns the authorization challenges appropriate for this response's code. \nIf the response code is 401 unauthorized, \nthis returns the \"WWW-Authenticate\" challenges.\nIf the response code is 407 proxy unauthorized, this returns the \"Proxy-Authenticate\" challenges.\nOtherwise this returns an empty list of challenges.\n\n当需要实现一个Basic challenge， 使用Credentials.basic(username, password)来编码请求头。\nprivate final OkHttpClient client = new OkHttpClient();\n \npublic void run() throws Exception {\n    client.setAuthenticator(new Authenticator() {\n      @Override public Request authenticate(Proxy proxy, Response response) {\n        System.out.println(\"Authenticating for response: \" + response);\n        System.out.println(\"Challenges: \" + response.challenges());\n        String credential = Credentials.basic(\"jesse\", \"password1\");\n        return response.request().newBuilder()\n            .header(\"Authorization\", credential)\n            .build();\n      }\n \n      @Override public Request authenticateProxy(Proxy proxy, Response response) {\n        return null; // Null indicates no attempt to authenticate.\n      }\n    });\n \n    Request request = new Request.Builder()\n        .url(\"http://publicobject.com/secrets/hellosecret.txt\")\n        .build();\n \n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n \n    System.out.println(response.body().string());\n}\n\n转自 OkHttp使用介绍 同时整合了 OkHttp使用进阶 这篇文章以及其中的评论。\n","slug":"okhttphelp","date":"2016-05-09T15:29:13.000Z","categories_index":"Android","tags_index":"android,okhttp","author_index":"uuxia"},{"id":"abc951d0c14e2bccc2284934d80582aa","title":"教你几招，蚊子一个夏天不敢进你的房间！！","content":"教你几招，蚊子一个夏天不敢进你的房间！！\n\n\n前言“多蚊季节来了，谁都不叮偏偏就来叮你？嗡嗡吵得睡不着？怕宝宝被感染？下面教教大家一些驱蚊小窍门！！\n方法一：\n用空酒瓶装上糖水或啤酒放在阴暗处，蚊子闻到甜味就会往瓶子里钻，会被啤酒或糖水黏住致死。\n方法二：沸过的醋用碟装，放到房间里不用关门，整夜都不会被蚊子打扰。\n##方法三:　　避免在花纹蚊出没的时段（上午7-9时，下午4时到黄昏）在树荫、树丛、凉亭等阴暗处逗留。\n方法四:　　　　在室内点燃柑橘皮，既能驱蚊又能消除屋内异味。\n　　\n方法五：　　关上门窗，窗前放一个盆子，盆子加混合洗衣粉的水，第二天水盆中就会有死去的蚊子。\n方法六：　　房间里拜访驱蚊草。\n方法七：\n到登隔热流行区旅行，应穿上长袖衣服及长裤，并在外露皮肤及衣服上涂蚊虫趋避药物。\n方法八：　　　　3到5天刷洗水缸、换水一次，并翻盆倒罐、清除花盆、废气罐子等积水。\n方法九：　　　　房间里放几盒开着的风油精。\n11种防蚊子奇招妙法　1、维生素B泡水擦身，会让蚊子不敢近身，并且这种水溶性维生素没有副作用。\n　　2、在室内点燃干桔皮，可取代蚊香，既能驱蚊，又可消除屋内异味。\n　　3、尽量穿袜子。许多人喜欢夏天光脚穿鞋，殊不知穿袜子后，蚊子感觉人的皮肤湿度降低、皮表挥发物减少，会减少叮咬。\n　　4、在使用驱蚊药时，1个品牌连续使用2个月后，换一种药物驱蚊，效果更好。\n　　5、关上门窗，在窗前放置一盆混合洗衣粉的水，越日水盆中就会有一些死去的蚊子。每天持续使用，可以不用再喷杀虫剂了。\n　　6、在房间里放上几盒开盖的风油精、清冷油，或在墙上涂点薄荷。\n　　7、在身上或寝具上洒些香水。\n　　8、将樟脑丸磨碎、撒在屋内墙角。\n　　9、在室内的花盆里栽一两株番茄，番茄枝叶发出的气味会把蚊子驱除。\n　　10、在灯下挂一把香葱，或用纱袋装几根葱段，各种小虫都不会飞来。\n　　11、用橘红色玻璃纸或绸布套在灯泡上，蚊子最怕橘红色光。\n","slug":"gowaywenzi","date":"2016-05-08T23:58:25.000Z","categories_index":"生活","tags_index":"驱蚊  life","author_index":"uuxia"},{"id":"7ab620140aa4aa61971d8467ecefd182","title":"Android孤儿进程防止清理","content":"孤儿进程:因为父进程先退出而导致一个子进程被init进程收养的进程为孤儿进程孤儿进程:因为父进程先退出而导致一个子进程被init进程收养的进程为孤儿进程。因此，可以通过创建孤儿进程，改变native进程的父进程，达到防止系统清理。\n关键代码实现:\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\nint main()\n{\n   pid_t child_pid;\n   child_pid=fork();\n   if(child_pid&lt;0)\n   {\n     perror(\"fork error\");\n     exit(EXIT_FAILURE);\n   }\n   if(child_pid==0)//子进程处理 事务\n   {\n      while(1)\n      {\n         printf(\"hello world\\n\");\n         sleep(1);\n      }\n      return 0;\n   }else\n   {\n     printf(\"father bye byte\\n\");\n     exit(EXIT_SUCCESS);\n   }\n}\n","slug":"deamon","date":"2016-05-08T17:47:57.000Z","categories_index":"Android","tags_index":"Android,Service","author_index":"uuxia"}]