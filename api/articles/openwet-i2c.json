{"title":"OpenWrt开启i2c功能，并顺利编译风扇驱动","uid":"fefcb9efb9b2bb50dd1c4b29bb3c1ed0","slug":"openwet-i2c","date":"2022-11-21T06:11:56.000Z","updated":"2022-11-21T06:14:31.928Z","comments":true,"path":"api/articles/openwet-i2c.json","cover":null,"content":"<p>树莓派安装OpenWrt作为家庭主路由，并开启i2c编译风扇、led等驱动，cpu温度骤降！～～～</p>\n<span id=\"more\"></span>\n\n\n<h3 id=\"1、编译风扇\"><a href=\"#1、编译风扇\" class=\"headerlink\" title=\"1、编译风扇\"></a>1、编译风扇</h3><p>/home/uuxia/openwrt/temp_control/WiringPi-master/wiringPi</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">/home/uuxia/openwrt/wrt/staging_dir/toolchain-aarch64_cortex-a72_gcc-8.4.0_musl/bin/aarch64-openwrt-linux-gcc \\\n-o feng feng.c ssd1306_i2c.c \\\n-I/home/uuxia/openwrt/temp_control/WiringPi-master/wiringPi \\\n-L/home/uuxia/openwrt/temp_control/WiringPi-master/wiringPi \\\n-lwiringPi<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"2、Unable-to-open-I2C-device-No-such-file-or-directory-问题解决\"><a href=\"#2、Unable-to-open-I2C-device-No-such-file-or-directory-问题解决\" class=\"headerlink\" title=\"2、Unable to open I2C device: No such file or directory 问题解决\"></a>2、<strong>Unable to open I2C device: No such file or directory</strong> 问题解决</h3><p>用lsmod命令可以看到i2c_bmc2708字样，但是没i2c_dev字样，那么还需要做如下处理<br>执行命令<br><code>sudo nano /etc/modules</code>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; # 使用nano打开文件<br>然后增加<br>i2c_dev<br>行，安Ctrl+X退出编辑，输入Y保存内容，然后重启即可。</p>\n<h3 id=\"3、在OpenWrt中开启树莓派I2C功能\"><a href=\"#3、在OpenWrt中开启树莓派I2C功能\" class=\"headerlink\" title=\"3、在OpenWrt中开启树莓派I2C功能\"></a>3、在OpenWrt中开启树莓派I2C功能</h3><h5 id=\"1、编辑-x2F-boot-x2F-config-txt\"><a href=\"#1、编辑-x2F-boot-x2F-config-txt\" class=\"headerlink\" title=\"1、编辑 /boot/config.txt\"></a>1、编辑 /boot/config.txt</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">dtparam=i2c_arm=on\ndtparam=i2c0=on\ndtparam=i2c1=on\ndtparam=spi=on\ndtparam=i2s=on<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"2、通过opkg安装相关包\"><a href=\"#2、通过opkg安装相关包\" class=\"headerlink\" title=\"2、通过opkg安装相关包\"></a>2、通过opkg安装相关包</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">opkg install i2c-tools kmod-i2c-gpio kmod-i2c-algo-bit kmod-i2c-algo-pcf kmod-i2c-bcm2835 kmod-i2c-core kmod-i2c-gpio kmod-i2c-mux<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"3、使用i2c命令行工具测试\"><a href=\"#3、使用i2c命令行工具测试\" class=\"headerlink\" title=\"3、使用i2c命令行工具测试\"></a>3、使用i2c命令行工具测试</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">\n#!/bin/bash\nls /dev/i2c*\ni2cdetect -y 1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>","text":"树莓派安装OpenWrt作为家庭主路由，并开启i2c编译风扇、led等驱动，cpu温度骤降！～～～ 1、编译风扇/home/uuxia/openwrt/temp_control/WiringPi-master/wiringPi /home/uuxia/openwrt/wrt/st...","link":"","photos":[],"count_time":{"symbolsCount":912,"symbolsTime":"1 mins."},"categories":[{"name":"openwrt","slug":"openwrt","count":1,"path":"api/categories/openwrt.json"},{"name":"i2c","slug":"i2c","count":1,"path":"api/categories/i2c.json"}],"tags":[{"name":"openwrt","slug":"openwrt","count":1,"path":"api/tags/openwrt.json"},{"name":"i2c","slug":"i2c","count":1,"path":"api/tags/i2c.json"},{"name":"pi","slug":"pi","count":1,"path":"api/tags/pi.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%E3%80%81%E7%BC%96%E8%AF%91%E9%A3%8E%E6%89%87\"><span class=\"toc-text\">1、编译风扇</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2%E3%80%81Unable-to-open-I2C-device-No-such-file-or-directory-%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3\"><span class=\"toc-text\">2、Unable to open I2C device: No such file or directory 问题解决</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3%E3%80%81%E5%9C%A8OpenWrt%E4%B8%AD%E5%BC%80%E5%90%AF%E6%A0%91%E8%8E%93%E6%B4%BEI2C%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">3、在OpenWrt中开启树莓派I2C功能</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#1%E3%80%81%E7%BC%96%E8%BE%91-x2F-boot-x2F-config-txt\"><span class=\"toc-text\">1、编辑 &#x2F;boot&#x2F;config.txt</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#2%E3%80%81%E9%80%9A%E8%BF%87opkg%E5%AE%89%E8%A3%85%E7%9B%B8%E5%85%B3%E5%8C%85\"><span class=\"toc-text\">2、通过opkg安装相关包</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#3%E3%80%81%E4%BD%BF%E7%94%A8i2c%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">3、使用i2c命令行工具测试</span></a></li></ol></li></ol></li></ol>","author":{"name":"uuxia","slug":"blog-author","avatar":"/medias/avatar.jpg","link":"/","description":"一位正在重塑知识的技术人 <br /> @ <b>欢迎光临</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"GoLang 全平台编译","uid":"4256b93c1a14e298462e2348e12791c7","slug":"go-cross-compile","date":"2022-11-23T11:16:38.000Z","updated":"2022-11-23T11:18:38.901Z","comments":true,"path":"api/articles/go-cross-compile.json","cover":null,"text":"Golang的全平台编译简直太爽了，真的太适合我了，平时编译一些不同设备的跨平台程序，真的是爽的不行。拥有一台windows电脑就能开发出在Linux、Windows、Mac上面直接运行的程序。 一、三个平台编译示例:1、Mac下编译Linux, Windows平台的64位可执行...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"go","slug":"go","count":1,"path":"api/categories/go.json"}],"tags":[{"name":"go","slug":"go","count":1,"path":"api/tags/go.json"},{"name":"cross","slug":"cross","count":1,"path":"api/tags/cross.json"}],"author":{"name":"uuxia","slug":"blog-author","avatar":"/medias/avatar.jpg","link":"/","description":"一位正在重塑知识的技术人 <br /> @ <b>欢迎光临</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Windows下Frpc安装与自启动","uid":"070f304a02bbf9ceccd6a97acca7e527","slug":"frpc-install-autostart","date":"2022-10-27T09:00:57.000Z","updated":"2022-10-27T09:03:31.391Z","comments":true,"path":"api/articles/frpc-install-autostart.json","cover":[],"text":"Windows下安装Frpc，并在windows的任务计划程序里设置Frpc自启动。 1、新建一个start.bat文件 @echo off :home frpc -c frpc.ini goto home 2、 打开任务计划程序（cmd-&gt;taskschd.msc） 3、...","link":"","photos":[],"count_time":{"symbolsCount":160,"symbolsTime":"1 mins."},"categories":[{"name":"frpc","slug":"frpc","count":1,"path":"api/categories/frpc.json"}],"tags":[{"name":"frpc","slug":"frpc","count":1,"path":"api/tags/frpc.json"}],"author":{"name":"uuxia","slug":"blog-author","avatar":"/medias/avatar.jpg","link":"/","description":"一位正在重塑知识的技术人 <br /> @ <b>欢迎光临</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}